<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
     Li Jie&#39;s blog
  </title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  <link rel="stylesheet" href="/css/style.css">
  <script src="/js/pace.min.js"></script>

  

  

<link rel="alternate" href="/atom.xml" title="Li Jie's blog" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    <main class="content">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/chineselijie"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover3.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">Li Jie&#39;s blog</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>

<div id="main">
  <section class="outer">
  <article class="articles">
    
    
    
    
    <article id="post-20.linux--NFS服务" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/03/12/20.linux--NFS服务/"
    >NFS服务</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/03/12/20.linux--NFS服务/" class="article-date">
  <time datetime="2020-03-12T11:38:40.251Z" itemprop="datePublished">2020-03-12</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux进阶/">linux进阶</a>
  </div>

      
      
      
    </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <blockquote>
<p><strong>关于作者</strong></p>
<p><strong>周李杰</strong>，最后一批90后，现居<strong>湖北武汉</strong></p>
<p>孤独患者，懒癌中期，无脑幻想者。但却人畜无害，无需远离。</p>
<p>兴趣众多，然无一精通。正努力成为一个有趣的人。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; print(&quot;👆以上是不完整的我&quot;) //请我吃大餐将会了解更多</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>[TOC]</p>
<h2 id="NFS简介"><a href="#NFS简介" class="headerlink" title="NFS简介"></a>NFS简介</h2><h3 id="NFS特点"><a href="#NFS特点" class="headerlink" title="NFS特点"></a>NFS特点</h3><ul>
<li><p><a href="https://baike.baidu.com/item/NFS/812203?fr=aladdin" target="_blank" rel="noopener">NFS（Network File System)</a>即<a href="https://baike.baidu.com/item/网络文件系统/9719420" target="_blank" rel="noopener">网络文件系统</a>，是FreeBSD支持的文件系统中的一种，它允许网络中的计算机之间共享资源。在NFS的应用中，本地NFS的客户端应用可以透明地读写位于远端NFS服务器上的文件，就像访问本地文件一样。</p>
</li>
<li><p>NFS适用于Linux与unix之间实现文件共享，不能实现Linux与Windows之间的文件共享</p>
</li>
<li><p>NFS运行在应用层的协议上，其监听于2049/tcp和2049/udp套接字上</p>
</li>
</ul>
<p>注意：NFS服务只能基于IP进行认证</p>
<h3 id="使用NFS的好处"><a href="#使用NFS的好处" class="headerlink" title="使用NFS的好处"></a>使用NFS的好处</h3><ul>
<li>节省本地存储空间，将常用的数据存放在一台NFS服务器上且可以通过网络访问，那么本地终端将可以减少自身存储空间的使用。</li>
<li>用户不需要在网络中的每个机器上都建有Home目录，Home目录可以放在NFS服务器上且可以在网络上被访问使用。</li>
<li>一些存储设备如软驱、CDROM和Zip（一种高储存密度的磁盘驱动器与磁盘）等都可以在网络上被别的机器使用。这可以减少整个网络上可移动介质设备的数量。</li>
</ul>
<h3 id="NFS的体系组成"><a href="#NFS的体系组成" class="headerlink" title="NFS的体系组成"></a>NFS的体系组成</h3><p>NFS体系至少有两个主要部分：</p>
<p><a href="https://baike.baidu.com/pic/NFS/812203/0/0df3d7ca7bcb0a46faeb868c6863f6246a60afbd?fr=lemma&ct=single" target="_blank" rel="noopener"><img src="https://gss0.bdstatic.com/94o3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=83208b998401a18bf4eb154dae2e0761/0df3d7ca7bcb0a46faeb868c6863f6246a60afbd.jpg" alt="img"></a></p>
<p>一台NFS服务器和若干台客户机，如上图所示。</p>
<p>客户机通过TCP/IP网络远程访问存放在NFS服务器上的数据。</p>
<p>在NFS服务器正式启用前，需要根据实际环境和需求，配置一些NFS参数。</p>
<h3 id="NFS的应用场景"><a href="#NFS的应用场景" class="headerlink" title="NFS的应用场景"></a>NFS的应用场景</h3><ol>
<li><p>多个机器共享一台CDROM或者其他设备。这对于在多台机器中安装软件来说更加便宜跟方便。</p>
</li>
<li><p>在大型网络中，配置一台中心 NFS 服务器用来放置所有用户的home目录可能会带来便利。这些目录能被输出到网络以便用户不管在哪台工作站上登录，总能得到相同的home目录。</p>
</li>
<li><p>不同客户端可在NFS上观看影视文件，节省本地空间。</p>
</li>
<li><p>在客户端完成的工作数据，可以备份保存到NFS服务器上用户自己的路径下。</p>
</li>
</ol>
<ul>
<li>NFS是运行在应用层的协议。随着NFS多年的发展和改进，NFS既可以用于局域网也可以用于广域网，且与操作系统和硬件无关，可以在不同的计算机或系统上运行。</li>
</ul>
<h3 id="NFS挂载原理"><a href="#NFS挂载原理" class="headerlink" title="NFS挂载原理"></a>NFS挂载原理</h3><p><img src="https://images2017.cnblogs.com/blog/1054216/201709/1054216-20170901171038202-1066682924.jpg" alt></p>
<ul>
<li><p>​    当我们在NFS服务器设置好一个共享目录/home/public后，其他的有权访问NFS服务器的NFS客户端就可以将这个目录挂载到自己文件系统的某个挂载点，这个挂载点可以自己定义，如上图客户端A与客户端B挂载的目录就不相同。并且挂载好后我们在本地能够看到服务端/home/public的所有数据。如果服务器端配置的客户端只读，那么客户端就只能够只读。如果配置读写，客户端就能够进行读写。挂载后，NFS客户端查看磁盘信息命令：#df –h。</p>
</li>
<li><p>既然NFS是通过网络来进行服务器端和客户端之间的数据传输，那么两者之间要传输数据就要有想对应的网络端口，NFS服务器到底使用哪个端口来进行数据传输呢？基本上NFS这个服务器的端口开在2049,但由于文件系统非常复杂。因此NFS还有其他的程序去启动额外的端口，这些额外的用来传输数据的端口是随机选择的，是小于1024的端口；既然是随机的那么客户端又是如何知道NFS服务器端到底使用的是哪个端口呢？这时就需要通过远程过程调用（Remote Procedure Call,RPC）协议来实现了！</p>
</li>
</ul>
<h2 id="NFS的工作机制"><a href="#NFS的工作机制" class="headerlink" title="NFS的工作机制"></a>NFS的工作机制</h2><p>NFS是基于rpc来实现网络文件系统共享的。</p>
<h3 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h3><p><a href="[https://baike.baidu.com/item/%E8%BF%9C%E7%A8%8B%E8%BF%87%E7%A8%8B%E8%B0%83%E7%94%A8%E5%8D%8F%E8%AE%AE/6893245?fromtitle=RPC&fromid=609861&fr=aladdin](https://baike.baidu.com/item/远程过程调用协议/6893245?fromtitle=RPC&fromid=609861&fr=aladdin)">RPC（Remote Procedure Call）</a>—<a href="https://baike.baidu.com/item/远程过程调用/7854346" target="_blank" rel="noopener">远程过程调用</a>，它是一种通过<a href="https://baike.baidu.com/item/网络/143243" target="_blank" rel="noopener">网络</a>从远程计算机程序上请求服务，而不需要了解底层网络技术的协议。<a href="https://baike.baidu.com/item/RPC协议" target="_blank" rel="noopener">RPC协议</a>假定某些<a href="https://baike.baidu.com/item/传输协议/8048821" target="_blank" rel="noopener">传输协议</a>的存在，如TCP或UDP，为通信程序之间携带信息数据。在OSI<a href="https://baike.baidu.com/item/网络通信/9636548" target="_blank" rel="noopener">网络通信</a>模型中，RPC跨越了<a href="https://baike.baidu.com/item/传输层/4329536" target="_blank" rel="noopener">传输层</a>和<a href="https://baike.baidu.com/item/应用层/4329788" target="_blank" rel="noopener">应用层</a>。RPC使得开发包括网络<a href="https://baike.baidu.com/item/分布式" target="_blank" rel="noopener">分布式</a>多程序在内的应用程序更加容易。</p>
<p>RPC采用客户机/服务器模式。请求程序就是一个客户机，而服务提供程序就是一个服务器。首先，客户机调用进程发送一个有进程参数的调用信息到服务进程，然后等待应答信息。在服务器端，进程保持睡眠状态直到调用信息到达为止。当一个调用信息到达，服务器获得进程参数，计算结果，发送答复<a href="https://baike.baidu.com/item/信息/111163" target="_blank" rel="noopener">信息</a>，然后等待下一个调用信息，最后，客户端调用进程接收答复信息，获得进程结果，然后调用执行继续进行。</p>
<h4 id="RPC工作原理"><a href="#RPC工作原理" class="headerlink" title="RPC工作原理"></a>RPC工作原理</h4><p>运行时，一次客户机对服务器的RPC调用，其内部操作大致有如下十步：</p>
<p>1.调用客户端句柄；执行传送参数</p>
<p>2.调用本地系统<a href="https://baike.baidu.com/item/内核" target="_blank" rel="noopener">内核</a>发送网络消息</p>
<p>3.<a href="https://baike.baidu.com/item/消息传送" target="_blank" rel="noopener">消息传送</a>到远程<a href="https://baike.baidu.com/item/主机" target="_blank" rel="noopener">主机</a></p>
<p>4.服务器句柄得到消息并取得参数</p>
<p>5.执行远程过程</p>
<p><a href="https://baike.baidu.com/pic/远程过程调用协议/6893245/0/18d8bc3eb13533fadd93e964a9d3fd1f41345b56?fr=lemma&ct=single" target="_blank" rel="noopener"><img src="https://gss3.bdstatic.com/7Po3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=7e27f7747aec54e745ec1d1c89399bfd/18d8bc3eb13533fadd93e964a9d3fd1f41345b56.jpg" alt="img"></a></p>
<p>6.执行的过程将结果返回服务器句柄</p>
<p>7.服务器句柄返回结果，调用远程系统<a href="https://baike.baidu.com/item/内核" target="_blank" rel="noopener">内核</a></p>
<p>8.消息传回<a href="https://baike.baidu.com/item/本地主机" target="_blank" rel="noopener">本地主机</a></p>
<p>9.客户句柄由内核接收消息</p>
<p>10.客户接收句柄返回的数据</p>
<h3 id="NIS"><a href="#NIS" class="headerlink" title="NIS"></a>NIS</h3><p><a href="https://baike.baidu.com/item/NIS/9085264?fr=aladdin" target="_blank" rel="noopener">NIS（Network Information Service）</a>—–网络信息服务，是<a href="https://baike.baidu.com/item/诺顿网络安全特警/10753322" target="_blank" rel="noopener">诺顿网络安全特警</a>简称，同时NIS是Sun Microsystem于1985年发布的一项目录服务技术（Diretory Service），用来<a href="https://baike.baidu.com/item/集中控制/1051216" target="_blank" rel="noopener">集中控制</a>几个系统管理数据库的网络用品。简化了UNIX和<a href="https://baike.baidu.com/item/LINUX/27050" target="_blank" rel="noopener">LINUX</a>桌面客户的管理工作，客户端利用它可以使用中心服务器的管理文件。</p>
<h3 id="NFS的工作机制-1"><a href="#NFS的工作机制-1" class="headerlink" title="NFS的工作机制"></a>NFS的工作机制</h3><p>NFS服务器端运行着四个进程：</p>
<ul>
<li>nfsd      nfs的守护进程，监听在2049/tcp和2049/udp端口上；不负责文件的存储（由NFS服务器本地内核负责调度存储），用于理解客户端发起的RPC请求，并将其转交给本地内核，然后存储在指定的文件系统上</li>
<li>mountd     用于验证客户端是否在允许访问此NFS文件系统的客户端列表中，如果在的话就允许访问（发放一个指令，携带指令去寻找nfsd）;   mountd的服务端口是随机的，由rpc服务提供随机的端口号</li>
<li>idmapd     实现用户账号的集中映射，把所有的账号都映射为nfsnobody，但是在访问时却能以本地用户的身份去访问</li>
<li>portmapper     NFS服务器的RPC服务，其监听于111/tcp和111/UDP套接字上，用于管理远程过程中调用RPC</li>
</ul>
<h2 id="exports文件的格式"><a href="#exports文件的格式" class="headerlink" title="exports文件的格式"></a>exports文件的格式</h2><p>nfs的主配置文件是/etc/exports，在此文件中，可以定义NFS系统的输出目录（即共享目录）、访问权限和允许访问的主机等参数。该文件默认为空，没有配置输出任何共享目录，这是基于安全性的考虑，如此即使系统启动了NFS服务也不会输出任何共享资源。</p>
<p>exports文件中每一行提供了一个共享目录的设置，其命令格式为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;输出目录&gt; [客户端1(选项1,选项2,...)] [客户端2(选项1,选项2,...)]</span><br></pre></td></tr></table></figure>

<p>其中，除输出目录是必选参数外，其他参数均是可选项。另外，格式中的输出目录和客户端之间、客户端与客户端之间都使用空格分隔，但客户端与选项之间不能有空格。</p>
<p>客户端是指网络中可以访问这个NFS共享目录的计算机。客户端的指定非常灵活，可为单个主机的IP或域名，亦可为某个子网或域中的主机等。</p>
<p><strong>客户端地址的设置主要有以下几种方式：</strong></p>
<ul>
<li>可以使用完整的IP或者是网络号，例如192.168.107.140 或 192.168.107.0/24</li>
<li>可以使用主机名，但这个主机名必须要在/etc/hosts内，或可以使用DNS找到该名称才行，反正重点是可找到IP就行，如果是主机名的话，还可以支持通配符，例如‘*’或‘？’均可接受。</li>
</ul>
<p><strong>选项用来设置共享目录的访问权限、用户映射等。exports文件中的选项比较多，一般可分为三类：</strong></p>
<ul>
<li>访问权限选项（用于控制共享目录的访问权限）</li>
<li>用户映射选项<ul>
<li>默认情况下，当客户端访问NFS服务器时，若远程访问的用户是root用户，则NFS服务器会将其映射成一个本地的匿名用户（该用户为nfsnobody），并将其所属的用户组也映射成匿名用户组（该用户组也为nfsnobody），如此有助于提高系统的安全性。</li>
</ul>
</li>
<li>其他选项</li>
</ul>
<p><strong>访问权限选项：</strong></p>
<table>
<thead>
<tr>
<th align="center">访问权限选项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">ro</td>
<td align="left">设置输出目录只读</td>
</tr>
<tr>
<td align="center">rw</td>
<td align="left">设置输出目录可读写</td>
</tr>
</tbody></table>
<p><strong>用户映射选项：</strong></p>
<table>
<thead>
<tr>
<th align="center">用户映射选项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">all_squash</td>
<td align="left">将远程访问的所有普通用户及所属组都映射为匿名用户或用户组(nfsnobody)</td>
</tr>
<tr>
<td align="center">no_all_squash</td>
<td align="left">不将远程访问的所有普通用户及所属用户组都映射为匿名用户或用户组(默认设置)</td>
</tr>
<tr>
<td align="center">root_squash</td>
<td align="left">将root用户及所属用户组都映射为匿名用户或用户组(默认设置)</td>
</tr>
<tr>
<td align="center">no_root_squash</td>
<td align="left">不将root用户及所属用户组都映射为匿名用户或用户组</td>
</tr>
<tr>
<td align="center">anonuid=xxx</td>
<td align="left">将远程访问的所有用户都映射为匿名用户，并指定该匿名用户为本地用户帐户(UID=xxx)</td>
</tr>
<tr>
<td align="center">anongid=xxx</td>
<td align="left">将远程访问的所有用户组都映射为匿名用户组，并指定该匿名用户组为本地用户组(GID=xxx)</td>
</tr>
</tbody></table>
<p><strong>常用的其他选项：</strong></p>
<table>
<thead>
<tr>
<th align="left">其他选项</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">secure</td>
<td align="left">限制客户端只能从小于1024的TCP/IP端口连接NFS服务器(默认设置)</td>
</tr>
<tr>
<td align="left">insecure</td>
<td align="left">允许客户端从大于1024的TCP/IP端口连接NFS服务器</td>
</tr>
<tr>
<td align="left">sync</td>
<td align="left">将数据同步写入内存缓冲区或磁盘中，效率较低，但可保证数据一致性</td>
</tr>
<tr>
<td align="left">async</td>
<td align="left">将数据先保存在内存缓冲区中，必要时才写入磁盘</td>
</tr>
<tr>
<td align="left">wdelay</td>
<td align="left">检查是否有相关的写操作，如果有则这些写操作一起执行，可提高效率(默认设置)</td>
</tr>
<tr>
<td align="left">no_wdelay</td>
<td align="left">若有写操作则立即执行，应与sync配置使用</td>
</tr>
<tr>
<td align="left">subtree_check</td>
<td align="left">若输出目录是一个子目录，则NFS服务器将检查其父目录的权限(默认设置)</td>
</tr>
<tr>
<td align="left">no_subtree_check</td>
<td align="left">即使输出目录是一个子目录，NFS服务亦不检查其父目录的权限，可提高效率</td>
</tr>
<tr>
<td align="left">nohide</td>
<td align="left">若将一个目录挂载到另一个目录之上，则原来的目录通常就被隐藏起来或看起来像空的一样。要禁用这种行为，需启用hide选项</td>
</tr>
</tbody></table>
<h2 id="NFS管理"><a href="#NFS管理" class="headerlink" title="NFS管理"></a>NFS管理</h2><ul>
<li>安装NFS</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">yum -y install nfs*</span><br><span class="line"><span class="comment"># 启动</span></span><br><span class="line">systemctl restart nfs-server rpcbind</span><br><span class="line">或者 systemctl start nfs-server rpcbind</span><br><span class="line"><span class="comment">#查看启动状态</span></span><br><span class="line">systemctl status nfs</span><br></pre></td></tr></table></figure>

<ul>
<li>使用showmount命令测试NFS服务器的输出目录状态</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">语法：showmount [选项] [NFS服务器名称或地址]</span><br><span class="line">常用的选项：</span><br><span class="line">	-a	显示指定NFS服务器的所有客户端主机及其所连接的目录</span><br><span class="line">	-d	显示指定的NFS服务器中已被客户端连接的所有输出目录</span><br><span class="line">	-e	显示指定的NFS服务器上所有输出的共享目录</span><br><span class="line">	</span><br><span class="line">[root@client ~]# showmount -a 192.168.176.222</span><br><span class="line">All mount points on 192.168.176.222:</span><br><span class="line">[root@client ~]# showmount -d 192.168.176.222</span><br><span class="line">Directories on 192.168.176.222:</span><br><span class="line">[root@client ~]# showmount -e 192.168.176.222</span><br><span class="line">Export list for 192.168.176.222:</span><br><span class="line">/123 192.168.176.111</span><br></pre></td></tr></table></figure>

<ul>
<li>在客户端挂载NFS文件系统</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mount -t nfs 服务器的IP地址：服务端的地址目录 本地挂载地址目录</span><br><span class="line"></span><br><span class="line">[root@client ~]<span class="comment"># mount -t nfs 192.168.176.222:/123 /nfs</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在客户端设置开机自动挂在NFS</li>
</ul>
<p>首先编辑/etc/fstab</p>
<p>添加内容如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">服务器的IP地址：服务端的地址目录 本地挂载地址目录 nfs defaults,_netdev 0 0</span><br><span class="line"></span><br><span class="line">192.168.176.222:/123    /nfs    nfs     defaults,_netdev        0 0</span><br></pre></td></tr></table></figure>

<ul>
<li>客户端挂载时可以使用的特殊选项：<ul>
<li>rsize：其值是从服务器读取的字节数（缓冲）。默认为1024。若使用比较高的值，如8192，可以提高传输速度</li>
<li>wsize：其值是写入到服务器的字节数（缓冲）。默认为1024。若使用比较高的值，如8192，可以提高传输速度</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">exportfs	维护exports文件导出的文件系统表的专用工具</span><br><span class="line">	-a	输出在/etc/exports文件中所设置的所有目录</span><br><span class="line">	-r	重新读取/etc/exports文件中的设置，并使其立即生效，无需重启服务</span><br><span class="line">	-u	停止输出某一目录</span><br><span class="line">	-v	在输出目录时将目录显示到屏幕上</span><br></pre></td></tr></table></figure>

<p><strong>检查输出目录所使的选项：</strong></p>
<p>​     在配置文件/etc/exports中，即使在命令行中只设置了一两个选项，但在真正输出目录时，实际上还带有很多默认的选项。通过查看<code>/var/lib/nfs/etab</code>文件，可以看到具体使用了何选项</p>
<h2 id="NFS配置演示"><a href="#NFS配置演示" class="headerlink" title="NFS配置演示"></a>NFS配置演示</h2><blockquote>
<p>服务端地址为：192.168.176.222</p>
<p>客服端地址为：192.168.176.111</p>
</blockquote>
<p><strong>服务端：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]<span class="comment"># yum install nfs* rpcbind -y</span></span><br><span class="line">[root@server ~]<span class="comment"># systemctl restart nfs rpcbind</span></span><br><span class="line">[root@server ~]<span class="comment"># mkdir /123</span></span><br><span class="line">[root@server ~]<span class="comment"># vim /etc/exports</span></span><br><span class="line">[root@server ~]<span class="comment"># cat /etc/exports</span></span><br><span class="line">/123    192.168.176.111(rw)</span><br><span class="line">[root@server ~]<span class="comment"># systemctl restart nfs rpcbind</span></span><br><span class="line"><span class="comment">#服务端已经配置完成，转到客户端之前请确认服务端以及客户端SELinux以及防火墙关闭</span></span><br><span class="line">[root@server ~]<span class="comment"># systemctl stop firewalld</span></span><br><span class="line">[root@server ~]<span class="comment"># setenforce 0</span></span><br></pre></td></tr></table></figure>

<p><strong>客户端：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">[root@client ~]<span class="comment"># systemctl stop firewalld</span></span><br><span class="line">[root@client ~]<span class="comment"># setenforce 0</span></span><br><span class="line">[root@client ~]<span class="comment"># showmount -e 192.168.176.222</span></span><br><span class="line">Export list <span class="keyword">for</span> 192.168.176.222:</span><br><span class="line">/123 192.168.176.111</span><br><span class="line">[root@client ~]<span class="comment"># mkdir /nfs</span></span><br><span class="line">[root@client ~]<span class="comment"># mount -t nfs 192.168.176.222:/123 /nfs</span></span><br><span class="line">[root@client ~]<span class="comment"># df -Th</span></span><br><span class="line">文件系统                类型      容量  已用  可用 已用% 挂载点</span><br><span class="line">/dev/mapper/centos-root xfs        17G  1.1G   16G    6% /</span><br><span class="line">devtmpfs                devtmpfs  982M     0  982M    0% /dev</span><br><span class="line">tmpfs                   tmpfs     993M     0  993M    0% /dev/shm</span><br><span class="line">tmpfs                   tmpfs     993M  8.7M  984M    1% /run</span><br><span class="line">tmpfs                   tmpfs     993M     0  993M    0% /sys/fs/cgroup</span><br><span class="line">/dev/sr0                iso9660   4.3G  4.3G     0  100% /mnt</span><br><span class="line">/dev/sda1               xfs      1014M  125M  890M   13% /boot</span><br><span class="line">tmpfs                   tmpfs     199M     0  199M    0% /run/user/0</span><br><span class="line">192.168.176.222:/123    nfs4       17G  1.3G   16G    8% /nfs</span><br><span class="line">[root@client /]<span class="comment"># cd /nfs</span></span><br><span class="line">[root@client nfs]<span class="comment"># ls</span></span><br><span class="line">[root@client nfs]<span class="comment"># mkdir abc</span></span><br><span class="line">mkdir: 无法创建目录<span class="string">"abc"</span>: 权限不够</span><br><span class="line"></span><br><span class="line"><span class="comment"># 此时我们要修改服务端的文件权限</span></span><br><span class="line">[root@client nfs]<span class="comment"># ssh root@192.168.176.222</span></span><br><span class="line">Last login: Tue Jun 25 15:49:36 2019 from 192.168.176.111</span><br><span class="line">[root@server ~]<span class="comment">#</span></span><br><span class="line">[root@server ~]<span class="comment"># cd /</span></span><br><span class="line">[root@server /]<span class="comment"># ls -ld 123</span></span><br><span class="line">drwxr-xr-x. 2 root root 6 6月  25 16:45 123</span><br><span class="line">[root@server /]<span class="comment"># chmod 777 123</span></span><br><span class="line">[root@server /]<span class="comment"># exit</span></span><br><span class="line">登出</span><br><span class="line">Connection to 192.168.176.222 closed.</span><br><span class="line">[root@client nfs]<span class="comment"># mkdir abc</span></span><br><span class="line">[root@client nfs]<span class="comment"># ls -l</span></span><br><span class="line">drwxr-xr-x. 2 nfsnobody nfsnobody 6 6月  25 17:21 abc</span><br><span class="line"></span><br><span class="line"><span class="comment">## 或者我们修改服务端的文件的所属者</span></span><br><span class="line">[root@client nfs]<span class="comment"># ssh root@192.168.176.222</span></span><br><span class="line">Last login: Tue Jun 25 17:25:35 2019 from 192.168.176.111</span><br><span class="line">[root@server ~]<span class="comment"># cd /</span></span><br><span class="line">[root@server /]<span class="comment"># ls -ld 123</span></span><br><span class="line">drwxrwxrwx. 3 root root 17 6月  25 17:26 123</span><br><span class="line">[root@server /]<span class="comment"># chmod 755 123</span></span><br><span class="line">[root@server /]<span class="comment"># ls -ld 123</span></span><br><span class="line">drwxr-xr-x. 3 root root 17 6月  25 17:26 123</span><br><span class="line">[root@server /]<span class="comment"># chown nfsnobody /123</span></span><br><span class="line">[root@server /]<span class="comment"># ls -ld 123</span></span><br><span class="line">drwxr-xr-x. 3 nfsnobody root 17 6月  25 17:26 123</span><br><span class="line">[root@server /]<span class="comment"># exit</span></span><br><span class="line">登出</span><br><span class="line">Connection to 192.168.176.222 closed.</span><br><span class="line">[root@client nfs]<span class="comment"># rm -rf abc</span></span><br><span class="line">[root@client nfs]<span class="comment"># mkdir eerefsf</span></span><br><span class="line">[root@client nfs]<span class="comment"># ls</span></span><br><span class="line">eerefsf</span><br></pre></td></tr></table></figure>

<h2 id="作业"><a href="#作业" class="headerlink" title="作业"></a>作业</h2><p>1.手动搭建一个nfs服务器</p>
<ul>
<li>开放/nfs/shared目录，供所有用户查阅资料</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@server /]<span class="comment"># mkdir /nfs/shared</span></span><br><span class="line">[root@server /]<span class="comment"># chmod -R 777 /nfs/shared</span></span><br></pre></td></tr></table></figure>

<ul>
<li>开放/nfs/upload目录为192.168.176.0/24（或者自己主机网段）网段的数据上传目录，并将所有用户及所属的用户组都映射为nfs-upload，其UID与GID均为300</li>
</ul>
<p>2.通过脚本搭建nfs并在客户端上挂载</p>

      
      <!-- 打赏 -->
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chineselijie/2020/03/12/20.linux--NFS服务/" data-id="ck7ooyak1002w4su6hz65um73"
        class="article-share-link">分享</a>
        
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux进阶/">linux进阶</a></li></ul>

    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-19.linux--samba服务" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/03/12/19.linux--samba服务/"
    >samba服务</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/03/12/19.linux--samba服务/" class="article-date">
  <time datetime="2020-03-12T11:38:40.249Z" itemprop="datePublished">2020-03-12</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux进阶/">linux进阶</a>
  </div>

      
      
      
    </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <blockquote>
<p><strong>关于作者</strong></p>
<p><strong>周李杰</strong>，最后一批90后，现居<strong>湖北武汉</strong></p>
<p>孤独患者，懒癌中期，无脑幻想者。但却人畜无害，无需远离。</p>
<p>兴趣众多，然无一精通。正努力成为一个有趣的人。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; print(&quot;👆以上是不完整的我&quot;) //请我吃大餐将会了解更多</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="samba简介"><a href="#samba简介" class="headerlink" title="samba简介"></a>samba简介</h2><p><a href="https://baike.baidu.com/item/samba/455025?fr=aladdin" target="_blank" rel="noopener">Samba</a>是在Linux和UNIX系统上实现<a href="https://baike.baidu.com/item/SMB协议" target="_blank" rel="noopener">SMB协议</a>的一个免费软件，由服务器及客户端程序构成。<a href="https://baike.baidu.com/item/SMB" target="_blank" rel="noopener">SMB</a>（Server Messages Block，信息服务块）是一种在<a href="https://baike.baidu.com/item/局域网" target="_blank" rel="noopener">局域网</a>上共享文件和打印机的一种<a href="https://baike.baidu.com/item/通信协议/3351624" target="_blank" rel="noopener">通信协议</a>，它为局域网内的不同计算机之间提供文件及打印机等资源的共享服务。SMB协议是客户机/服务器型协议，客户机通过该协议可以访问服务器上的共享文件系统、打印机及其他资源。通过设置“NetBIOS over TCP/IP”使得Samba不但能与局域网络主机分享资源，还能与全世界的电脑分享资源。</p>
<p>samba监听端口有：</p>
<p>TCP：139    445</p>
<p>UDP：137·    138</p>
<p>tcp端口相对应的服务是smbd服务，其作用是提供对服务器中文件、打印资源的共享访问。<br>udp端口相对应的服务是nmbd服务，其作用是提供基于NetBIOS主机名称的解析。</p>
<p><strong>samba进程：</strong></p>
<table>
<thead>
<tr>
<th align="center">进程</th>
<th align="center">对应</th>
</tr>
</thead>
<tbody><tr>
<td align="center">nmbd</td>
<td align="center">对应netbios</td>
</tr>
<tr>
<td align="center">smbd</td>
<td align="center">对应cifs协议</td>
</tr>
<tr>
<td align="center">winbindd + ldap</td>
<td align="center">对应Windows AD活动目录</td>
</tr>
</tbody></table>
<p><strong>samba用户：</strong></p>
<table>
<thead>
<tr>
<th align="center">帐号</th>
<th align="center">密码</th>
</tr>
</thead>
<tbody><tr>
<td align="center">都是系统用户 /etc/passwd</td>
<td align="center">Samba服务自有密码文件 通过smbpasswd -a USERNAME命令设置</td>
</tr>
</tbody></table>
<h3 id="smbpasswd命令"><a href="#smbpasswd命令" class="headerlink" title="smbpasswd命令"></a>smbpasswd命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-a		添加系统用户为samba用户并为其设置密码</span><br><span class="line">-d		禁用用户账号</span><br><span class="line">-e		启动用户账号</span><br><span class="line">-x		删除用户账号</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@server ~]<span class="comment"># yum -y install samba*</span></span><br><span class="line">[root@server ~]<span class="comment"># useradd 123</span></span><br><span class="line">[root@server ~]<span class="comment"># smbpasswd -a 123</span></span><br><span class="line">New SMB password:</span><br><span class="line">Retype new SMB password:</span><br><span class="line">Added user 123.</span><br><span class="line">[root@server ~]<span class="comment"># smbpasswd -d 123</span></span><br><span class="line">Disabled user 123.</span><br><span class="line">[root@server ~]<span class="comment"># smbpasswd -e 123</span></span><br><span class="line">Enabled user 123.</span><br><span class="line">[root@server ~]<span class="comment"># smbpasswd -x 123</span></span><br><span class="line">Deleted user 123.</span><br></pre></td></tr></table></figure>

<p><strong>Samba安全级别：</strong><br>Samba服务器的安全级别有三个，分别是user，server，domain</p>
<table>
<thead>
<tr>
<th align="left">安全级别</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">user</td>
<td align="left">基于本地的验证</td>
</tr>
<tr>
<td align="left">server</td>
<td align="left">由另一台指定的服务器对用户身份进行认证</td>
</tr>
<tr>
<td align="left">domain</td>
<td align="left">由域控进行身份验证</td>
</tr>
</tbody></table>
<blockquote>
<p>以前的samba版本支持的安全级别有四个，分别是share，user，server，domain<br>share是用来设置匿名访问的，但现在的版本已经不支持share了，但是还是可以实现匿名访问的（share在7版本中已经不支持）<br>只是配置方式变了</p>
</blockquote>
<p><strong>samba配置文件：</strong></p>
<ul>
<li>/etc/samba/smb.conf(主配置文件)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">[root@server samba]<span class="comment"># ls</span></span><br><span class="line">lmhosts  smb.conf  smb.conf.example</span><br><span class="line">[root@server samba]<span class="comment"># vim smb.conf</span></span><br><span class="line"><span class="comment"># See smb.conf.example for a more detailed config file or</span></span><br><span class="line"><span class="comment"># read the smb.conf manpage.</span></span><br><span class="line"><span class="comment"># Run 'testparm' to verify the config is correct after</span></span><br><span class="line"><span class="comment"># you modified it.</span></span><br><span class="line"></span><br><span class="line">[global]  <span class="comment"># 全局配置，此处的设置项对整个samba服务器都有效</span></span><br><span class="line">    workgroup = SAMBA	<span class="comment"># 表示设置工作组名称</span></span><br><span class="line">    security = user		<span class="comment"># 表示设置安全级别，其值可为user、server、domain</span></span><br><span class="line">    passdb backend = tdbsam		<span class="comment"># 表示设置共享帐户文件的类型，其值可为tdbsam（tdb数据库文件）、ldapsam（LDAP目录认证）、smbpasswd（兼容旧版本samba密码文件）</span></span><br><span class="line">    printing = cups</span><br><span class="line">    printcap name = cups</span><br><span class="line">    load printers = yes</span><br><span class="line">    cups options = raw</span><br><span class="line"></span><br><span class="line">[homes] <span class="comment"># 宿主目录共享设置，此处用来设置Linux用户的默认共享，对应用户的宿主目录。当用户访问服务器中与自己用户名同名的共享目录时，通过验证后将会自动映射到该用户的宿主目录中</span></span><br><span class="line">    comment = Home Directories	<span class="comment"># 表示设置对应共享目录的注释，说明信息，即文件共享名</span></span><br><span class="line">    valid users = %S, %D%w%S  <span class="comment"># 设置可以访问的用户和组，例如 valid users = root,@root</span></span><br><span class="line">    browseable = No		<span class="comment"># 表示设置共享是否可见</span></span><br><span class="line">    <span class="built_in">read</span> only = No </span><br><span class="line">    inherit acls = Yes</span><br><span class="line"></span><br><span class="line">[printers] <span class="comment"># 打印共享设置</span></span><br><span class="line">    comment = All Printers	 <span class="comment"># 表示设置对应共享目录的注释，说明信息，即文件共享名</span></span><br><span class="line">    path = /var/tmp		<span class="comment"># 表示共享目录的路径</span></span><br><span class="line">    printable = Yes		<span class="comment"># 表示设置是否为打印机</span></span><br><span class="line">    create mask = 0600</span><br><span class="line">    browseable = No		<span class="comment"># 表示设置共享是否可见</span></span><br><span class="line"></span><br><span class="line">[<span class="built_in">print</span>$]</span><br><span class="line">    comment = Printer Drivers	<span class="comment"># 表示设置对应共享目录的注释，说明信息，即文件共享名</span></span><br><span class="line">    path = /var/lib/samba/drivers	<span class="comment"># 表示共享目录的路径</span></span><br><span class="line">    write list = root	<span class="comment"># 表示设置允许写的用户和组，组要用@表示，例如 write list = root,@root</span></span><br><span class="line">    create mask = 0664</span><br><span class="line">    directory mask = 0775</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment"># server string 表示描述samba服务器</span></span><br><span class="line"><span class="comment"># writable 表示设置目录是否可写</span></span><br><span class="line"><span class="comment"># guest ok 表示设置是否所有人均可访问共享目录</span></span><br><span class="line"><span class="comment"># public 表示设置是否允许匿名用户访问</span></span><br><span class="line"><span class="comment"># hosts deny 设置拒绝哪台主机访问，例如 hosts deny = 192.168.176.111</span></span><br><span class="line"><span class="comment"># hosts allow 设置允许哪台主机访问，例如 hosts allow = 192.168.176.222</span></span><br><span class="line"><span class="comment"># printable 表示设置是否为打印机</span></span><br></pre></td></tr></table></figure>

<p><strong>常用配置文件参数：</strong></p>
<blockquote>
<p>可使用testparm命令检测是否有语法错误</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]# testparm</span><br><span class="line">Load smb config files from /etc/samba/smb.conf</span><br><span class="line">rlimit_max: increasing rlimit_max (1024) to minimum Windows limit (16384)</span><br><span class="line">Processing section &quot;[homes]&quot;</span><br><span class="line">Processing section &quot;[printers]&quot;</span><br><span class="line">Processing section &quot;[print$]&quot;</span><br><span class="line">Loaded services file OK.</span><br><span class="line">Server role: ROLE_STANDALONE</span><br><span class="line"></span><br><span class="line">Press enter to see a dump of your service definitions</span><br></pre></td></tr></table></figure>

<h2 id="samba访问"><a href="#samba访问" class="headerlink" title="samba访问"></a>samba访问</h2><blockquote>
<p>服务器地址：192.168.176.222</p>
<p>客户端地址：192.168.176.111</p>
</blockquote>
<p>服务端：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server ~]<span class="comment"># yum install samba* -y</span></span><br><span class="line">[root@server ~]<span class="comment"># cd /etc/samba/</span></span><br><span class="line">[root@server samba]<span class="comment"># ls</span></span><br><span class="line">lmhosts  smb.conf  smb.conf.example</span><br><span class="line">[root@server ~]<span class="comment"># cd /</span></span><br><span class="line">[root@server /]<span class="comment"># mkdir samba</span></span><br><span class="line">[root@server /]<span class="comment"># vim /etc/samba/smb.conf</span></span><br><span class="line">[root@server /]<span class="comment"># tail -n 5 /etc/samba/smb.conf</span></span><br><span class="line"></span><br><span class="line">[share]</span><br><span class="line">        path = /samba</span><br><span class="line">        browseable = Yes</span><br><span class="line">        valid users = 123</span><br><span class="line">[root@server /]<span class="comment"># systemctl restart smb nmb</span></span><br><span class="line">[root@server /]<span class="comment"># systemctl stop firewalld</span></span><br><span class="line">[root@server /]<span class="comment"># setenforce 0</span></span><br></pre></td></tr></table></figure>

<p>客户端：</p>
<ul>
<li>交互式访问</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@client ~]<span class="comment"># yum install -y samba-client</span></span><br><span class="line">[root@client ~]<span class="comment"># smbclient -L 192.168.176.222 -U 123</span></span><br><span class="line">Enter SAMBA\123<span class="string">'s password:123321</span></span><br><span class="line"><span class="string">Domain=[SEVER] OS=[Windows 6.1] Server=[Samba 4.6.2]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Sharename       Type      Comment</span></span><br><span class="line"><span class="string">        ---------       ----      -------</span></span><br><span class="line"><span class="string">        print$          Disk      Printer Drivers</span></span><br><span class="line"><span class="string">        IPC$            IPC       IPC Service (Samba 4.6.2)</span></span><br><span class="line"><span class="string">        123             Disk      Home Directories</span></span><br><span class="line"><span class="string">Domain=[SEVER] OS=[Windows 6.1] Server=[Samba 4.6.2]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Server               Comment</span></span><br><span class="line"><span class="string">        ---------            -------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Workgroup            Master</span></span><br><span class="line"><span class="string">        ---------            -------</span></span><br><span class="line"><span class="string">        SAMBA                SEVER</span></span><br><span class="line"><span class="string"># 交互式访问共享资源</span></span><br><span class="line"><span class="string">[root@client ~]# smbclient //192.168.176.222/123 -U 123</span></span><br><span class="line"><span class="string">Enter SAMBA\123'</span>s password:</span><br><span class="line">Domain=[SEVER] OS=[Windows 6.1] Server=[Samba 4.6.2]</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        0  Wed Jun 26 10:17:59 2019</span><br><span class="line">  ..                                  D        0  Wed Jun 26 10:17:59 2019</span><br><span class="line">  .bash_logout                        H       18  Thu Aug  3 05:11:00 2017</span><br><span class="line">  .bash_profile                       H      193  Thu Aug  3 05:11:00 2017</span><br><span class="line">  .bashrc                             H      231  Thu Aug  3 05:11:00 2017</span><br><span class="line"></span><br><span class="line">                17811456 blocks of size 1024. 16485268 blocks available</span><br><span class="line">smb: \&gt;</span><br><span class="line"><span class="comment"># 可用？来查看当前状态可用哪些命令</span></span><br></pre></td></tr></table></figure>

<ul>
<li>挂载方式</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@client ~]<span class="comment"># mount -t cifs //192.168.176.222/share /media -o username=123,password=123321</span></span><br><span class="line">[root@client ~]<span class="comment"># vim /etc/fstab</span></span><br><span class="line">[root@client ~]<span class="comment"># tail -n 1 /etc/fstab</span></span><br><span class="line">//192.168.176.222/share /media  cifs defaults,username=123,password=123321 0 0</span><br><span class="line">[root@client ~]<span class="comment"># df -Th</span></span><br><span class="line">文件系统                类型      容量  已用  可用 已用% 挂载点</span><br><span class="line">/dev/mapper/rhel-root   xfs        17G  3.8G   14G   22% /</span><br><span class="line">devtmpfs                devtmpfs  977M     0  977M    0% /dev</span><br><span class="line">tmpfs                   tmpfs     993M     0  993M    0% /dev/shm</span><br><span class="line">tmpfs                   tmpfs     993M  9.1M  984M    1% /run</span><br><span class="line">tmpfs                   tmpfs     993M     0  993M    0% /sys/fs/cgroup</span><br><span class="line">/dev/sr0                iso9660   3.8G  3.8G     0  100% /mnt/cdrom</span><br><span class="line">/dev/sda1               xfs      1014M  161M  854M   16% /boot</span><br><span class="line">tmpfs                   tmpfs     199M   12K  199M    1% /run/user/42</span><br><span class="line">tmpfs                   tmpfs     199M     0  199M    0% /run/user/0</span><br><span class="line">//192.168.176.222/share cifs       17G  3.9G   14G   23% /media</span><br></pre></td></tr></table></figure>

<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><ul>
<li>用户映射</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 服务端</span></span><br><span class="line">[root@client ~]<span class="comment"># cd /etc/samba/</span></span><br><span class="line">[root@client samba]<span class="comment"># vim smbusers</span></span><br><span class="line">[root@client samba]<span class="comment"># cat smbusers</span></span><br><span class="line">123 = haha</span><br><span class="line">[root@client samba]<span class="comment"># vim /etc/samba/smb.conf</span></span><br><span class="line">[global]</span><br><span class="line">        workgroup = SAMBA</span><br><span class="line">        security = user</span><br><span class="line">        username map = /etc/samba/smbusers <span class="comment"># 找到global，将此行添加上去</span></span><br><span class="line"></span><br><span class="line">[root@client samba]<span class="comment"># cd /</span></span><br><span class="line">[root@client /]<span class="comment"># mkdir camba</span></span><br><span class="line">[root@client /]<span class="comment"># vim /etc/samba/smb.conf</span></span><br><span class="line">[root@client /]<span class="comment"># tail -n 3 /etc/samba/smb.conf</span></span><br><span class="line">        path = /samba</span><br><span class="line">        browseable = Yes</span><br><span class="line">        valid users = 123</span><br><span class="line"></span><br><span class="line">[root@client samba]<span class="comment"># systemctl restart smb nmb</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 客户端</span></span><br><span class="line">[root@client media]<span class="comment"># smbclient -L 192.168.107.144 -U haha</span></span><br><span class="line">Enter SAMBA\haha<span class="string">'s password:</span></span><br><span class="line"><span class="string">Domain=[SEVER] OS=[Windows 6.1] Server=[Samba 4.6.2]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Sharename       Type      Comment</span></span><br><span class="line"><span class="string">        ---------       ----      -------</span></span><br><span class="line"><span class="string">        print$          Disk      Printer Drivers</span></span><br><span class="line"><span class="string">        share           Disk</span></span><br><span class="line"><span class="string">        IPC$            IPC       IPC Service (Samba 4.6.2)</span></span><br><span class="line"><span class="string">        123             Disk      Home Directories</span></span><br><span class="line"><span class="string">Domain=[SEVER] OS=[Windows 6.1] Server=[Samba 4.6.2]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Server               Comment</span></span><br><span class="line"><span class="string">        ---------            -------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Workgroup            Master</span></span><br><span class="line"><span class="string">        ---------            -------</span></span><br><span class="line"><span class="string">        SAMBA</span></span><br><span class="line"><span class="string">[root@client media]# vim /etc/fstab</span></span><br><span class="line"><span class="string">[root@client media]# tail -n 1 /etc/fstab</span></span><br><span class="line"><span class="string">//192.168.107.144/share /media  cifs    defaults,useradd=haha,password=123321 0 0</span></span><br><span class="line"><span class="string">[root@client media]# df -Th</span></span><br><span class="line"><span class="string">文件系统                类型      容量  已用  可用 已用% 挂载点</span></span><br><span class="line"><span class="string">/dev/mapper/rhel-root   xfs        17G  3.8G   14G   22% /</span></span><br><span class="line"><span class="string">devtmpfs                devtmpfs  977M     0  977M    0% /dev</span></span><br><span class="line"><span class="string">tmpfs                   tmpfs     993M     0  993M    0% /dev/shm</span></span><br><span class="line"><span class="string">tmpfs                   tmpfs     993M  9.1M  984M    1% /run</span></span><br><span class="line"><span class="string">tmpfs                   tmpfs     993M     0  993M    0% /sys/fs/cgroup</span></span><br><span class="line"><span class="string">/dev/sr0                iso9660   3.8G  3.8G     0  100% /mnt/cdrom</span></span><br><span class="line"><span class="string">/dev/sda1               xfs      1014M  161M  854M   16% /boot</span></span><br><span class="line"><span class="string">tmpfs                   tmpfs     199M   12K  199M    1% /run/user/42</span></span><br><span class="line"><span class="string">tmpfs                   tmpfs     199M     0  199M    0% /run/user/0</span></span><br><span class="line"><span class="string">//192.168.107.144/share cifs       17G  3.9G   14G   23% /media</span></span><br></pre></td></tr></table></figure>

<ul>
<li>匿名访问</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 服务端</span></span><br><span class="line">[root@server ~]<span class="comment"># cd /etc/samba/</span></span><br><span class="line">[root@server samba]<span class="comment"># vim smbusers</span></span><br><span class="line">[root@server samba]<span class="comment"># cat smbusers</span></span><br><span class="line">123 = haha</span><br><span class="line">[root@server samba]<span class="comment"># vim /etc/samba/smb.conf</span></span><br><span class="line">[global]</span><br><span class="line">        workgroup = SAMBA</span><br><span class="line">        security = user</span><br><span class="line">        map to guest = Bad User <span class="comment"># 找到global，将此行添加上去</span></span><br><span class="line"><span class="comment"># 加入下列6行     </span></span><br><span class="line">[share] </span><br><span class="line">        path = /samba</span><br><span class="line">        browseable = Yes</span><br><span class="line">        guest ok = yes</span><br><span class="line">        public = yes</span><br><span class="line">        writable = yes</span><br><span class="line"></span><br><span class="line">[root@server samba]<span class="comment"># systemctl restart smb nmb</span></span><br><span class="line">[root@server samba]<span class="comment"># chmod 777 /samba</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 客户端</span></span><br><span class="line">[root@client media]<span class="comment"># vim /etc/fstab</span></span><br><span class="line">[root@client media]<span class="comment"># tail -n 1 /etc/fstab</span></span><br><span class="line">//192.168.107.144/share /media  cifs    defaults,username=<span class="string">'BadUser'</span> 0 0</span><br><span class="line">[root@client media]<span class="comment"># mount -a</span></span><br><span class="line">\[root@client media]<span class="comment"># df -Th</span></span><br><span class="line">文件系统                类型      容量  已用  可用 已用% 挂载点</span><br><span class="line">/dev/mapper/rhel-root   xfs        17G  3.8G   14G   22% /</span><br><span class="line">devtmpfs                devtmpfs  977M     0  977M    0% /dev</span><br><span class="line">tmpfs                   tmpfs     993M     0  993M    0% /dev/shm</span><br><span class="line">tmpfs                   tmpfs     993M  9.1M  984M    1% /run</span><br><span class="line">tmpfs                   tmpfs     993M     0  993M    0% /sys/fs/cgroup</span><br><span class="line">/dev/sr0                iso9660   3.8G  3.8G     0  100% /mnt/cdrom</span><br><span class="line">/dev/sda1               xfs      1014M  161M  854M   16% /boot</span><br><span class="line">tmpfs                   tmpfs     199M   12K  199M    1% /run/user/42</span><br><span class="line">tmpfs                   tmpfs     199M     0  199M    0% /run/user/0</span><br><span class="line">//192.168.107.144/share cifs       17G  3.9G   14G   23% /media</span><br></pre></td></tr></table></figure>

<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><p>1.搭建匿名用户共享服务器<br>2.搭建用户认证共享服务器</p>
<p>要求：<br>1.不论是匿名用户还是用户认证共享，均要在客户机验证结果<br>2.用户认证共享需要映射系统用户为一个虚拟用户</p>

      
      <!-- 打赏 -->
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chineselijie/2020/03/12/19.linux--samba服务/" data-id="ck7ooyafu001e4su6ojr9scp1"
        class="article-share-link">分享</a>
        
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux进阶/">linux进阶</a></li></ul>

    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-18.linux--FTP服务" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/03/12/18.linux--FTP服务/"
    >FTP服务</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/03/12/18.linux--FTP服务/" class="article-date">
  <time datetime="2020-03-12T11:38:40.247Z" itemprop="datePublished">2020-03-12</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux进阶/">linux进阶</a>
  </div>

      
      
      
    </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <blockquote>
<p><strong>关于作者</strong></p>
<p><strong>周李杰</strong>，最后一批90后，现居<strong>湖北武汉</strong></p>
<p>孤独患者，懒癌中期，无脑幻想者。但却人畜无害，无需远离。</p>
<p>兴趣众多，然无一精通。正努力成为一个有趣的人。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; print(&quot;👆以上是不完整的我&quot;) //请我吃大餐将会了解更多</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>[TOC]</p>
<h2 id="FTP简介"><a href="#FTP简介" class="headerlink" title="FTP简介"></a>FTP简介</h2><p>网络文件共享服务主流的主要有三种，分别是<strong>ftp</strong>、<strong>nfs</strong>、<strong>samba</strong></p>
<p><strong>FTP</strong>:<a href="https://baike.baidu.com/item/ftp/13839?fr=aladdin" target="_blank" rel="noopener"><strong>文件传输协议</strong>（英文：<strong>F</strong>ile <strong>T</strong>ransfer <strong>P</strong>rotocol，缩写：<strong>FTP</strong>）</a>是用于在<a href="https://baike.baidu.com/item/网络" target="_blank" rel="noopener">网络</a>上进行文件传输的一套标准协议，使用客户/服务器模式。它属于<a href="https://baike.baidu.com/item/网络传输协议" target="_blank" rel="noopener">网络传输协议</a>的<a href="https://baike.baidu.com/item/应用层" target="_blank" rel="noopener">应用层</a>。文件传送（file transfer）和文件访问（file access）之间的区别在于：前者由FTP提供，后者由如NFS等应用系统提供。</p>
<p>FTP是一个8位的客户端-服务器协议，能操作任何类型的文件而不需要进一步处理，就像MIME或Unicode一样。但是，FTP有着极高的延时，这意味着，从开始请求到第一次接收需求数据之间的时间，会非常长；并且不时的必须执行一些冗长的登录进程。</p>
<p>在使用FTP时候，用户经常会遇到两种概念：</p>
<ul>
<li>上传</li>
</ul>
<blockquote>
<p>将自己电脑上的文件拷贝到远端主机上</p>
</blockquote>
<ul>
<li>下载</li>
</ul>
<blockquote>
<p>从远端主机拷贝文件到自己的电脑上面</p>
</blockquote>
<h2 id="FTP架构"><a href="#FTP架构" class="headerlink" title="FTP架构"></a>FTP架构</h2><p>FTP工作于应用层，它监听tcp的21号端口，是一种c/s架构的应用程序。其有多种客户端和服务端的应用程序</p>
<ul>
<li><p>客户端工具</p>
<ul>
<li>ftp</li>
<li>liftp，lftpget</li>
<li>wget，curl</li>
<li>filezilla</li>
<li>gftp(linux GUI)</li>
<li>商业软件(flashftp,cuteftp)</li>
</ul>
</li>
<li><p>服务端软件</p>
<ul>
<li>wu-ftpd</li>
<li>proftpd(提供web接口的一种ftp服务端程序)</li>
<li>pureftp</li>
<li>vsftpd(Very Secure)</li>
<li>ServU(windows平台的一种强大ftp服务端程序)</li>
</ul>
</li>
</ul>
<h2 id="FTP数据连接模式"><a href="#FTP数据连接模式" class="headerlink" title="FTP数据连接模式"></a>FTP数据连接模式</h2><p>ftp有2种数据连接模式：</p>
<ul>
<li>命令连接：是指文件管理类命令，始终在线的持久性连接，直到用户退出登录为止</li>
<li>数据连接：是指数据传输，按需创建及关闭的连接<ul>
<li>数据传输格式：<ul>
<li>文件传输</li>
<li>二进制传输</li>
</ul>
</li>
<li>数据传输模式：<ul>
<li>主动模式：由服务器端创建数据连接</li>
<li>被动模式：由客户端创建数据连接</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>主动模式下</p>
<ul>
<li>命令连接：</li>
</ul>
<p>客户端以大于1023的随机端口去连接ftp服务端的21号端口</p>
<p>1024 –&gt; 21 建立命令连接</p>
<ul>
<li>数据连接：</li>
</ul>
<p>服务端以自己的20号端口去连接客户端建立命令连接时的端口+1的端口号</p>
<p>20 –&gt; 1025 建立数据连接 </p>
</li>
<li><p>被动模式下</p>
<ul>
<li>命令连接</li>
</ul>
<p>客户端以一个随机端口(1110)来连接服务器端的21号端口，之后服务器会返回一个告知客户端连接服务端的哪个端口号</p>
<p>1110 –&gt; 21 (告知客户端连接哪一个端口)</p>
<ul>
<li>数据连接</li>
</ul>
<p>客户端以创建命令连接的端口+1 (1110 + 1)的端口号去连接服务器端通过命令连接告知自己的一个随机端口号来创建数据连接</p>
<p>1111 –&gt; （服务端告知自己的端口）</p>
</li>
</ul>
<blockquote>
<p><strong>注意：</strong></p>
<p>主动模式有个弊端，因为客户端的端口是随机的，如果客户端开了防火墙，那么服务器端去连接客户端创建数据连接时就可能会被拒绝。</p>
</blockquote>
<h2 id="用户认证"><a href="#用户认证" class="headerlink" title="用户认证"></a>用户认证</h2><p>FTP的用户主要有三种：</p>
<ul>
<li>虚拟用户：仅用于访问某特定服务中的资源</li>
<li>系统用户：可以登录系统的真实用户</li>
<li>匿名用户</li>
</ul>
<h2 id="vsftpd"><a href="#vsftpd" class="headerlink" title="vsftpd"></a>vsftpd</h2><h3 id="vsftpd安装"><a href="#vsftpd安装" class="headerlink" title="vsftpd安装"></a>vsftpd安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># yum install -y vsftpd</span></span><br><span class="line">........</span><br><span class="line">已安装:</span><br><span class="line">  vsftpd.x86_64 0:3.0.2-22.el7</span><br><span class="line"></span><br><span class="line">完毕！</span><br></pre></td></tr></table></figure>

<h3 id="vsftpd配置"><a href="#vsftpd配置" class="headerlink" title="vsftpd配置"></a>vsftpd配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置文件目录</span></span><br><span class="line">[root@client111 ~]<span class="comment"># ls -ld /etc/vsftpd</span></span><br><span class="line">drwxr-xr-x. 2 root root 88 6月  27 15:45 /etc/vsftpd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主配置文件</span></span><br><span class="line">[root@client111 ~]<span class="comment"># ls -l /etc/vsftpd/vsftpd.conf</span></span><br><span class="line">-rw-------. 1 root root 5030 8月   3 2017 /etc/vsftpd/vsftpd.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># vsftpd用户认证配置文件</span></span><br><span class="line">[root@client111 ~]<span class="comment"># ls -l /etc/pam.d/vsftpd</span></span><br><span class="line">-rw-r--r--. 1 root root 335 8月   3 2017 /etc/pam.d/vsftpd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 匿名用户（映射为ftp用户）的共享资源位置是/var/ftp</span></span><br><span class="line"><span class="comment"># 系统用户通过ftp访问的资源位置为用户的家目录</span></span><br><span class="line"><span class="comment"># 虚拟用户通过ftp访问的资源位置为给虚拟用户指定的映射成为的系统用户的家目录</span></span><br></pre></td></tr></table></figure>

 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">anonymous_enable=YES				启用匿名用户登陆</span><br><span class="line">anon_upload_enable=YES			允许匿名用户上传</span><br><span class="line">anon_mkdir_write_enable=YES		允许匿名用户创建目录，但是不能删除</span><br><span class="line">anon_other_write_enable=YES		允许匿名用户创建和删除目录</span><br><span class="line">local_enable=YES					启用本地用户登陆</span><br><span class="line">write_enable=YES					允许本地用户有写权限</span><br><span class="line">local_umask=022					通过FTP上传文件的默认遮罩码</span><br><span class="line">chroot_local_user=YES				禁锢所有FTP本地用户只能在其家目录中</span><br><span class="line">chroot_list_enable=YES			开启禁锢文件列表；需要与chroot_list_file参数一起使用</span><br><span class="line">chroot_list_file=/etc/vsftp/chroot_list	 指定禁锢列表文件路径；在此文件里面的用户将被禁锢在其家目录中</span><br><span class="line">allow_writeable_chroot=YES		允许被禁锢的用户家目录有写权限</span><br><span class="line">xferlog_enable=YES				是否启用传输日志，记录FTP传输过程</span><br><span class="line">xferlog_std_format=YES			传输日志是否使用标准格式</span><br><span class="line">xferlog_file=/var/<span class="built_in">log</span>/xferlog		指定传输日志存储的位置</span><br><span class="line">chown_uploads=YES					是否启用改变上传文件属性的功能</span><br><span class="line">chown_username=whoever			指定要将上传的文件的属主改为哪个用户，此用户必须在系统中存在</span><br><span class="line">pam_service_name=vsftpd			指定vsftp使用/etc/pam.d下的哪个pam配置文件进行用户认证</span><br><span class="line">userlist_enable=YES				是否启用控制用户登陆的列表文件：默认为/etc/vsftpd/user_list文件</span><br><span class="line">userlist_deny=YES					是否拒绝userlist指定的列表文件中存在的用户登陆FTP</span><br><span class="line">max_cients=`<span class="comment">#`					最大并发连接数</span></span><br><span class="line">max_per_ip=`<span class="comment">#`					每个IP可同时发起的并发请求数</span></span><br><span class="line">anon_max_rate						匿名用户的最大传输速率，单位是‘字节/秒’</span><br><span class="line">local_max_rate					本地用户的最大传输速率，单位是‘字节/秒’</span><br><span class="line">dirmessage_enable=YES				启用某目录下的.message描述信息</span><br><span class="line"><span class="comment">#假设有一个目录，在此目录下面创建一个名为.message的文件，在此文件内写入一些描述信息之后切换出目录，目录会自动显示.message文件中的内容</span></span><br><span class="line"></span><br><span class="line">message_file						设置访问一个目录时获得的目录信息文件的文件名，默认是.message</span><br><span class="line">idle_session_timeout=600			设置默认的断开不活跃session的时间</span><br><span class="line">data_connection_timeout=120		设置数据传输超时时间</span><br><span class="line">ftpd_banner=<span class="string">"Welcome to chenlf FTP service."</span>	定制欢迎信息，登陆FTP时自动显示</span><br></pre></td></tr></table></figure>

<h3 id="vsftpd虚拟用户配置"><a href="#vsftpd虚拟用户配置" class="headerlink" title="vsftpd虚拟用户配置"></a>vsftpd虚拟用户配置</h3><ul>
<li><p>虚拟用户的配置：</p>
<ul>
<li>所有的虚拟用户会被统一映射为一个指定的系统账号，访问的共享位置即为此系统账号的家目录</li>
<li>各虚拟用户可被赋予不同的访问权限，通过匿名用户的权限控制参数进行指定</li>
<li>虚拟用户账号的存储方式：<ul>
<li>文件：编辑文件，此文件需要为<a href="https://baike.baidu.com/item/Hash/390310" target="_blank" rel="noopener">编码hash格式</a>。<ul>
<li>文件奇数行为用户</li>
<li>偶数行为密码</li>
</ul>
</li>
<li>关系型数据库的表中：<ul>
<li>通过即时查询数据库完成用户认证</li>
<li>mysql库：pam要依赖于pam_mysql软件，可以通过epel源yum安装</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>vsftpd虚拟用户的配置步骤：</p>
<ul>
<li>安装依赖的程序</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># cd /etc/yum.repos.d/</span></span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># wget http://mirrors.163.com/.help/CentOS7-Base-163.repo</span></span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># vim CentOS7-Base-163.repo</span></span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># tail -n 5 CentOS7-Base-163.repo</span></span><br><span class="line">name=CentOS-<span class="variable">$releasever</span> - Plus - 163.com</span><br><span class="line">baseurl=http://mirrors.163.com/centos/<span class="variable">$releasever</span>/centosplus/<span class="variable">$basearch</span>/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1   <span class="comment"># 此处将0改为1</span></span><br><span class="line">gpgkey=http://mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7</span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># yum clean all</span></span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># yum install -y epel-release</span></span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># yum install -y vsftpd</span></span><br></pre></td></tr></table></figure>

<ul>
<li>创建文本格式的用户名以及密码</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 yum.repos.d]<span class="comment"># cd /etc/vsftpd/</span></span><br><span class="line">[root@client111 vsftpd]<span class="comment"># vim vu.list</span></span><br><span class="line">[root@client111 vsftpd]<span class="comment"># cat vu.list</span></span><br><span class="line">123</span><br><span class="line">123321</span><br><span class="line">abc</span><br><span class="line">123321</span><br><span class="line"><span class="comment"># 用户和密码一一对应，前面为账户，后面为密码</span></span><br><span class="line">[root@client111 vsftpd]<span class="comment"># id 123</span></span><br><span class="line">id: 123: no such user</span><br><span class="line">[root@client111 vsftpd]<span class="comment"># id abc</span></span><br><span class="line">id: abc: no such user</span><br><span class="line"><span class="comment"># 账户在系统中没有创建过</span></span><br></pre></td></tr></table></figure>

<ul>
<li>安装db4工具</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 vsftpd]<span class="comment"># yum install -y db4*</span></span><br></pre></td></tr></table></figure>

<ul>
<li>使用db4工具将刚才编辑的vu.list转换成数据库文件(vu.db)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-T 表示转换		-t 表示加密方式使用<span class="built_in">hash</span>算法加密</span><br><span class="line">[root@client111 vsftpd]<span class="comment"># db_load -T -t hash -f /etc/vsftpd/vu.list /etc/vsftpd/vu.db</span></span><br><span class="line">[root@client111 vsftpd]<span class="comment"># ls</span></span><br><span class="line">ftpusers  user_list  vsftpd.conf  vsftpd_conf_migrate.sh  vu.db  vu.list</span><br><span class="line">[root@client111 vsftpd]<span class="comment"># file vu.*</span></span><br><span class="line">vu.db:   Berkeley DB (Hash, version 9, native byte-order)</span><br><span class="line">vu.list: ASCII text</span><br></pre></td></tr></table></figure>

<ul>
<li>为防止数据泄露，将文件权限设置为600</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 vsftpd]<span class="comment"># chmod 600 vu.*</span></span><br><span class="line">[root@client111 vsftpd]<span class="comment"># ls -l vu.*</span></span><br><span class="line">-rw-------. 1 root root 12288 6月  27 17:16 vu.db</span><br><span class="line">-rw-------. 1 root root    22 6月  27 17:08 vu.list</span><br></pre></td></tr></table></figure>

<ul>
<li>添加虚拟用户的映射账号，创建ftp的根目录</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 vsftpd]<span class="comment"># useradd -d /file -s /sbin/nologin vftp</span></span><br><span class="line">[root@client111 vsftpd]<span class="comment"># cd /</span></span><br><span class="line">[root@client111 /]<span class="comment"># ls -ld file</span></span><br><span class="line">drwx------. 3 vftp vftp 78 6月  27 17:32 file</span><br><span class="line">[root@client111 /]<span class="comment"># chmod 755 file</span></span><br><span class="line">[root@client111 /]<span class="comment"># ls -ld file</span></span><br><span class="line">drwxr-xr-x. 3 vftp vftp 78 6月  27 17:32 file</span><br></pre></td></tr></table></figure>

<ul>
<li>备份vsftpd用户认证配置文件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 pam.d]<span class="comment"># cp /etc/pam.d/vsftpd&#123;,.bak&#125;</span></span><br><span class="line">[root@client111 pam.d]<span class="comment"># ls vsftpd*</span></span><br><span class="line">vsftpd  vsftpd.bak</span><br></pre></td></tr></table></figure>

<ul>
<li>为虚拟用户建立pam认证</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 pam.d]<span class="comment"># vim /etc/pam.d/vsftpd</span></span><br><span class="line">[root@client111 pam.d]<span class="comment"># cat /etc/pam.d/vsftpd</span></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line">auth required pam_userdb.so db=/etc/vsftpd/vu</span><br><span class="line">account required pam_userdb.so db=/etc/vsftpd/vu</span><br></pre></td></tr></table></figure>

<ul>
<li>修改vsftpd配置文件,添加虚拟用户支持</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 pam.d]<span class="comment"># vim /etc/vsftpd/vsftpd.conf</span></span><br><span class="line">[root@client111 pam.d]<span class="comment"># tail -n 2 /etc/vsftpd/vsftpd.conf</span></span><br><span class="line">guest_enable=YES</span><br><span class="line">guest_username=vftp</span><br></pre></td></tr></table></figure>

<ul>
<li>为不同的虚拟用户建立独立的配置文件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 pam.d]<span class="comment"># vim /etc/vsftpd/vsftpd.conf</span></span><br><span class="line">[root@client111 pam.d]<span class="comment"># tail -n 2 /etc/vsftpd/vsftpd.conf</span></span><br><span class="line">user_config_dir=/etc/vsftpd/vusers_dir</span><br><span class="line">allow_writeable_chroot=YES</span><br></pre></td></tr></table></figure>

<p>上述配置配置完成之后，转到/etc/vsftpd/vusers_dir目录中为每个虚拟用户分别建立配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 pam.d]<span class="comment"># mkdir /etc/vsftpd/vusers_dir</span></span><br><span class="line">[root@client111 pam.d]<span class="comment"># cd /etc/vsftpd/vusers_dir</span></span><br><span class="line">[root@client111 vusers_dir]<span class="comment"># ls</span></span><br><span class="line">[root@client111 vusers_dir]<span class="comment"># touch 123</span></span><br><span class="line">[root@client111 vusers_dir]<span class="comment"># touch abc</span></span><br></pre></td></tr></table></figure>

<ul>
<li>设置虚拟用户123能上传和下载，而abc可以上传文件和创建目录、以及下载。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 vusers_dir]<span class="comment"># vim 123</span></span><br><span class="line">[root@client111 vusers_dir]<span class="comment"># vim abc</span></span><br><span class="line">[root@client111 vusers_dir]<span class="comment"># cat 123</span></span><br><span class="line">anon_upload_enable=YES</span><br><span class="line">[root@client111 vusers_dir]<span class="comment"># cat abc</span></span><br><span class="line">anon_upload_enable=YES</span><br><span class="line">anon_mkdir_write_enable=YES</span><br></pre></td></tr></table></figure>

<ul>
<li>重启服务</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 vusers_dir]<span class="comment"># systemctl restart vsftpd</span></span><br></pre></td></tr></table></figure>

<p>此时用另外一台主机去访问</p>
<ul>
<li>安装lftp</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@server222 ~]<span class="comment"># yum install -y lftp</span></span><br></pre></td></tr></table></figure>

<ul>
<li>查看lftp的帮助用法</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@server222 ~]<span class="comment"># lftp --help</span></span><br><span class="line">用法: lftp [OPTS] &lt;site&gt;</span><br><span class="line">`lftp<span class="string">' 是在 rc 文件执行后 lftp 执行的第一个命令</span></span><br><span class="line"><span class="string"> -f &lt;file&gt;           执行文件中的命令后退出</span></span><br><span class="line"><span class="string"> -c &lt;cmd&gt;            执行命令后退出</span></span><br><span class="line"><span class="string"> --help              显示帮助信息后退出</span></span><br><span class="line"><span class="string"> --version           显示 lftp 版本后退出</span></span><br><span class="line"><span class="string"> 其他的选项同 `open'</span> 命令</span><br><span class="line"> -e &lt;cmd&gt;            在选择后执行命令</span><br><span class="line"> -u &lt;user&gt;[,&lt;pass&gt;]  使用指定的用户名/口令进行验证</span><br><span class="line"> -p &lt;port&gt;           连接指定的端口</span><br><span class="line"> &lt;site&gt;              主机名, URL 或书签的名字</span><br></pre></td></tr></table></figure>

<ul>
<li>连接192.168.176.111中的abc用户</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@server222 ~]<span class="comment"># lftp -u abc,123321 192.168.176.111</span></span><br><span class="line">lftp abc@192.168.176.111:~&gt; ls</span><br><span class="line">lftp abc@192.168.176.111:/&gt; mkdir abc</span><br><span class="line">mkdir 成功, 建立 `abc<span class="string">'</span></span><br><span class="line"><span class="string">lftp abc@192.168.176.111:/&gt; ls</span></span><br><span class="line"><span class="string">drwx------    2 1001     1001            6 Jun 27 14:28 abc</span></span><br></pre></td></tr></table></figure>

<ul>
<li>可用help或者？来查看帮助命令</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">lftp abc@192.168.176.111:/&gt; <span class="built_in">help</span></span><br><span class="line">    !&lt;shell-command&gt;                     (commands)</span><br><span class="line">    <span class="built_in">alias</span> [&lt;name&gt; [&lt;value&gt;]]             attach [PID]</span><br><span class="line">    bookmark [SUBCMD]                    cache [SUBCMD]</span><br><span class="line">    cat [-b] &lt;files&gt;                     <span class="built_in">cd</span> &lt;rdir&gt;</span><br><span class="line">    chmod [OPTS] mode file...            close [-a]</span><br><span class="line">    [re]cls [opts] [path/][pattern]      debug [&lt;level&gt;|off] [-o &lt;file&gt;]</span><br><span class="line">    du [options] &lt;<span class="built_in">dirs</span>&gt;                  <span class="built_in">exit</span> [&lt;code&gt;|<span class="built_in">bg</span>]</span><br><span class="line">    get [OPTS] &lt;rfile&gt; [-o &lt;lfile&gt;]      glob [OPTS] &lt;cmd&gt; &lt;args&gt;</span><br><span class="line">    <span class="built_in">help</span> [&lt;cmd&gt;]                         <span class="built_in">history</span> -w file|-r file|-c|-l [cnt]</span><br><span class="line">    <span class="built_in">jobs</span> [-v] [&lt;job_no...&gt;]              <span class="built_in">kill</span> all|&lt;job_no&gt;</span><br><span class="line">    lcd &lt;ldir&gt;                           lftp [OPTS] &lt;site&gt;</span><br><span class="line">    ln [-s] &lt;file1&gt; &lt;file2&gt;              ls [&lt;args&gt;]</span><br><span class="line">    mget [OPTS] &lt;files&gt;                  mirror [OPTS] [remote [<span class="built_in">local</span>]]</span><br><span class="line">    mkdir [-p] &lt;<span class="built_in">dirs</span>&gt;                    module name [args]</span><br><span class="line">    more &lt;files&gt;                         mput [OPTS] &lt;files&gt;</span><br><span class="line">    mrm &lt;files&gt;                          mv &lt;file1&gt; &lt;file2&gt;</span><br><span class="line">    [re]nlist [&lt;args&gt;]                   open [OPTS] &lt;site&gt;</span><br><span class="line">    pget [OPTS] &lt;rfile&gt; [-o &lt;lfile&gt;]     put [OPTS] &lt;lfile&gt; [-o &lt;rfile&gt;]</span><br><span class="line">    <span class="built_in">pwd</span> [-p]                             queue [OPTS] [&lt;cmd&gt;]</span><br><span class="line">    quote &lt;cmd&gt;                          repeat [OPTS] [delay] [<span class="built_in">command</span>]</span><br><span class="line">    rm [-r] [-f] &lt;files&gt;                 rmdir [-f] &lt;<span class="built_in">dirs</span>&gt;</span><br><span class="line">    scache [&lt;session_no&gt;]                <span class="built_in">set</span> [OPT] [&lt;var&gt; [&lt;val&gt;]]</span><br><span class="line">    site &lt;site-cmd&gt;                      <span class="built_in">source</span> &lt;file&gt;</span><br><span class="line">    torrent [-O &lt;dir&gt;] &lt;file|URL&gt;...     user &lt;user|URL&gt; [&lt;pass&gt;]</span><br><span class="line">    <span class="built_in">wait</span> [&lt;jobno&gt;]                       zcat &lt;files&gt;</span><br><span class="line">    zmore &lt;files&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>进入192.168.176.111</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 /]<span class="comment"># cd file/</span></span><br><span class="line">[root@client111 file]<span class="comment"># ls</span></span><br><span class="line">abc</span><br><span class="line">[root@client111 file]<span class="comment"># echo "1234567890" &gt; abc.txt</span></span><br><span class="line">[root@client111 file]<span class="comment"># ls</span></span><br><span class="line">abc  abc.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>进入192.168.176.222</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@server222 ~]<span class="comment"># lftp -u abc,123321 192.168.176.111</span></span><br><span class="line">lftp abc@192.168.176.111:~&gt; ls</span><br><span class="line">drwx------    3 1001     1001           21 Jun 27 14:34 abc</span><br><span class="line">-rw-r--r--    1 0        0              11 Jun 27 14:39 abc.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>下载abc.txt</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@server222 ~]<span class="comment"># lftp -u abc,123321 192.168.176.111</span></span><br><span class="line">lftp abc@192.168.176.111:~&gt; ls</span><br><span class="line">drwx------    3 1001     1001           21 Jun 27 14:34 abc</span><br><span class="line">-rw-r--r--    1 0        0              11 Jun 27 14:39 abc.txt</span><br><span class="line">lftp abc@192.168.176.111:/&gt; get abc.txt -o /opt</span><br><span class="line">11 bytes transferred</span><br><span class="line">lftp abc@192.168.176.111:/&gt; <span class="built_in">exit</span></span><br><span class="line">[root@server222 ~]<span class="comment"># ll /opt</span></span><br><span class="line">总用量 4</span><br><span class="line">-rw-r--r--. 1 root root 11 6月  27 22:39 abc.txt</span><br><span class="line">drwxr-xr-x. 2 root root  6 3月  26 2015 rh</span><br></pre></td></tr></table></figure>

<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><p>1.安装vsftpd<br>2.配置匿名用户ftp<br>3.配置虚拟用户ftp<br>4.配置系统用户ftp<br>5.写博客，要写明ftp的使用场景以及如何安装与配置</p>
<p>要求：<br>1.安装并配置完成后要使用ftp客户端工具登录验证</p>

      
      <!-- 打赏 -->
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chineselijie/2020/03/12/18.linux--FTP服务/" data-id="ck7ooyafs001b4su6lhw1vhwt"
        class="article-share-link">分享</a>
        
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux进阶/">linux进阶</a></li></ul>

    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-17.linux--openssh服务" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/03/12/17.linux--openssh服务/"
    >openssh</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/03/12/17.linux--openssh服务/" class="article-date">
  <time datetime="2020-03-12T11:38:40.246Z" itemprop="datePublished">2020-03-12</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux进阶/">linux进阶</a>
  </div>

      
      
      
    </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <blockquote>
<p><strong>关于作者</strong></p>
<p><strong>周李杰</strong>，最后一批90后，现居<strong>湖北武汉</strong></p>
<p>孤独患者，懒癌中期，无脑幻想者。但却人畜无害，无需远离。</p>
<p>兴趣众多，然无一精通。正努力成为一个有趣的人。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; print(&quot;👆以上是不完整的我&quot;) //请我吃大餐将会了解更多</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="openssh"><a href="#openssh" class="headerlink" title="openssh"></a>openssh</h2><p>[TOC]</p>
<h2 id="使用ssh访问远程命令行"><a href="#使用ssh访问远程命令行" class="headerlink" title="使用ssh访问远程命令行"></a>使用ssh访问远程命令行</h2><h3 id="openssh-简介"><a href="#openssh-简介" class="headerlink" title="openssh 简介"></a>openssh 简介</h3><p>OpenSSH 是 <a href="http://baike.baidu.com/view/16184.htm" target="_blank" rel="noopener">SSH</a> （Secure <a href="http://baike.baidu.com/view/849.htm" target="_blank" rel="noopener">SHell</a>） 协议的免费开源实现。SSH协议族可以用来进行远程控制， 或在计算机之间传送文件。而实现此功能的传统方式，如telnet(<a href="http://baike.baidu.com/view/190233.htm" target="_blank" rel="noopener">终端仿真</a>协议)、 rcp ftp、 rlogin、rsh都是极为不安全的，并且会使用明文传送密码。OpenSSH提供了服务端后台程序和客户端工具，用来加密远程控件和文件传输过程中的数据，并由此来代替原来的类似服务。</p>
<p>常见的远程登陆工具有：</p>
<ul>
<li>telnet</li>
<li>ssh</li>
<li>dropbear</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">telnet 远程登陆协议：23/TCP</span><br><span class="line">	认证明文</span><br><span class="line">	数据传输明文</span><br><span class="line">	</span><br><span class="line">ssh  全称:secure shell 是应用层协议，22/tcp</span><br><span class="line">	通过认证过程是加密的，主机认证</span><br><span class="line">	用户认证过程加密</span><br><span class="line">	数据传输过程加密</span><br><span class="line"></span><br><span class="line">dropbear 为嵌入式系统专用的ssh服务器端和客户端工具</span><br></pre></td></tr></table></figure>

<h3 id="ssh版本"><a href="#ssh版本" class="headerlink" title="ssh版本"></a>ssh版本</h3><p>openssh有两个版本，分别为v1和v2，其特点如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v1版本：基于crc-32做mac，但没有其防范中间人的攻击</span><br><span class="line"><span class="comment"># 中间人含义解释：在主机以及网关中间，告诉主机我是网关，却又告诉网关我是主机</span></span><br><span class="line">v2版本：双方主机协议选择安全的mac方式。基于DH算法做密钥交换，基于RSA或者DSA算法实现身份认证</span><br></pre></td></tr></table></figure>

<h3 id="ssh认证方式"><a href="#ssh认证方式" class="headerlink" title="ssh认证方式"></a>ssh认证方式</h3><p>openssh有两种认证方式，分别是：</p>
<ul>
<li>基于口令认证</li>
<li>基于密钥认证</li>
</ul>
<h3 id="openssh的工作模式"><a href="#openssh的工作模式" class="headerlink" title="openssh的工作模式"></a>openssh的工作模式</h3><p>openssh是基于C/S架构工作的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C/S架构</span><br><span class="line"><span class="comment"># Client/Server架构，即客户端/服务器架构。</span></span><br><span class="line">B/S结构</span><br><span class="line"><span class="comment"># 即Browser/Server (浏览器/服务器) 结构</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">服务器端   sshd  配置文件在/etc/ssh/sshd_config</span><br><span class="line">客户端     ssh   配置文件在/etc/ssh/ssh_config</span><br><span class="line">	ssh-keygen  密钥生成器</span><br><span class="line">    ssh-copy-id 将公钥传输至远程服务器</span><br><span class="line">    scp         跨主机安全复制工具</span><br></pre></td></tr></table></figure>

<h3 id="secure-shell-示例"><a href="#secure-shell-示例" class="headerlink" title="secure shell 示例"></a>secure shell 示例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@clirnt ~]<span class="comment"># ssh root@192.168.107.144</span></span><br><span class="line">The authenticity of host <span class="string">'192.168.107.144 (192.168.107.144)'</span> can<span class="string">'t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:ckD0Gi2156g1NjAR4mGFYX4gYlcI4IH4VWYHuz9bDSg.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is MD5:1b:f5:48:ce:e5:18:d2:fe:be:55:46:69:d6:67:06:4c.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added '</span>192.168.107.144<span class="string">' (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">root@192.168.107.144'</span>s password:</span><br><span class="line">Last login: Mon May 20 03:21:23 2019 from 192.168.107.1</span><br><span class="line">[root@server ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//以当前用户身份创建远程交互式shell，然后在结束时使用<span class="built_in">exit</span>命令返回到之前的shell</span><br><span class="line">[root@clirnt ~]<span class="comment"># ssh 192.168.107.144</span></span><br><span class="line">root@192.168.107.144<span class="string">'s password:</span></span><br><span class="line"><span class="string">Last login: Mon May 20 03:23:00 2019 from 192.168.107.140</span></span><br><span class="line"><span class="string">[root@server ~]# exit</span></span><br><span class="line"><span class="string">登出</span></span><br><span class="line"><span class="string">Connection to 192.168.107.144 closed.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//以远程用户身份（remoteuser）在远程主机（remotehost）上通过将输出返回到本地显示器的方式来执行单一命令</span></span><br><span class="line"><span class="string">[root@clirnt ~]# ssh zhou@192.168.107.144 '</span>/usr/bin/cat /etc/hostname<span class="string">'</span></span><br><span class="line"><span class="string">zhou@192.168.107.144'</span>s password:</span><br><span class="line">144</span><br><span class="line"></span><br><span class="line">/w命令可以显示当前登录到计算机的用户列表。这对于显示哪些用户使用ssh从哪些远程位置进行了登录以及执行了何种操作等内容特别有用</span><br><span class="line">[root@server ~]<span class="comment"># w</span></span><br><span class="line"> 03:42:04 up  3:08,  3 users,  load average: 0.00, 0.01, 0.05</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     :0       :0               00:34   ?xdm?  35.24s  0.13s /usr/libexec/gn</span><br><span class="line">root     pts/0    192.168.107.1    03:21    4.00s  0.03s  0.00s w</span><br><span class="line">zhou     pts/1    192.168.107.140  03:42    2.00s  0.02s  0.02s -bash</span><br></pre></td></tr></table></figure>

<h3 id="ssh主机密钥"><a href="#ssh主机密钥" class="headerlink" title="ssh主机密钥"></a>ssh主机密钥</h3><p>​    ssh通过公钥加密的方式保持通信的安全，当某一ssh客户端连接到ssh服务器时，在该客户端登录之前，服务器会向其发送公钥副本。这可用于为通信渠道设置安全加密，并可验证客户端的服务器。</p>
<p>​    当用户第一次使用<code>ssh</code>连接到特定服务器时，ssh命令可在用户的<del>/.ssh/known_hosts文件中存储该服务器的公钥。在此之后每当用户进行连接时，客户端都会通过对比</del>/.ssh/known_hosts文件中的服务器条目和服务器发送的公钥，确保从服务器获得相同的公钥。如果公钥不匹配，客户端会假定网络通信已遭劫持或服务器已被入侵，并且中断连接。</p>
<p>​    这意味着，如果服务器的公钥发生更改（由于硬盘出现故障导致公钥丢失，或者出于某些正当理由替换公钥），用户则需要更新其~/.ssh/known_hosts文件并删除旧的条目才能够进行登录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//主机ID存储在本地客户端系统上的 /root/.ssh/known_hosts 中</span><br><span class="line">[root@clirnt ~]<span class="comment"># cat .ssh/known_hosts</span></span><br><span class="line">192.168.107.144 ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBNpzCsuRZmBI8gq7WVjQNzuVlNqukUQj9i62JhdGmBK9Tm38P+MXMJRfeRz2q2KpP5Klbdiwysxei6byi3KXCC8=</span><br><span class="line">192.168.107.140 ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBB1oHAfCZcxVYWUygQ2PaN2NiVKs2+W/pT4xXUKXDK2etvkj1qEETkZGgVo4kTxQBmujhfCcdHl7/vfL6qVR7P4=</span><br><span class="line"></span><br><span class="line">//主机密钥存储在SSH服务器上的 /etc/ssh/ssh_host_key* 中</span><br><span class="line">[root@server ~]<span class="comment"># ls /etc/ssh/*key*</span></span><br><span class="line">/etc/ssh/ssh_host_ecdsa_key      /etc/ssh/ssh_host_ed25519_key.pub</span><br><span class="line">/etc/ssh/ssh_host_ecdsa_key.pub  /etc/ssh/ssh_host_rsa_key</span><br><span class="line">/etc/ssh/ssh_host_ed25519_key    /etc/ssh/ssh_host_rsa_key.pub</span><br></pre></td></tr></table></figure>

<h2 id="配置基于ssh密钥的身份验证"><a href="#配置基于ssh密钥的身份验证" class="headerlink" title="配置基于ssh密钥的身份验证"></a>配置基于ssh密钥的身份验证</h2><p>​    用户可通过使用公钥身份验证进行ssh登录身份验证。ssh允许用户使用私钥-公钥方案进行身份验证。这意味着将生成私钥和公钥这两个密钥。私钥文件用作身份验证凭据，像密码一样，必须妥善保管。公钥复制到用户希望登录的系统，用于验证私钥。公钥并不需要保密。拥有公钥的ssh服务器可以发布仅持有您私钥的系统才可解答的问题。因此，可以根据所持有的密钥进行验证。如此一来，就不必在每次访问系统时键入密码，但安全性仍能得到保证。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用ssh-keygen命令生成密码。将会生成私钥~/.ssh/id_rsa和公钥~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<blockquote>
<p>生成密钥时，系统将提供指定密码的选项，在访问私钥时必须提供该密码。如果私钥被偷，除颁发者之外的其他任何人很难使用该私钥，因为已使用密码对其进行保护。这样，在攻击者破解并使用私钥前，会有足够的时间生成新的密钥对并删除所有涉及旧密钥的内容。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">生成ssh密钥后，密钥将默认存储在家目录下的.ssh/目录中。私钥和公钥的权限就分别为600和644。.ssh目录权限必须是700</span><br></pre></td></tr></table></figure>

<p>在可以使用基于密钥的身份验证前，需要将公钥复制到目标系统上。可以使用<code>ssh-copy-id</code>命令完成这一操作</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@clirnt ~]<span class="comment"># ssh-copy-id root@192.168.107.144</span></span><br><span class="line">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: <span class="string">"/root/.ssh/id_rsa.pub"</span></span><br><span class="line">/usr/bin/ssh-copy-id: INFO: attempting to <span class="built_in">log</span> <span class="keyword">in</span> with the new key(s), to filter out any that are already installed</span><br><span class="line">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- <span class="keyword">if</span> you are prompted now it is to install the new keys</span><br><span class="line">root@192.168.107.144<span class="string">'s password: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Number of key(s) added: 1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Now try logging into the machine, with:   "ssh '</span>root@192.168.107.144<span class="string">'"</span></span><br><span class="line"><span class="string">and check to make sure that only the key(s) you wanted were added.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在通过ssh-copy-id将密钥复制到另一系统时，它默认复制~/.ssh/id_rsa.pub文件</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">//SSH密钥演示</span><br><span class="line">//使用 ssh-keygen 创建公钥-私钥对</span><br><span class="line">[root@clirnt ~]<span class="comment"># ssh-keygen -t rsa</span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/root/.ssh/id_rsa): </span><br><span class="line">/root/.ssh/id_rsa already exists.</span><br><span class="line">Overwrite (y/n)? y</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:L382dyk3r5TizdnGKXJfikf3buKfzCbnTXe5Ufz5vqM root@140</span><br><span class="line">The key<span class="string">'s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|                 |</span></span><br><span class="line"><span class="string">|                 |</span></span><br><span class="line"><span class="string">|                 |</span></span><br><span class="line"><span class="string">|               . |</span></span><br><span class="line"><span class="string">|        S       o|</span></span><br><span class="line"><span class="string">|         .    ..*|</span></span><br><span class="line"><span class="string">|        . . ..o*X|</span></span><br><span class="line"><span class="string">|         o o+@*&amp;/|</span></span><br><span class="line"><span class="string">|          .o=E^^&amp;|</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//使用 ssh-copy-id 将公钥复制到远程系统上的正确位置</span></span><br><span class="line"><span class="string">[root@clirnt ~]# ls .ssh/</span></span><br><span class="line"><span class="string">id_rsa  id_rsa.pub  known_hosts</span></span><br><span class="line"><span class="string">[root@clirnt ~]# ssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.107.144</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/root/.ssh/id_rsa.pub"</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed</span></span><br><span class="line"><span class="string">/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys</span></span><br><span class="line"><span class="string">root@192.168.107.144'</span>s password: </span><br><span class="line"></span><br><span class="line">Number of key(s) added: 1</span><br><span class="line"></span><br><span class="line">Now try logging into the machine, with:   <span class="string">"ssh 'root@192.168.107.144'"</span></span><br><span class="line">and check to make sure that only the key(s) you wanted were added.</span><br><span class="line"></span><br><span class="line">//使用 ssh 命令无命令登录远程主机</span><br><span class="line">[root@clirnt ~]<span class="comment"># ssh root@192.168.107.144</span></span><br><span class="line">Last login: Mon May 20 06:30:57 2019 from 192.168.107.1</span><br><span class="line"></span><br><span class="line">//使用 scp 命令传送文件到远程主机</span><br><span class="line">[root@clirnt ~]<span class="comment"># scp 1 root@192.168.107.144:/root</span></span><br><span class="line">1                                                100%   18    15.4KB/s   00:00    </span><br><span class="line">[root@clirnt ~]<span class="comment"># ssh root@192.168.107.144</span></span><br><span class="line">Last login: Mon May 20 07:06:44 2019 from 192.168.107.140</span><br><span class="line">[root@server ~]<span class="comment"># ls</span></span><br><span class="line">1                initial-setup-ks.cfg  模板  图片  下载  桌面</span><br><span class="line">anaconda-ks.cfg  公共                  视频  文档  音乐</span><br><span class="line"></span><br><span class="line">//使用 scp 命令从远程主机上下载文件到本地</span><br><span class="line">[root@clirnt ~]<span class="comment"># ls</span></span><br><span class="line">1                initial-setup-ks.cfg  公共  视频  文档  音乐</span><br><span class="line">anaconda-ks.cfg  root@192.168.107.144  模板  图片  下载  桌面</span><br><span class="line">[root@clirnt ~]<span class="comment"># rm -f 1</span></span><br><span class="line">[root@clirnt ~]<span class="comment"># ls</span></span><br><span class="line">anaconda-ks.cfg       root@192.168.107.144  模板  图片  下载  桌面</span><br><span class="line">initial-setup-ks.cfg  公共                  视频  文档  音乐</span><br><span class="line">[root@clirnt ~]<span class="comment"># scp root@192.168.107.144:/root/1 /root</span></span><br><span class="line">1                                                100%   18    22.3KB/s   00:00    </span><br><span class="line">[root@clirnt ~]<span class="comment"># ls</span></span><br><span class="line">1                initial-setup-ks.cfg  公共  视频  文档  音乐</span><br><span class="line">anaconda-ks.cfg  root@192.168.107.144  模板  图片  下载  桌面</span><br><span class="line"></span><br><span class="line">//scp命令常用选项</span><br><span class="line">    -r      //递归复制</span><br><span class="line">    -p      //保持权限</span><br><span class="line">    -P      //端口</span><br><span class="line">    -q      //静默模式</span><br><span class="line">    -a      //全部复制</span><br></pre></td></tr></table></figure>

<h2 id="自定义ssh服务配置"><a href="#自定义ssh服务配置" class="headerlink" title="自定义ssh服务配置"></a>自定义ssh服务配置</h2><p>虽然<code>OpenSSH</code>服务器通常无需修改，但会提供其他安全措施，可以在配置文件<code>/etc/ssh/sshd_config</code>中修改<code>OpenSSH</code>服务器的各个方面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PermitRootLogin &#123;yes|no&#125;    //是否允许root用户远程登录系统</span><br><span class="line">PermitRootLogin without-password    //仅允许root用户基于密钥方式远程登录</span><br><span class="line">PasswordAuthentication &#123;yes|no&#125;     //是否启用密码身份验证，默认开启</span><br></pre></td></tr></table></figure>

<h2 id="ssh安全注意事项"><a href="#ssh安全注意事项" class="headerlink" title="ssh安全注意事项"></a>ssh安全注意事项</h2><ul>
<li>密码应该经常换且足够复杂</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@clirnt ~]#  tr -dc A-Za-z0-9_ &lt; /dev/urandom | head -c 30 |xargs   //生成30位的密码</span><br><span class="line">LYH9cbirdT6E_hbColMFjZNf9Kd6If</span><br><span class="line"></span><br><span class="line">[root@clirnt ~]# openssl rand 20 -base64</span><br><span class="line">Di9ry+dyV40xVvBHirsc3XpBOzg=    //生成20位随机密码</span><br></pre></td></tr></table></figure>

<ul>
<li>使用非默认端口</li>
<li>限制登录客户端地址</li>
<li>仅监听特定的IP地址</li>
<li>禁止管理员直接登录</li>
<li>仅允许有限制用户登录<ul>
<li>AllowUsers</li>
<li>AllowGroups</li>
</ul>
</li>
<li>使用基于密钥的认证</li>
<li>禁止使用空密码</li>
<li>禁止使用SSHv1版本</li>
<li>设定空闲会话超时时长</li>
<li>利用防火墙设置ssh访问策略</li>
<li>限制ssh的访问频度和并发在线数</li>
<li>做好日志的备份，经常分析（集中于某台服务器）</li>
</ul>
<h2 id="作业"><a href="#作业" class="headerlink" title="作业"></a>作业</h2><p>1.说明密钥认证的过程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">第一步：本地创建密钥对</span><br><span class="line">第二步：本地将公钥发到远端</span><br><span class="line">第三步：进行免登陆测试</span><br></pre></td></tr></table></figure>

<p>2.手动配置密钥认证登录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//使用 ssh-keygen 创建公钥-私钥对</span><br><span class="line">[root@clirnt ~]<span class="comment"># ssh-keygen -t rsa</span></span><br><span class="line">            <span class="comment"># [回车三次 直至出现RSA 2048]</span></span><br><span class="line">//使用 ssh-copy-id 将公钥复制到远程系统上的正确位置</span><br><span class="line">[root@clirnt ~]<span class="comment"># ls .ssh/</span></span><br><span class="line">id_rsa  id_rsa.pub  known_hosts</span><br><span class="line">[root@clirnt ~]<span class="comment"># ssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.107.144</span></span><br><span class="line">			<span class="comment">#[选择yes之后输入密码]</span></span><br><span class="line">//使用 ssh 命令无命令登录远程主机</span><br><span class="line">[root@clirnt ~]<span class="comment"># ssh root@192.168.107.144</span></span><br><span class="line">Last login: Mon May 20 06:30:57 2019 from 192.168.107.1</span><br></pre></td></tr></table></figure>


      
      <!-- 打赏 -->
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chineselijie/2020/03/12/17.linux--openssh服务/" data-id="ck7ooyafn00184su6zy51rbat"
        class="article-share-link">分享</a>
        
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux进阶/">linux进阶</a></li></ul>

    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-2.linux--linux命令" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/03/12/2.linux--linux命令/"
    >Linux基础命令</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/03/12/2.linux--linux命令/" class="article-date">
  <time datetime="2020-03-12T11:30:53.340Z" itemprop="datePublished">2020-03-12</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux基础/">linux基础</a>
  </div>

      
      
      
    </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <blockquote>
<p><strong>关于作者</strong></p>
<p><strong>周李杰</strong>，最后一批90后，现居<strong>湖北武汉</strong></p>
<p>孤独患者，懒癌中期，无脑幻想者。但却人畜无害，无需远离。</p>
<p>兴趣众多，然无一精通。正努力成为一个有趣的人。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; print(&quot;👆以上是不完整的我&quot;) //请我吃大餐将会了解更多</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="man-查询命令"><a href="#man-查询命令" class="headerlink" title="man 查询命令"></a>man 查询命令</h3><blockquote>
<p>man是一种查询帮助命令，当你不知道这么命令后的参数，可用man命令来查看。</p>
<p>例如下面我输出了”man ls” 查询ls-man的帮助文档（里面介绍了ls各种详细信息)。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># man ls</span></span><br><span class="line">LS(1)                            User Commands                           LS(1)</span><br><span class="line">NAME</span><br><span class="line">       ls - list directory contents</span><br><span class="line">SYNOPSIS</span><br><span class="line">       ls [OPTION]... [FILE]...</span><br><span class="line"></span><br><span class="line">-a, --all</span><br><span class="line">              <span class="keyword">do</span> not ignore entries starting with .</span><br><span class="line">       -A, --almost-all</span><br><span class="line">              <span class="keyword">do</span> not list implied . and ..</span><br></pre></td></tr></table></figure>

<h3 id="echo-输出"><a href="#echo-输出" class="headerlink" title="echo 输出"></a>echo 输出</h3><blockquote>
<p>echo 就是一个输出命令，可别小看这个输出命令，在后面脚本文件运用的可相当多。</p>
<p>例如下面我将输入echo的一些简单用法</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># echo 123</span></span><br><span class="line">123</span><br><span class="line">[root@MR ~]<span class="comment"># echo $SHELL</span></span><br><span class="line">/bin/bash</span><br><span class="line">[root@MR ~]<span class="comment"># [ $USER = root ] &amp;&amp; echo "Admin" || echo "User"</span></span><br><span class="line">Admin   <span class="comment">#在此解析此含义：此时用户是不是root，如果是，则输出“Admin”，反之则输出“user”</span></span><br></pre></td></tr></table></figure>

<h3 id="date-显示时间"><a href="#date-显示时间" class="headerlink" title="date 显示时间"></a>date 显示时间</h3><blockquote>
<p>date为显示时间命令，单独输入显示如下</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># date</span></span><br><span class="line">2019年 03月 13日 星期三 02:18:20 CST</span><br></pre></td></tr></table></figure>

<blockquote>
<p>哇，怎么才13号凌晨两点钟，现在才是北京时间14号18点50分啊</p>
<p>那我们就来更改一下吧</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># date -s "20190314 18:50:00"</span></span><br><span class="line">2019年 03月 14日 星期四 18:50:00 CST</span><br></pre></td></tr></table></figure>

<h3 id="reboot-重启"><a href="#reboot-重启" class="headerlink" title="reboot 重启"></a>reboot 重启</h3><blockquote>
<p>用于重启系统，这个就在此不演示</p>
</blockquote>
<h3 id="poweroff-关机"><a href="#poweroff-关机" class="headerlink" title="poweroff 关机"></a>poweroff 关机</h3><blockquote>
<p>关机命令，但我习惯使用“shutdown +0” ，后面加几就代表几分钟后面关机，加0就是立马关机，例如下面我设置100分钟后关机</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># shutdown +100</span></span><br><span class="line">Shutdown scheduled <span class="keyword">for</span> 四 2019-03-14 20:46:02 CST, use <span class="string">'shutdown -c'</span> to cancel.    <span class="comment">#含义就是将在20点46分执行关机，如果你想取消请执行'shutdown -c'</span></span><br><span class="line">[root@MR ~]<span class="comment"># shutdown -c</span></span><br><span class="line">Broadcast message from root@MR.ZLJ (Thu 2019-03-14 19:07:19 CST):</span><br><span class="line">The system shutdown has been cancelled at Thu 2019-03-14 19:08:19 CST!</span><br><span class="line"><span class="comment"># 这里就提示了系统关闭已于2019-03-14星期四19:08:19 CST取消！</span></span><br></pre></td></tr></table></figure>

<h3 id="wget-下载"><a href="#wget-下载" class="headerlink" title="wget 下载"></a>wget 下载</h3><blockquote>
<p>下载命令，后接下载地址，下面介绍一些常用的参数</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># wget http://mirrors.aliyun.com/repo/Centos-6.repo</span></span><br><span class="line"><span class="comment"># 直接下载</span></span><br><span class="line">[root@MR ~]<span class="comment"># wget -O CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo</span></span><br><span class="line"><span class="comment"># -O CentOS-Base.repo表示下载之后以CentOS-Base.repo来命名</span></span><br><span class="line">[root@MR ~]<span class="comment"># wget -r -p http://mirrors.aliyun.com</span></span><br><span class="line"><span class="comment"># -r -p递归下载网站里所有内容</span></span><br></pre></td></tr></table></figure>

<h3 id="ps-显示进程"><a href="#ps-显示进程" class="headerlink" title="ps 显示进程"></a>ps 显示进程</h3><blockquote>
<p>含义：查看系统中进程状态</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># ps</span></span><br><span class="line">   PID TTY          TIME CMD</span><br><span class="line">  3492 pts/0    00:00:00 bash</span><br><span class="line">  3514 pts/0    00:00:00 ps</span><br><span class="line">  <span class="comment"># 单独输出是这样</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>上面主要用于查看哪些东西在运行，然后我们不要的可以用Kill+PID来结束</p>
<p>ps有三个常用参数：</p>
<p>-a:显示所有进程（包括其他用户的进程）   </p>
<p>-u:用户以及其他详细信息   </p>
<p>-x:显示没有控制终端的进程</p>
<p>大多数情况，我们都是将-a、-u、-x连在一起使用：-aux</p>
<p>下面我们来敲打吧。。。。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># ps -aux</span></span><br><span class="line">  USER        PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span><br><span class="line">  root          1  0.0  0.3  49988  6412 ?        Ss   15:01   0:01 /usr/lib/syste</span><br><span class="line">  root          2  0.0  0.0      0     0 ?        S    15:01   0:00 [kthreadd]</span><br><span class="line">  root          3  0.0  0.0      0     0 ?        S    15:01   0:00 [ksoftirqd/0]</span><br><span class="line">  root          5  0.0  0.0      0     0 ?        S&lt;   15:01   0:00 [kworker/0:0H]</span><br><span class="line">  ......................以下省略好多条........................</span><br></pre></td></tr></table></figure>

<blockquote>
<p>? 这么多，让我看到猴年马月吗？</p>
<p>然而并不是，其实ps是与后面管道符搭配使用，用来抓取与某一个指定服务进程相对应的PID号码。</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left"><strong>USER：进程的所有者</strong></th>
<th align="left"><strong>TTY：所在终端</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>PID：进程ID号</strong></td>
<td align="left"><strong>STAT：进程状态</strong></td>
</tr>
<tr>
<td align="left"><strong>%CPU：运算器占用率</strong></td>
<td align="left"><strong>START：被启动的时间</strong></td>
</tr>
<tr>
<td align="left"><strong>%MEM：内存占用率</strong></td>
<td align="left"><strong>TIME：实际使用CPU的时间</strong></td>
</tr>
<tr>
<td align="left"><strong>VSZ：虚拟内存使用量（KB）</strong></td>
<td align="left"><strong>COMMAND：命令名称与参数</strong></td>
</tr>
<tr>
<td align="left"><strong>RSS：占用的固定内存量（KB）</strong></td>
<td align="left"></td>
</tr>
</tbody></table>
<blockquote>
<p>上面这些含义我们只需要混一个脸熟就可以了，下面这就就需要我们详细的记住了：</p>
<p>R(运行)：进程正在运行或在运行队列中等待 </p>
<p>S(中断)：进程处于休眠中，当某个条件形成后或者接收到信号时，则脱离该状态</p>
<p>D(不可中断)：进程不响应系统异步信号，即便用kill命令也不能将其中断</p>
<p>Z(僵尸)：进程已经终止，但进程描述符依然存在, 直到父进程调用wait4()系统函数后将进程释放 </p>
<p>T(停止)：进程收到停止信号后停止运行 </p>
</blockquote>
<h3 id="top-动态显示进程"><a href="#top-动态显示进程" class="headerlink" title="top 动态显示进程"></a>top 动态显示进程</h3><blockquote>
<p>动态监视进程活动与系统负载，我们亲切地称之它为强化版的windows中的任务管理器，怎么个强化法，往下看吧。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># top</span></span><br><span class="line">top - 20:30:05 up  5:28,  3 users,  load average: 0.00, 0.01, 0.05</span><br><span class="line">Tasks: 407 total,   2 running, 405 sleeping,   0 stopped,   0 zombie</span><br><span class="line">%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">KiB Mem:   1870760 total,   313124 used,  1557636 free,      780 buffers</span><br><span class="line">KiB Swap:  2097148 total,        0 used,  2097148 free.   100424 cached Mem</span><br><span class="line"></span><br><span class="line">   PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND</span><br><span class="line">     1 root      20   0   49988   6412   3716 S  0.0  0.3   0:01.62 systemd</span><br><span class="line">     2 root      20   0       0      0      0 S  0.0  0.0   0:00.02 kthreadd</span><br><span class="line">     3 root      20   0       0      0      0 S  0.0  0.0   0:00.01 ksoftirqd/0</span><br><span class="line">     5 root       0 -20       0      0      0 S  0.0  0.0   0:00.00 kworker/0:+</span><br><span class="line"><span class="comment"># 此时我这里就一个进程在启用，其余为0的都为停止或者等待为用户服务</span></span><br><span class="line"><span class="comment"># -20 所代表优先级最高</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>第1行：系统时间、运行时间、登录终端数、系统负载（三个数值分别为1分钟、5分钟、15分钟内负载情况，</p>
<p>第2行：进程总数、运行中的进程数、睡眠中的进程数、停止的进程数、僵死的进程数 </p>
<p>第3行：用户占用资源百分比、系统内核占用资源百分比、正在占用的百分比、资源空闲百分比 </p>
<p>第4行：物理内存总量、内存使用量、内存空闲量、作为内核缓存的内存量</p>
<p>第5行：虚拟内存总量、虚拟内存使用量、虚拟内存空闲量、已被提前加载的内存量 </p>
</blockquote>
<h3 id="pidof-后面接服务来查看PID"><a href="#pidof-后面接服务来查看PID" class="headerlink" title="pidof 后面接服务来查看PID"></a>pidof 后面接服务来查看PID</h3><blockquote>
<p>用于查询某个服务进程的PID，每个PID如同身份证一样是唯一的</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># pidof top</span></span><br><span class="line">3645</span><br></pre></td></tr></table></figure>

<h3 id="kill-终止PID"><a href="#kill-终止PID" class="headerlink" title="kill 终止PID"></a>kill 终止PID</h3><blockquote>
<p>用于终止某个服务进程的PID</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># kill 3685</span></span><br><span class="line">[root@MR ~]<span class="comment"># pidof top</span></span><br><span class="line">[root@MR ~]<span class="comment">#</span></span><br><span class="line"><span class="comment">#终止之后，我们在来查看，这里就看不到top正在运行了</span></span><br></pre></td></tr></table></figure>

<h3 id="killall终止服务所有PID"><a href="#killall终止服务所有PID" class="headerlink" title="killall终止服务所有PID"></a>killall终止服务所有PID</h3><blockquote>
<p>有些服务，它的进程PID值远远不止一个，怎样去结束他们呢，我们可用killall来终止这种服务，那么顾名思义，killall就是某个服务的全部进程</p>
</blockquote>
<h3 id="ifconfig-查看网卡配置"><a href="#ifconfig-查看网卡配置" class="headerlink" title="ifconfig 查看网卡配置"></a>ifconfig 查看网卡配置</h3><blockquote>
<p>用于获取网卡配置与网络状态等信息 </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eno16777736: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    link/ether 00:0c:29:b6:10:19 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.233.132/24 brd 192.168.233.255 scope global dynamic eno16777736</span><br><span class="line">       valid_lft 1290sec preferred_lft 1290sec</span><br><span class="line">    inet6 fe80::20c:29ff:feb6:1019/64 scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"># 由于我使用的是文本界面，是不带GUI的，所以只能使用&quot;ip a&quot;供大家查看，具体可以在图形化界面中输入&quot;ifconfig&quot;查看</span><br></pre></td></tr></table></figure>

<h3 id="uname-查看内核信息"><a href="#uname-查看内核信息" class="headerlink" title="uname 查看内核信息"></a>uname 查看内核信息</h3><blockquote>
<p>用于查看内核与版本信息，常常在后面接 -a</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># uname</span></span><br><span class="line">Linux</span><br><span class="line">[root@MR ~]<span class="comment"># uname -a</span></span><br><span class="line">Linux MR.ZLJ 3.10.0-123.el7.x86_64 <span class="comment">#1 SMP Mon May 5 11:16:57 EDT 2014 x86_64 x86_64 x86_64 GNU/Linux</span></span><br></pre></td></tr></table></figure>

<h3 id="uptime-显示top的第一行"><a href="#uptime-显示top的第一行" class="headerlink" title="uptime 显示top的第一行"></a>uptime 显示top的第一行</h3><blockquote>
<p>查看系统的内核负载信息</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># uptime</span></span><br><span class="line"> 21:22:18 up  6:20,  3 users,  load average: 0.00, 0.01, 0.05</span><br><span class="line">   时间     运行了多久  开了几个终端       最近1分钟，5分钟，15分钟 </span><br><span class="line"><span class="comment">#此命令相当于top命令的第一行</span></span><br></pre></td></tr></table></figure>

<h3 id="free-查看内存信息"><a href="#free-查看内存信息" class="headerlink" title="free 查看内存信息"></a>free 查看内存信息</h3><blockquote>
<p>显示当前系统中内存的使用量信息 </p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># free</span></span><br><span class="line">             total       used       free     shared    buffers     cached</span><br><span class="line">Mem:       1870760     327300    1543460       8752        792     113392</span><br><span class="line">-/+ buffers/cache:     213116    1657644</span><br><span class="line">Swap:      2097148          0    2097148</span><br></pre></td></tr></table></figure>

<blockquote>
<p>天啊！这是啥，我怎么看不懂，这要一个个的数单位吗？</p>
<p>其实不用，下面我将会 用”-h” 人性化的角度来显示</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># free -h</span></span><br><span class="line">            内存总量    已用量      可用量 进程共享的内存量 磁盘缓存的内存量 缓存的内存量</span><br><span class="line">             total       used    free      shared          buffers        cached</span><br><span class="line">Mem:          1.8G       319M    1.5G       8.5M             792K          110M</span><br><span class="line">-/+ buffers/cache:       208M    1.6G</span><br><span class="line">Swap:         2.0G         0B    2.0G</span><br></pre></td></tr></table></figure>

<h3 id="who-谁（此时为哪个用户）"><a href="#who-谁（此时为哪个用户）" class="headerlink" title="who 谁（此时为哪个用户）"></a>who 谁（此时为哪个用户）</h3><blockquote>
<p>用于查看当前登入主机的用户终端信息 </p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># who</span></span><br><span class="line">root     tty1         2019-03-12 22:34</span><br><span class="line">root     pts/0        2019-03-14 19:44 (192.168.233.1)</span><br><span class="line"><span class="comment"># 我正在使用putty.exe 远程链接此系统</span></span><br></pre></td></tr></table></figure>

<h3 id="last-查看当前系统的登陆记录"><a href="#last-查看当前系统的登陆记录" class="headerlink" title="last  查看当前系统的登陆记录"></a>last  查看当前系统的登陆记录</h3><blockquote>
<p>用于查看所有系统的登录记录 </p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># last</span></span><br><span class="line">root     pts/1        192.168.233.1    Thu Mar 14 21:03 - 21:03  (00:00)</span><br><span class="line">root     pts/1        192.168.233.1    Thu Mar 14 20:57 - 20:58  (00:00)</span><br><span class="line">root     pts/1        192.168.233.1    Thu Mar 14 20:55 - 20:57  (00:01)</span><br><span class="line">......................以下省略好多条........................</span><br><span class="line">wtmp begins Wed Mar  6 16:48:05 2019</span><br><span class="line"><span class="comment">#于2019年3月6日星期三16:48:05开始</span></span><br></pre></td></tr></table></figure>

<h3 id="history-查看历史命令"><a href="#history-查看历史命令" class="headerlink" title="history  查看历史命令"></a>history  查看历史命令</h3><blockquote>
<p>用于显示历史执行过的命令 </p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># history</span></span><br><span class="line">    1  sudo useradd huangbichun</span><br><span class="line">    2  <span class="built_in">cd</span> huangbichun</span><br><span class="line">......................以下省略好多条........................</span><br><span class="line">  543  who</span><br><span class="line">  544  last</span><br><span class="line">  545  <span class="built_in">history</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>再次执行那一条命令可以用”!+数字 “</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># !543</span></span><br><span class="line">who</span><br><span class="line">root     tty1         2019-03-12 22:34</span><br><span class="line">root     pts/0        2019-03-14 19:44 (192.168.233.1)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>清除历史命令可用”history -c”</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># history -c</span></span><br><span class="line">[root@MR ~]<span class="comment"># history</span></span><br><span class="line">    1  <span class="built_in">history</span></span><br></pre></td></tr></table></figure>

<h3 id="sosreport-收集系统信息"><a href="#sosreport-收集系统信息" class="headerlink" title="sosreport  收集系统信息"></a>sosreport  收集系统信息</h3><blockquote>
<p>用于收集系统配置及架构信息并输出诊断文档 </p>
</blockquote>
<h3 id="pwd-显示当前所在目录"><a href="#pwd-显示当前所在目录" class="headerlink" title="pwd  显示当前所在目录"></a>pwd  显示当前所在目录</h3><blockquote>
<p>显示用户当前所处的工作目录 </p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># pwd</span></span><br><span class="line">/root</span><br><span class="line">[root@MR ~]<span class="comment"># cd /home</span></span><br><span class="line">[root@MR home]<span class="comment"># pwd</span></span><br><span class="line">/home</span><br></pre></td></tr></table></figure>

<h3 id="cd-切换目录"><a href="#cd-切换目录" class="headerlink" title="cd  切换目录"></a>cd  切换目录</h3><blockquote>
<p>用于切换工作路径 </p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># cd /home</span></span><br></pre></td></tr></table></figure>

<h3 id="ls-列出当前目录下的文件"><a href="#ls-列出当前目录下的文件" class="headerlink" title="ls  列出当前目录下的文件"></a>ls  列出当前目录下的文件</h3><blockquote>
<p>用于显示目录中的文件信息 </p>
<p>-a :查看全部文件（包括隐藏文件）</p>
<p>-l：查看文件的属性、大小等详细信息</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># ls -a</span></span><br><span class="line">.                .bash_history </span><br><span class="line">..               .bash_logout   .cshrc .tcshrc</span><br><span class="line">2019-03-09-测试  .bash_profile   .viminfo</span><br><span class="line">anaconda-ks.cfg  .bashrc         </span><br><span class="line">[root@MR ~]<span class="comment"># ls -l</span></span><br><span class="line">总用量 24</span><br><span class="line">drwxr-xr-x. 2 root root     6 3月  12 22:38 2019-03-09-测试</span><br><span class="line">-rw-------. 1 root root   810 3月   6 16:33 anaconda-ks.cfg</span><br><span class="line">[root@MR ~]<span class="comment"># ls -al</span></span><br><span class="line">总用量 68</span><br><span class="line">dr-xr-x---.  5 root root  4096 3月  14 19:17 .</span><br><span class="line">drwxr-xr-x. 17 root root  4096 3月  15 18:09 ..</span><br><span class="line">drwxr-xr-x.  2 root root     6 3月  12 22:38 2019-03-09-测试</span><br><span class="line">-rw-------.  1 root root   810 3月   6 16:33 anaconda-ks.cfg</span><br><span class="line">-rw-------.  1 root root  7368 3月  14 22:16 .bash_history</span><br><span class="line">-rw-r--r--.  1 root root    18 12月 29 2013 .bash_logout</span><br><span class="line">-rw-r--r--.  1 root root   176 12月 29 2013 .bash_profile</span><br><span class="line">-rw-r--r--.  1 root root   224 3月   7 21:59 .bashrc</span><br><span class="line">-rw-r--r--.  1 root root   100 12月 29 2013 .cshrc</span><br><span class="line">-rw-r--r--.  1 root root    15 3月   7 21:44 passwod</span><br><span class="line">-rw-r--r--.  1 root root   129 12月 29 2013 .tcshrc</span><br><span class="line">-rw-------.  1 root root  5656 3月  11 17:44 .viminfo</span><br></pre></td></tr></table></figure>

<h3 id="cat-查看文本文件（适用于短文本）"><a href="#cat-查看文本文件（适用于短文本）" class="headerlink" title="cat  查看文本文件（适用于短文本）"></a>cat  查看文本文件（适用于短文本）</h3><blockquote>
<p>查看纯文本文件 (适合内容较少)</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># cat CentOS-Base.repo</span></span><br><span class="line"><span class="comment"># CentOS-Base.repo</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The mirror system uses the connecting IP address of the client and the</span></span><br><span class="line">......................以下省略好多条........................</span><br></pre></td></tr></table></figure>

<blockquote>
<p>天啊！这么多，我只想要中间的一行，怎么办，没事，Linux中每一个命令都有参数，那么我们接下来看吧。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># cat -n CentOS-Base.repo</span></span><br><span class="line">     1  <span class="comment"># CentOS-Base.repo</span></span><br><span class="line">     2  <span class="comment">#</span></span><br><span class="line">     3  <span class="comment"># The mirror system uses the connecting IP address of the client and the</span></span><br><span class="line">......................以下省略好多条........................</span><br><span class="line">    61  enabled=0</span><br><span class="line">    62  gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-6</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这样我们就可以清晰的看到有多少行数据了</p>
</blockquote>
<h3 id="more-查看文本文件-适用于长文本"><a href="#more-查看文本文件-适用于长文本" class="headerlink" title="more  查看文本文件(适用于长文本)"></a>more  查看文本文件(适用于长文本)</h3><blockquote>
<p> 以百分比、翻页形式查看</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># more CentOS-Base.repo</span></span><br><span class="line"><span class="comment"># CentOS-Base.repo</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The mirror system uses the connecting IP address of the client and the</span></span><br><span class="line">--More--(32%)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果我们不想看，可以按下字母q退出，或者按ctrl+c</p>
</blockquote>
<h3 id="head-查看一定行数"><a href="#head-查看一定行数" class="headerlink" title="head  查看一定行数"></a>head  查看一定行数</h3><blockquote>
<p>默认下显示前十行，我们也可以输入-n 【输入一个数字】来查看你想要看到的前多少行</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># head CentOS-Base.repo</span></span><br><span class="line"><span class="comment"># CentOS-Base.repo</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The mirror system uses the connecting IP address of the client and the</span></span><br><span class="line">......................以下省略7条........................</span><br><span class="line">[root@MR ~]<span class="comment"># head -n 1 CentOS-Base.repo</span></span><br><span class="line"><span class="comment"># CentOS-Base.repo</span></span><br></pre></td></tr></table></figure>

<h3 id="tail-查看一定行数"><a href="#tail-查看一定行数" class="headerlink" title="tail   查看一定行数"></a>tail   查看一定行数</h3><blockquote>
<p>默认下只显示后十行，我们也可以输入-n 【输入一个数字】来查看你想要看到的后多少行</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># tail CentOS-Base.repo</span></span><br><span class="line"><span class="comment">#contrib - packages by Centos Users</span></span><br><span class="line">[contrib]</span><br><span class="line">name=CentOS-<span class="variable">$releasever</span> - Contrib - mirrors.aliyun.com</span><br><span class="line">......................以下省略7条........................</span><br><span class="line">[root@MR ~]<span class="comment"># tail -n 1 CentOS-Base.repo</span></span><br><span class="line">gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-6</span><br></pre></td></tr></table></figure>

<h3 id="tr-替换文本文件中的字符"><a href="#tr-替换文本文件中的字符" class="headerlink" title="tr  替换文本文件中的字符"></a>tr  替换文本文件中的字符</h3><blockquote>
<p>用于替换文本文件文件中的字符</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># cat 1</span></span><br><span class="line">a b c d</span><br><span class="line">[root@MR ~]<span class="comment"># cat 1 | tr [a-d] [A-D]</span></span><br><span class="line">A B C D</span><br></pre></td></tr></table></figure>

<h3 id="wc-用于统计文本文件的行数、字数、字节数"><a href="#wc-用于统计文本文件的行数、字数、字节数" class="headerlink" title="wc 用于统计文本文件的行数、字数、字节数"></a>wc 用于统计文本文件的行数、字数、字节数</h3><blockquote>
<p>用于统计指定文本的行数、字数、字节数</p>
<p>-l 只显示行数</p>
<p>-w 只显示单词数</p>
<p>-c 只显示字节数</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#例如我现在来统计刚才这个1文本</span></span><br><span class="line">[root@MR ~]<span class="comment"># wc -l 1</span></span><br><span class="line">1 1</span><br><span class="line"><span class="comment">#1这个文本只有一行</span></span><br><span class="line">[root@MR ~]<span class="comment"># wc -w 1</span></span><br><span class="line">4 1</span><br><span class="line"><span class="comment">#1这个文本只有4个单词</span></span><br><span class="line">[root@MR ~]<span class="comment"># wc -c 1</span></span><br><span class="line">9 1</span><br><span class="line"><span class="comment">#1这个文本只有9个字节</span></span><br></pre></td></tr></table></figure>

<h3 id="stat-查看文件的时间"><a href="#stat-查看文件的时间" class="headerlink" title="stat   查看文件的时间"></a>stat   查看文件的时间</h3><blockquote>
<p>用于查看文件的具体储存信息和时间等信息</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># stat 1</span></span><br><span class="line">  文件：<span class="string">"1"</span></span><br><span class="line">  大小：9               块：8          IO 块：4096   普通文件</span><br><span class="line">设备：fd00h/64768d      Inode：68107948    硬链接：1</span><br><span class="line">权限：(0644/-rw-r--r--)  Uid：(    0/    root)   Gid：(    0/    root)</span><br><span class="line">环境：unconfined_u:object_r:admin_home_t:s0</span><br><span class="line">最近访问：2019-03-16 18:12:24.024958722 +0800</span><br><span class="line">最近更改：2019-03-16 18:12:24.024958722 +0800</span><br><span class="line">最近改动：2019-03-16 18:12:24.025958722 +0800</span><br><span class="line">创建时间：-</span><br></pre></td></tr></table></figure>

<h3 id="cut-按列来提取文本字符"><a href="#cut-按列来提取文本字符" class="headerlink" title="cut   按列来提取文本字符"></a>cut   按列来提取文本字符</h3><blockquote>
<p>以一列两列来提取文本里面的信息</p>
<p>-d 后接某一字节符号来设置间隔</p>
<p>-f 后接数字来提取多少列</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># cut -d: -f1 /etc/passwd</span></span><br><span class="line">root</span><br><span class="line">bin</span><br><span class="line">daemon</span><br><span class="line">adm</span><br><span class="line">lp</span><br><span class="line">sync</span><br><span class="line">shutdown</span><br><span class="line">......................以下省略........................</span><br></pre></td></tr></table></figure>

<h3 id="diff-用于对比文本文件的差异"><a href="#diff-用于对比文本文件的差异" class="headerlink" title="diff  用于对比文本文件的差异"></a>diff  用于对比文本文件的差异</h3><blockquote>
<p>用于对比文件的差异</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@MR 12]<span class="comment"># ls</span></span><br><span class="line">a  A</span><br><span class="line">[root@MR 12]<span class="comment"># cat a</span></span><br><span class="line">a b c d</span><br><span class="line">[root@MR 12]<span class="comment"># cat A</span></span><br><span class="line">A B C D</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@MR 12]<span class="comment"># diff --brief a A</span></span><br><span class="line">文件 a 和 A 不同</span><br><span class="line"></span><br><span class="line">[root@MR 12]<span class="comment"># diff -c a A</span></span><br><span class="line">*** a   2019-03-16 18:24:24.139918637 +0800</span><br><span class="line">--- A   2019-03-16 18:24:38.922917814 +0800</span><br><span class="line">***************</span><br><span class="line">*** 1 ****</span><br><span class="line">! a b c d</span><br><span class="line">--- 1 ----</span><br><span class="line">! A B C D</span><br></pre></td></tr></table></figure>

<h3 id="touch-创建文本文件"><a href="#touch-创建文本文件" class="headerlink" title="touch   创建文本文件"></a>touch   创建文本文件</h3><blockquote>
<p>用于创建文本文件，并且可以结合date创建以时间开头的文本文件</p>
</blockquote>
<blockquote>
<p>-a 只修改读取时间</p>
<p>-m 只修改修改时间</p>
<p>-d 同时修改读取时间又修改修改时间</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@MR 12]<span class="comment"># touch 5</span></span><br><span class="line">[root@MR 12]<span class="comment"># ls -l 5</span></span><br><span class="line">-rw-r--r--. 1 root root 0 3月  16 18:29 5</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@MR 12]<span class="comment"># echo “132ewfwefwef” &gt;&gt; 5</span></span><br><span class="line">[root@MR 12]<span class="comment"># cat 5</span></span><br><span class="line">“132ewfwefwef”</span><br><span class="line">[root@MR 12]<span class="comment"># ls -l 5</span></span><br><span class="line">-rw-r--r--. 1 root root 19 3月  16 18:32 5</span><br><span class="line">[root@MR 12]<span class="comment"># touch -d "18:29" 5</span></span><br><span class="line">[root@MR 12]<span class="comment"># ls -l</span></span><br><span class="line">总用量 4</span><br><span class="line">-rw-r--r--. 1 root root 19 3月  16 18:29 5</span><br></pre></td></tr></table></figure>

<h3 id="mkdir-创建文件夹"><a href="#mkdir-创建文件夹" class="headerlink" title="mkdir   创建文件夹"></a>mkdir   创建文件夹</h3><blockquote>
<p>用于创建空白的目录</p>
<p>-p 一次性创建多个目录</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@MR 12]<span class="comment"># mkdir 10</span></span><br><span class="line">[root@MR 12]<span class="comment"># ls</span></span><br><span class="line">10  5</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@MR 10]<span class="comment"># mkdir -p a/&#123;b,c/&#123;d,e&#125;&#125;</span></span><br><span class="line">[root@MR 10]<span class="comment"># tree</span></span><br><span class="line">.</span><br><span class="line">└── a</span><br><span class="line">    ├── b</span><br><span class="line">    └── c</span><br><span class="line">        ├── d</span><br><span class="line">        └── e</span><br><span class="line"></span><br><span class="line">5 directories, 0 files</span><br></pre></td></tr></table></figure>

<h3 id="cp-复制"><a href="#cp-复制" class="headerlink" title="cp   复制"></a>cp   复制</h3><blockquote>
<p>复制命令   可以复制文件，也可以复制目录</p>
</blockquote>
<blockquote>
<p>-p 保留原始文件的属性</p>
<p>-d 若对象为“链接文件”，则保留该“链接文件”的属性 </p>
<p>-r 递归持续复制（用于目录）</p>
<p>-i 若目标文件存在则询问是否覆盖</p>
<p>-a 相当于-pdr（p、d、r为上述参数）</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@MR 10]<span class="comment"># cp 1 2</span></span><br><span class="line">[root@MR 10]<span class="comment"># ls</span></span><br><span class="line">1  2  a</span><br></pre></td></tr></table></figure>

<h3 id="mv-剪切（移动）"><a href="#mv-剪切（移动）" class="headerlink" title="mv   剪切（移动）"></a>mv   剪切（移动）</h3><blockquote>
<p>剪切文件或者移动文件或者将文件重命名</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@MR 10]<span class="comment"># mv 1 3</span></span><br><span class="line">[root@MR 10]<span class="comment"># ls</span></span><br><span class="line">2  3  a</span><br></pre></td></tr></table></figure>

<h3 id="rm-删除"><a href="#rm-删除" class="headerlink" title="rm   删除"></a>rm   删除</h3><blockquote>
<p>用于删除文件的命令，这个命令就不用我过多介绍吧</p>
<p>-r 删除目录</p>
<p>-f 强制删除</p>
</blockquote>
<h3 id="dd-类似于提取"><a href="#dd-类似于提取" class="headerlink" title="dd  类似于提取"></a>dd  类似于提取</h3><blockquote>
<p>按照指定大小和个数的数据块来复制文件或转换文件</p>
<p>if 输入的文件名称</p>
<p>of 输出的文件名称</p>
<p>bs 设置每个‘块’大小</p>
<p>count 设置要复制‘块’的个数</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># dd if=/dev/sda of=111_file count=1 bs=125M</span></span><br><span class="line">记录了1+0 的读入</span><br><span class="line">记录了1+0 的写出</span><br><span class="line">131072000字节(131 MB)已复制，3.35874 秒，39.0 MB/秒</span><br></pre></td></tr></table></figure>

<h3 id="file-查看文件类型"><a href="#file-查看文件类型" class="headerlink" title="file   查看文件类型"></a>file   查看文件类型</h3><blockquote>
<p>用于查看文件的类型 </p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># file /home</span></span><br><span class="line">/home: directory</span><br><span class="line">[root@MR ~]<span class="comment"># file 1</span></span><br><span class="line">1: ASCII text</span><br></pre></td></tr></table></figure>

<h3 id="tar-压缩（解压）"><a href="#tar-压缩（解压）" class="headerlink" title="tar   压缩（解压）"></a>tar   压缩（解压）</h3><blockquote>
<p>-c   创建压缩文件 </p>
<p>-x   解开压缩文件  </p>
<p>-z   用Gzip压缩或解压 </p>
<p>-v  显示压缩或解压的过程 </p>
<p>-f   目标文件名</p>
<p>-C  指定解压到的目录</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">压缩：</span><br><span class="line">[root@MR 12]<span class="comment"># tar -czvf 10.tar.gz 10</span></span><br><span class="line">10/</span><br><span class="line">10/a/</span><br><span class="line">10/a/b/</span><br><span class="line">10/a/c/</span><br><span class="line">10/a/c/d/</span><br><span class="line">10/a/c/e/</span><br><span class="line">10/2</span><br><span class="line">10/3</span><br><span class="line">[root@MR 12]<span class="comment"># ls</span></span><br><span class="line">10  10.tar.gz  5</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">解压至/home目录：</span><br><span class="line">[root@MR 12]<span class="comment"># tar xzvf 10.tar.gz -C /home</span></span><br><span class="line">10/</span><br><span class="line">10/a/</span><br><span class="line">10/a/b/</span><br><span class="line">10/a/c/</span><br><span class="line">10/a/c/d/</span><br><span class="line">10/a/c/e/</span><br><span class="line">10/2</span><br><span class="line">10/3</span><br><span class="line">[root@MR 12]<span class="comment"># ls /home</span></span><br><span class="line">10  zhou</span><br></pre></td></tr></table></figure>

<h3 id="grep-在文本文件中执行关键词搜索"><a href="#grep-在文本文件中执行关键词搜索" class="headerlink" title="grep   在文本文件中执行关键词搜索"></a>grep   在文本文件中执行关键词搜索</h3><blockquote>
<p>-d  将可执行文件（binary）当作文本文件（text）来搜索</p>
<p>-c   仅显示找到的行数</p>
<p>-i    忽略大小写 </p>
<p>-n   显示行号</p>
<p>-v   反向选择—仅列出没有“关键词”的行 </p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@MR 12]<span class="comment"># grep /sbin/nologin /etc/passwd</span></span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">......................以下省略........................</span><br></pre></td></tr></table></figure>

<h3 id="find-按照指定的条件来查找文件"><a href="#find-按照指定的条件来查找文件" class="headerlink" title="find   按照指定的条件来查找文件"></a>find   按照指定的条件来查找文件</h3><table>
<thead>
<tr>
<th>-name</th>
<th>匹配名称</th>
</tr>
</thead>
<tbody><tr>
<td>-perm</td>
<td>匹配权限（mode为完全匹配，-mode为包含即可）</td>
</tr>
<tr>
<td>-user</td>
<td>匹配所有者</td>
</tr>
<tr>
<td>-group</td>
<td>匹配所有组</td>
</tr>
<tr>
<td>-mtime -n +n</td>
<td>匹配修改内容的时间（-n指n天以内，+n指n天以前）</td>
</tr>
<tr>
<td>-atime -n +n</td>
<td>匹配访问文件的时间（-n指n天以内，+n指n天以前）</td>
</tr>
<tr>
<td>-ctime -n +n</td>
<td>匹配修改文件权限的时间（-n指n天以内，+n指n天以前）</td>
</tr>
<tr>
<td>-nouser</td>
<td>匹配无所有者的文件</td>
</tr>
<tr>
<td>-nogroup</td>
<td>匹配无所有组的文件</td>
</tr>
<tr>
<td>-newer f1 !f2 ent–&gt;</td>
<td>匹配比文件f1新但比f2旧的文件</td>
</tr>
<tr>
<td>–type b/d/c/p/l/f</td>
<td>匹配文件类型（后面的字母参数依次表示块设备、目录、字符设备、管道、链接文件、文本文件）</td>
</tr>
<tr>
<td>-size</td>
<td>匹配文件的大小（+50KB为查找超过50KB的文件，而-50KB为查找小于50KB的文件）</td>
</tr>
<tr>
<td>-prune</td>
<td>忽略某个目录</td>
</tr>
<tr>
<td>-exec …… {};</td>
<td>后面可跟用于进一步处理搜索结果的命令（下文会有演示）</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@MR 12]<span class="comment"># find /etc -name "host*" -print</span></span><br><span class="line">/etc/host.conf</span><br><span class="line">/etc/hosts</span><br><span class="line">/etc/hosts.allow</span><br><span class="line">/etc/hosts.deny</span><br><span class="line">/etc/avahi/hosts</span><br><span class="line">/etc/selinux/targeted/modules/active/modules/hostname.pp</span><br><span class="line">/etc/hostname</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@MR 12]<span class="comment"># find / -perm -4000 -print</span></span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/chage</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/su</span><br><span class="line">......................以下省略........................</span><br></pre></td></tr></table></figure>


      
      <!-- 打赏 -->
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chineselijie/2020/03/12/2.linux--linux命令/" data-id="ck7ooyajv002v4su6kabnh0hs"
        class="article-share-link">分享</a>
        
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux基础/">linux基础</a></li></ul>

    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-1.linux--RHEL 7.4 实验环境搭建" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/03/12/1.linux--RHEL 7.4 实验环境搭建/"
    >RHEL 7.4 实验环境搭建</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/03/12/1.linux--RHEL 7.4 实验环境搭建/" class="article-date">
  <time datetime="2020-03-12T11:30:53.323Z" itemprop="datePublished">2020-03-12</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux基础/">linux基础</a>
  </div>

      
      
      
    </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <blockquote>
<p><strong>关于作者</strong></p>
<p><strong>周李杰</strong>，最后一批90后，现居<strong>湖北武汉</strong></p>
<p>孤独患者，懒癌中期，无脑幻想者。但却人畜无害，无需远离。</p>
<p>兴趣众多，然无一精通。正努力成为一个有趣的人。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; print(&quot;👆以上是不完整的我&quot;) //请我吃大餐将会了解更多</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="RHEL-7-4-实验环境搭建"><a href="#RHEL-7-4-实验环境搭建" class="headerlink" title="RHEL 7.4 实验环境搭建"></a>RHEL 7.4 实验环境搭建</h3><p>环境搭建请访问链接：<a href="https://pan.baidu.com/s/1w2IHw3ozCZWqm-c-TaEVMA" target="_blank" rel="noopener">https://pan.baidu.com/s/1w2IHw3ozCZWqm-c-TaEVMA</a></p>
<p>提取码：ppm4 </p>
<p>内含：</p>
<ul>
<li>rhel-server-7.4-x86_64-dvd.iso镜像文件</li>
<li>VMware14安装包</li>
<li>Xftp-6.0.0083p.exe</li>
<li>Xmanager-6.0.0092.exe</li>
<li>Xshell-6.0.0089p.exe</li>
<li>屏幕录像专家.exe</li>
<li>向日葵远程协助.exe</li>
<li>搭建环境视频指导</li>
</ul>
<h3 id="开工准备"><a href="#开工准备" class="headerlink" title="开工准备"></a>开工准备</h3><ul>
<li><p>按着视频操作完之后，就代表我们搭建好RHEL 7.4实验环境之后，输入”<strong>ip a</strong>“来查看ens33里面有没有IP地址，如果没有（此处如果有直接跳转去看下一段），这时我们输入”<strong>vi /etc/sysconfig/network-scripts/ifcfg-ens33</strong>“ 然后我们按字母”<strong>i</strong>“，将光标移动至最低行或者’ONBOOT=no’这一行，将‘no’改为‘yes’即可，然后狂按<strong>esc键</strong>，输入”<strong>：wq</strong>“，之后我们就要重启网卡了，输入”<strong>systemctl restart network</strong>“,然后网卡就被重启了，然后再次输入“<strong>ip a</strong>”来查看ens33里面的IP地址。</p>
</li>
<li><p>然后就开始搭建本地yum源了，首先我们”<strong>cd /etc/yum.repos.d/</strong>“,然后输入”<strong>ls</strong>“查看一下这个目录里面有东西，如果有，我们就输入”<strong>rm -rf *</strong>“,意思就是删除所有东西，然后我们创建目录”<strong>mkdir /mnt/cdrom</strong>“再次输入”<strong>mount /dev/cdrom /mnt/cdrom</strong>“，之后我们输入”<strong>vi bendiyum.repo</strong>“,然后我们进入了一个全新的界面，我们按”i”进入编辑模式，将：</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[bendiyum]</span><br><span class="line">name=bendiyum</span><br><span class="line">baseurl=file:///mnt/cdrom</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br></pre></td></tr></table></figure>

<p>加入进去之后，我们狂按<strong>esc键</strong>，输入”<strong>:wq</strong>“保存并退出，然后我们输入”<strong>yum clean all</strong>“清除缓存，然后我们输入”<strong>yum list | wc -l</strong>“来统计有多少行，结果非零为正确。证明本地yum 源搭建成功。</p>
<ul>
<li>快照</li>
</ul>
<p>这里的快照的含义就是将我们的系统拍一张照片，然后某一时刻系统出问题，这时拍摄过的快照就派上了用场，我们可以还原快照还原到现在这个模样，话不多说，我们来拍摄快照吧。我们在终端中输入”shutdown +0”立刻关机。然后在VMwark中点击你自己这个虚拟机，然后上面一栏中找到“虚拟机”，点击之后再点击“快照“，在点击”拍摄快照“，将快照保存下来，想还原快照就可以在快照管理器中查看拍摄过的快照。</p>

      
      <!-- 打赏 -->
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chineselijie/2020/03/12/1.linux--RHEL 7.4 实验环境搭建/" data-id="ck7ooya1j00014su6dea0ajmu"
        class="article-share-link">分享</a>
        
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux基础/">linux基础</a></li></ul>

    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-git版本控制详解手册" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/10/29/git版本控制详解手册/"
    >《Git分布式版本控制详解手册》</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2019/10/29/git版本控制详解手册/" class="article-date">
  <time datetime="2019-10-29T14:18:56.834Z" itemprop="datePublished">2019-10-29</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/Git/">Git</a>
  </div>

      
      
      
    </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <blockquote>
<p><strong>关于作者</strong></p>
<p><strong>周李杰</strong>，最后一批90后，现居<strong>湖北武汉</strong></p>
<p>孤独患者，懒癌中期，无脑幻想者。但却人畜无害，无需远离。</p>
<p>兴趣众多，然无一精通。正努力成为一个有趣的人。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; print(&quot;👆以上是不完整的我&quot;) //请我吃大餐将会了解更多</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>[TOC]</p>
<h2 id="开篇"><a href="#开篇" class="headerlink" title="开篇"></a>开篇</h2><blockquote>
<p><strong>学会使用Markdown进行编写文本文件<br>作为一名新时代的IT知识分子，熟悉Markdown语法至关重要<br>Markdown是一种轻量级标记语言，由于Markdown的轻量化、易读易写等特点<br>并且Markdown对于图片，图表、数学式都有支持<br>当前许多网站都在广泛地使用Markdown来撰写帮助文档或是用于论坛上发表消息<br>甚至Markdown都已经被用来撰写电子书<br>初学者可以使用Typora来写Markdown，进而提高自己的写作能力，熟悉语法之后，可尝试使用vim或者Visual Studio Code来进行编写</strong><br>这里附带一下Typora的下载链接，<a href="https://www.typora.io/#windows" target="_blank" rel="noopener">点击此处打开</a>,选择下载</p>
<p><strong>本篇手册就基于Markdown语法编写</strong></p>
</blockquote>
<h2 id="Git版本控制"><a href="#Git版本控制" class="headerlink" title="Git版本控制"></a>Git版本控制</h2><h3 id="1-Git版本控制的来历"><a href="#1-Git版本控制的来历" class="headerlink" title="1-Git版本控制的来历"></a>1-Git版本控制的来历</h3><p>  <strong>全称：Git分布式版本控制系统</strong><br>  在IT行业中，Linux系统无人不知无人不晓，在1991年linus创建了Linux并将它开源，早期的Linux就仅仅只是一个框架，就连我们熟知的vim也是后来开发者们不断开发出来的。</p>
<blockquote>
<p>在这里简要提示一下：vim最初是vi，vim第一个版本是由一个叫布莱姆荷兰人在1991年开发</p>
</blockquote>
<p>  由于Linux系统是开源，并吸引了世界各地的开发者为Linux提供代码服务，因此Linux系统不断的发展壮大，现绝大部分互联网公司服务器运用的都是Linux系统</p>
<p>  那么，linus是怎么管理这些代码呢，如何进行区分以及修改呢？</p>
<p>  早在2002年以前，世界各地的开发者们通过diff的方式将源代码发送给linus，然后由linus手工合并。</p>
<p>  到了2002年，Linux经过了10年的历程，其中的源代码早已经非常庞大了，代码库之大让linus很难再使用手工的方式管理了，于是呢，linus脑袋一转，选择了一个商业性的版本控制系统BitKeeper，这个控制系统的老东家BitMover公司处于人道主义，授权给Linux社区免费使用这个版本控制系统。</p>
<p>  不过好景不长，时隔三年，也就是在2005年的时候，一位叫Andrew(著名的samba服务由他开发而来)试图破解BitKeeper的协议，不料BitMover公司正是搞监控的，后来大家也应该能猜到，BitMover公司收回了Linux社区使用BitKeeper的版权。</p>
<p>  Linus完全可以出面和BitMover公司交谈一下，并管好自己社区的弟兄，但是linus没有，其实linus内心早就想写一个分布式控制系统来管理自己的代码仓库。</p>
<p>  Linus花了两周的时间，运用C语言写了一个分布式控制系统，Git由此而诞生，linus在一个月内，就将linux系统中的源码交接到Git中管理。</p>
<p>  Git迅速就成为了最流行的分布式版本控制系统，尤其是在2008年，GitHub网站(被国内称之为程序员社交网站)上线，它为开源项目免费提供Git存储，无数开源项目开始迁移至GitHub，包括jQuery，PHP，Ruby等。</p>
<h3 id="2-安装Git"><a href="#2-安装Git" class="headerlink" title="2-安装Git"></a>2-安装Git</h3><blockquote>
<p>此章节主要所讲在Linux以及windows系统上怎么安装Git分布式版本控制</p>
</blockquote>
<p>Git是在linux上进行开发的，所以理所应当的用到Linux和unix上跑，不过，慢慢的有些大牛就将Git移植到windows上跑，现在Git不仅可以在Linux、unix、windows上跑，还来可以在mac系统上运行。</p>
<p><strong>在Linux上安装Git</strong></p>
<blockquote>
<p>这里就以RHEL 7版本举例</p>
</blockquote>
<h4 id="第一步：首先检查系统是否安装Git"><a href="#第一步：首先检查系统是否安装Git" class="headerlink" title="第一步：首先检查系统是否安装Git"></a>第一步：首先检查系统是否安装Git</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># git</span></span><br><span class="line">-bash: /usr/bin/git: 没有那个文件或目录</span><br></pre></td></tr></table></figure>

<blockquote>
<p>若您有信息，则跳过第二步骤，这个信息类似一个帮助文档</p>
</blockquote>
<h4 id="第二步：安装Git"><a href="#第二步：安装Git" class="headerlink" title="第二步：安装Git"></a>第二步：安装Git</h4><blockquote>
<p>首先清空本地所有yum源，并使用网易yum源</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># cd /etc/yum.repos.d/</span></span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># rm -rf *</span></span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># ls</span></span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># wget https://mirrors.163.com/.help/CentOS7-Base-163.repo</span></span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># ls</span></span><br><span class="line">CentOS7-Base-163.repo</span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># yum clean all</span></span><br><span class="line">[root@client111 yum.repos.d]<span class="comment"># yum makecache</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>查询是否有Git软件包</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 yum.repos.d]<span class="comment"># cd</span></span><br><span class="line">[root@client111 ~]<span class="comment"># yum info yum</span></span><br><span class="line">已加载插件：fastestmirror, langpacks</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line">已安装的软件包</span><br><span class="line">名称    ：yum</span><br><span class="line">架构    ：noarch</span><br><span class="line">版本    ：3.4.3</span><br><span class="line">···········</span><br></pre></td></tr></table></figure>

<blockquote>
<p>安装Git</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># yum install git -y</span></span><br><span class="line">············</span><br><span class="line">已安装:</span><br><span class="line">  git.x86_64 0:1.8.3.1-20.el7</span><br><span class="line">作为依赖被安装:</span><br><span class="line">  perl-Git.noarch 0:1.8.3.1-20.el7</span><br><span class="line">完毕！</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看是否安装成功</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># git</span></span><br><span class="line">··········</span><br><span class="line">最常用的 git 命令有：</span><br><span class="line">   add        添加文件内容至索引</span><br><span class="line">   bisect     通过二分查找定位引入 bug 的变更</span><br><span class="line">   branch     列出、创建或删除分支</span><br><span class="line">   checkout   检出一个分支或路径到工作区</span><br><span class="line">   <span class="built_in">clone</span>      克隆一个版本库到一个新目录</span><br><span class="line">   commit     记录变更到版本库</span><br><span class="line">   diff       显示提交之间、提交和工作区之间等的差异</span><br><span class="line">   fetch      从另外一个版本库下载对象和引用</span><br><span class="line">   grep       输出和模式匹配的行</span><br><span class="line">   init       创建一个空的 Git 版本库或重新初始化一个已存在的版本库</span><br><span class="line">   <span class="built_in">log</span>        显示提交日志</span><br><span class="line">   merge      合并两个或更多开发历史</span><br><span class="line">   mv         移动或重命名一个文件、目录或符号链接</span><br><span class="line">   pull       获取并合并另外的版本库或一个本地分支</span><br><span class="line">   push       更新远程引用和相关的对象</span><br><span class="line">   rebase     本地提交转移至更新后的上游分支中</span><br><span class="line">   reset      重置当前HEAD到指定状态</span><br><span class="line">   rm         从工作区和索引中删除文件</span><br><span class="line">   show       显示各种类型的对象</span><br><span class="line">   status     显示工作区状态</span><br><span class="line">   tag        创建、列出、删除或校验一个GPG签名的 tag 对象</span><br><span class="line"></span><br><span class="line">命令 <span class="string">'git help -a'</span> 和 <span class="string">'git help -g'</span> 显示可用的子命令和一些指南。参见</span><br><span class="line"><span class="string">'git help &lt;命令&gt;'</span> 或 <span class="string">'git help &lt;指南&gt;'</span> 来查看给定的子命令帮助或指南。</span><br></pre></td></tr></table></figure>

<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ul>
<li>如果您的系统是ubuntu或者Debian系统的话，请使用<code>sudo get install git -y</code>命令进行安装</li>
<li>如果还是不行，请使用<code>sudo apt-get install git -y</code>命令进行安装</li>
<li>最后还是不行，请移步至官网下载源码，用tar解压，然后编译安装，编译安装步骤：<code>./config</code>、<code>make</code>、<code>sudo make install</code>。<blockquote>
<p>如果你所装的系统比较先进，基本二三条是不用看的</p>
</blockquote>
</li>
</ul>
<p><strong>在windows上安装Git</strong></p>
<h4 id="第一步：移步官网下载最新版本"><a href="#第一步：移步官网下载最新版本" class="headerlink" title="第一步：移步官网下载最新版本"></a>第一步：移步官网下载最新版本</h4><p><a href="https://git-scm.com/downloads" target="_blank" rel="noopener">点击此处访问Git官网下载界面</a><br>现在最新版本是2.23.0，于2019年8月16日发布</p>
<p>下载成功后请使用傻瓜式安装方法，安装地址自行输入，建议在C盘.</p>
<h4 id="使用Git"><a href="#使用Git" class="headerlink" title="使用Git"></a>使用Git</h4><p>安装完成之后，在桌面单机鼠标右键会多出两个选项<code>Git GUI Here</code>、<code>Git Bash Here</code>.</p>
<p>选择<code>Git Bash Here</code>点击，此时会蹦出一个界面</p>
<p>输入<code>git</code>，如果报出以下帮助文档便是安装正确</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git</span><br><span class="line">usage: git [--version] [--<span class="built_in">help</span>] [-C &lt;path&gt;] [-c &lt;name&gt;=&lt;value&gt;]</span><br><span class="line">           [--<span class="built_in">exec</span>-path[=&lt;path&gt;]] [--html-path] [--man-path] [--info-path]</span><br><span class="line">           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]</span><br><span class="line">           [--git-dir=&lt;path&gt;] [--work-tree=&lt;path&gt;] [--namespace=&lt;name&gt;]</span><br><span class="line">           &lt;<span class="built_in">command</span>&gt; [&lt;args&gt;]</span><br><span class="line">···············</span><br><span class="line"><span class="string">'git help -a'</span> and <span class="string">'git help -g'</span> list available subcommands and some</span><br><span class="line">concept guides. See <span class="string">'git help &lt;command&gt;'</span> or <span class="string">'git help &lt;concept&gt;'</span></span><br><span class="line">to <span class="built_in">read</span> about a specific subcommand or concept.</span><br></pre></td></tr></table></figure>

<blockquote>
<p>以上就是介绍怎么安装Git，此详解手册仅仅介绍linu以及windows，其他系统安装方法也大致相同，具体可进Git官方网站阅读</p>
</blockquote>
<h3 id="3-创建账户"><a href="#3-创建账户" class="headerlink" title="3-创建账户"></a>3-创建账户</h3><h4 id="绑定用户名"><a href="#绑定用户名" class="headerlink" title="绑定用户名"></a>绑定用户名</h4><p>绑定用户在上传文件的时候就知道是谁上传的，起到一个表示作用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># git config --global user.name "Jack"</span></span><br><span class="line">[root@client111 ~]<span class="comment"># git config --global user.email "18371207979@139.com"</span></span><br><span class="line">[root@client111 ~]<span class="comment"># git config user.name</span></span><br><span class="line">Jack</span><br><span class="line">[root@client111 ~]<span class="comment"># git config user.email</span></span><br><span class="line">18371207979@139.com</span><br></pre></td></tr></table></figure>

<h4 id="创建一个目录"><a href="#创建一个目录" class="headerlink" title="创建一个目录"></a>创建一个目录</h4><blockquote>
<p>创建好一个目录，这个目录将作为一个版本仓库<br>[root@client111 ~]# cd<br>[root@client111 ~]# mkdir git-test<br>[root@client111 ~]# cd git-test/</p>
</blockquote>
<blockquote>
<p>使用Git管理此仓库<br>[root@client111 git-test]# git init<br>初始化空的 Git 版本库于 /root/git-test/.git/</p>
</blockquote>
<h3 id="4-连接进Github网站"><a href="#4-连接进Github网站" class="headerlink" title="4-连接进Github网站"></a>4-连接进Github网站</h3><h4 id="创建Github账号"><a href="#创建Github账号" class="headerlink" title="创建Github账号"></a>创建Github账号</h4><p><a href="https://github.com/">点击进入Github官方网站</a></p>
<p>Github网站挺有名，全球最大的源代码托管服务平台，2018年6月4日，微软宣布以75亿美元的股票收购GitHub。在21世纪互联网时代，我们IT人员应该理所应当地知道这个网站。</p>
<p>进入网站之后点击右上角注册账户,<a href="https://github.com/join?source=header-home">也可以直接点击此处开始注册</a>，注册之中，遵循能跳过则跳过，不能跳过则认真填的原则。</p>
<p>进入邮箱验证界面之后，无论界面怎么样，请点击左上角一个狸猫的图片，然后点击<strong>start a project</strong>，进入创建一个新的仓库界面。或者<a href="https://github.com/new">验证完成之后直接点击此处看能否跳转创建新的仓库界面</a></p>
<p><strong>Repository name</strong> 这是存储库的名称，随便命名就行，这里我命名为chinesejack<br><strong>Description</strong> 存储库的说明，可选输入，可输入，也可不输入<br><strong>Public</strong> 请选择此选项，任何人都可以看到此存储库。您选择谁可以提交<br><strong>Initialize this repository with a README</strong><br>使用自述文件初始化此存储库，勾选则生成README.md一个解释文件，也可以不用勾选，根据自生所需，建议勾选</p>
<p>最后直接鼠标单击<strong>create repository</strong>创建仓库</p>
<h4 id="ssh密钥链接进Github网站"><a href="#ssh密钥链接进Github网站" class="headerlink" title="ssh密钥链接进Github网站"></a>ssh密钥链接进Github网站</h4><blockquote>
<p>生成本机密钥</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认直接回车即可</span></span><br><span class="line">[root@client111 git-test]<span class="comment"># ssh-keygen</span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file <span class="keyword">in</span> <span class="built_in">which</span> to save the key (/root/.ssh/id_rsa):</span><br><span class="line">Created directory <span class="string">'/root/.ssh'</span>.</span><br><span class="line">Enter passphrase (empty <span class="keyword">for</span> no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved <span class="keyword">in</span> /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:bFQH+qf7m9/ruwsE2P5Ho3x0wzHbMN8YY+J24DXTo+M root@client111</span><br><span class="line">The key<span class="string">'s randomart image is:</span></span><br><span class="line"><span class="string">+---[RSA 2048]----+</span></span><br><span class="line"><span class="string">|          o..    |</span></span><br><span class="line"><span class="string">|         oo.   . |</span></span><br><span class="line"><span class="string">|        o. oo X+.|</span></span><br><span class="line"><span class="string">|       o ..o.=oXB|</span></span><br><span class="line"><span class="string">|        S ..=+oB=|</span></span><br><span class="line"><span class="string">|       .   +=.= +|</span></span><br><span class="line"><span class="string">|          .  E o |</span></span><br><span class="line"><span class="string">|           . .+. |</span></span><br><span class="line"><span class="string">|          ..+oo**|</span></span><br><span class="line"><span class="string">+----[SHA256]-----+</span></span><br><span class="line"><span class="string">[root@client111 git-test]# cd ~/.ssh/</span></span><br><span class="line"><span class="string">[root@client111 .ssh]# ls</span></span><br><span class="line"><span class="string">id_rsa  id_rsa.pub</span></span><br><span class="line"><span class="string">[root@client111 .ssh]# cat id_rsa.pub</span></span><br><span class="line"><span class="string">····································</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>将生成出来的密钥复制<br>进入Github网站，登陆自己刚注册的账号，右上角自己的头像旁边的扩展箭头点一下</p>
</blockquote>
<p>然后再点击<strong>Settings</strong>选项，然后再单击<strong>SSH and GPG keys</strong>选项</p>
<p>选择第一个<strong>New SSH key</strong>新建SSH keys密钥</p>
<p><strong>Title</strong>随意填写，这里我填写root@client111</p>
<p><strong>Key</strong>密钥将刚复制的密钥粘贴进去</p>
<blockquote>
<p> <strong>此时此刻便连接进你的GitHub仓库</strong></p>
</blockquote>
<h3 id="5-Git常用参数"><a href="#5-Git常用参数" class="headerlink" title="5- Git常用参数"></a>5- Git常用参数</h3><h4 id="clone-克隆"><a href="#clone-克隆" class="headerlink" title="clone-克隆"></a>clone-克隆</h4><p><strong>clone</strong><br>标准意为：克隆一个仓库到一个新目录<br>可以理解为：将远端的仓库克隆到本地<br>命令：git clone [链接]<br>举例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 git-test]<span class="comment"># git clone https://github.com/chineseJack/chinesejack</span></span><br><span class="line">正克隆到 <span class="string">'chinesejack'</span>...</span><br><span class="line">remote: Enumerating objects: 3, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0</span><br><span class="line">Unpacking objects: 100% (3/3), <span class="keyword">done</span>.</span><br><span class="line">[root@client111 git-test]<span class="comment"># ls</span></span><br><span class="line">chinesejack</span><br></pre></td></tr></table></figure>

<h4 id="add-添加"><a href="#add-添加" class="headerlink" title="add-添加"></a>add-添加</h4><p><strong>add</strong><br>标准意为：添加文件内容至索引<br>可以理解为：提交到暂缓区<br>命令：git add [文件]<br>举例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 单个文件提交到暂存</span></span><br><span class="line">[root@client111 git-test]<span class="comment"># cd chinesejack/</span></span><br><span class="line">[root@client111 chinesejack]<span class="comment"># touch 123.txt</span></span><br><span class="line">[root@client111 chinesejack]<span class="comment"># git add 123.txt</span></span><br><span class="line"><span class="comment"># 多个文件提交到暂存区</span></span><br><span class="line">[root@client111 chinesejack]<span class="comment"># touch abc.txt 456.txt def.txt</span></span><br><span class="line">[root@client111 chinesejack]<span class="comment"># ls</span></span><br><span class="line">123.txt  456.txt  abc.txt  def.txt  README.md</span><br><span class="line">[root@client111 chinesejack]<span class="comment"># git add --all .</span></span><br><span class="line"><span class="comment"># .是代表当前目录</span></span><br></pre></td></tr></table></figure>

<h4 id="commit-提交"><a href="#commit-提交" class="headerlink" title="commit-提交"></a>commit-提交</h4><p><strong>commit</strong><br>标准意为：记录变更到仓库<br>可以理解为：将暂存区所有内容提交到当前分支<br>命令：git commit -m “填写所要描述的内容”<br>举例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 chinesejack]<span class="comment"># git commit -m "创建了4个txt文件"</span></span><br><span class="line">[master 38911e7] 创建了4个txt文件</span><br><span class="line"> 4 files changed, 0 insertions(+), 0 deletions(-)</span><br><span class="line"> create mode 100644 123.txt</span><br><span class="line"> create mode 100644 456.txt</span><br><span class="line"> create mode 100644 abc.txt</span><br><span class="line"> create mode 100644 def.txt</span><br></pre></td></tr></table></figure>

<h4 id="push-推"><a href="#push-推" class="headerlink" title="push-推"></a>push-推</h4><p><strong>push</strong><br>标准意为：更新远程引用和相关的对象<br>可以理解为：推，更新本地到远程仓库<br>命令：git push</p>
<blockquote>
<p>第一次推上去需要后面跟上项目链接，以后就可以不用输入链接<br>举例：</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 chinesejack]<span class="comment"># git push https://github.com/chineseJack/chinesejack</span></span><br><span class="line">warning: push.default 未设置，它的默认值将会在 Git 2.0 由 <span class="string">'matching'</span></span><br><span class="line">修改为 <span class="string">'simple'</span>。若要不再显示本信息并在其默认值改变后维持当前使用习惯，</span><br><span class="line">进行如下设置：</span><br><span class="line"></span><br><span class="line">  git config --global push.default matching</span><br><span class="line"></span><br><span class="line">若要不再显示本信息并从现在开始采用新的使用习惯，设置：</span><br><span class="line"></span><br><span class="line">  git config --global push.default simple</span><br><span class="line"></span><br><span class="line">参见 <span class="string">'git help config'</span> 并查找 <span class="string">'push.default'</span> 以获取更多信息。</span><br><span class="line">（<span class="string">'simple'</span> 模式由 Git 1.7.11 版本引入。如果您有时要使用老版本的 Git，</span><br><span class="line">为保持兼容，请用 <span class="string">'current'</span> 代替 <span class="string">'simple'</span> 模式）</span><br><span class="line"></span><br><span class="line">Username <span class="keyword">for</span> <span class="string">'https://github.com'</span>: chineseJack <span class="comment"># 此处需要当时注册账户时候的账户名</span></span><br><span class="line">Password <span class="keyword">for</span> <span class="string">'https://chineseJack@github.com'</span>:  <span class="comment"># 此处需要填写当时注册账户时候的密码</span></span><br><span class="line">Counting objects: 4, <span class="keyword">done</span>.</span><br><span class="line">Compressing objects: 100% (2/2), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (3/3), 312 bytes | 0 bytes/s, <span class="keyword">done</span>.</span><br><span class="line">Total 3 (delta 0), reused 0 (delta 0)</span><br><span class="line">To https://github.com/chineseJack/chinesejack</span><br><span class="line">   50fe4cf..38911e7  master -&gt; master</span><br></pre></td></tr></table></figure>

<h4 id="pull-拉"><a href="#pull-拉" class="headerlink" title="pull-拉"></a>pull-拉</h4><p><strong>pull</strong><br>标准意为：获取并整合另外的仓库或一个本地分支<br>可以理解为：拉，拉取远程仓库到本地<br>命令：git pull<br>举例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 手法如同push</span></span><br><span class="line">git pull https://github.com/chineseJack/chinesejack</span><br></pre></td></tr></table></figure>

<h4 id="show-查看内容"><a href="#show-查看内容" class="headerlink" title="show-查看内容"></a>show-查看内容</h4><p><strong>show</strong><br>标准意为：显示各种类型的对象<br>可以理解为：检查你所提交的版本的减少以及增加的内容<br>命令：git show<br>举例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 chinesejack]<span class="comment"># git show</span></span><br><span class="line">commit 38911e7c2226a033779fdcf7b2eef9c19cb477bf</span><br><span class="line">Author: Jack &lt;18371207979@139.com&gt;</span><br><span class="line">Date:   Tue Oct 29 20:58:34 2019 +0800</span><br><span class="line"></span><br><span class="line">    创建了4个txt文件</span><br><span class="line"></span><br><span class="line">diff --git a/123.txt b/123.txt</span><br><span class="line">new file mode 100644</span><br><span class="line">index 0000000..e69de29</span><br><span class="line">diff --git a/456.txt b/456.txt</span><br><span class="line">new file mode 100644</span><br><span class="line">index 0000000..e69de29</span><br><span class="line">diff --git a/abc.txt b/abc.txt</span><br><span class="line">new file mode 100644</span><br><span class="line">index 0000000..e69de29</span><br><span class="line">diff --git a/def.txt b/def.txt</span><br><span class="line">new file mode 100644</span><br><span class="line">index 0000000..e69de29</span><br></pre></td></tr></table></figure>

<blockquote>
<p>因为我四个文件里什么都没有，所以未显示内容</p>
</blockquote>
<h4 id="status-状态"><a href="#status-状态" class="headerlink" title="status-状态"></a>status-状态</h4><p><strong>status</strong><br>标准意为：显示工作区状态<br>可以理解为：显示状态，提醒你有没有没提交的<br>命令：git status<br>举例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 chinesejack]<span class="comment"># git status</span></span><br><span class="line"><span class="comment"># 位于分支 master</span></span><br><span class="line">无文件要提交，干净的工作区</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里改动一个文件，然后再看下状态</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 chinesejack]<span class="comment"># echo 123456789 &gt; 123.txt</span></span><br><span class="line">[root@client111 chinesejack]<span class="comment"># git status</span></span><br><span class="line"><span class="comment"># 位于分支 master</span></span><br><span class="line"><span class="comment"># 尚未暂存以备提交的变更：</span></span><br><span class="line"><span class="comment">#   （使用 "git add &lt;file&gt;..." 更新要提交的内容）</span></span><br><span class="line"><span class="comment">#   （使用 "git checkout -- &lt;file&gt;..." 丢弃工作区的改动）</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#       修改：      123.txt</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">修改尚未加入提交（使用 <span class="string">"git add"</span> 和/或 <span class="string">"git commit -a"</span>）</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果<code>git status</code>告诉你有文件被修改过，用<code>git diff</code>可以查看修改内容</p>
</blockquote>
<h4 id="diff-对比"><a href="#diff-对比" class="headerlink" title="diff-对比"></a>diff-对比</h4><p><strong>diff</strong><br>标准意为：显示提交之间、提交和工作区之间等的差异<br>可以理解为：你写的对比提交了的有哪些变化<br>命令：git diff</p>
<blockquote>
<p>后面还可以接版本号，与各个版本之间对比<br>举例：</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 chinesejack]<span class="comment"># git diff</span></span><br><span class="line">diff --git a/123.txt b/123.txt</span><br><span class="line">index e69de29..28d1445 100644</span><br><span class="line">--- a/123.txt</span><br><span class="line">+++ b/123.txt</span><br><span class="line">@@ -0,0 +1 @@</span><br><span class="line">+123456789</span><br></pre></td></tr></table></figure>

<h4 id="log-日志"><a href="#log-日志" class="headerlink" title="log-日志"></a>log-日志</h4><p><strong>log</strong><br>标准意为：显示提交日志<br>可以理解为：查看提交历史<br>命令：git log<br>举例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 chinesejack]<span class="comment"># git log</span></span><br><span class="line">commit fd6c7f54c502a2a575e4450429892ec4d1dc3e48</span><br><span class="line">Author: Jack &lt;18371207979@139.com&gt;</span><br><span class="line">Date:   Tue Oct 29 21:12:21 2019 +0800</span><br><span class="line"></span><br><span class="line">    不小心将全部文件删除</span><br><span class="line"></span><br><span class="line">commit 38911e7c2226a033779fdcf7b2eef9c19cb477bf</span><br><span class="line">Author: Jack &lt;18371207979@139.com&gt;</span><br><span class="line">Date:   Tue Oct 29 20:58:34 2019 +0800</span><br><span class="line"></span><br><span class="line">    创建了4个txt文件</span><br><span class="line"></span><br><span class="line">commit 50fe4cf75396b3e25d9ca51aa21c8a751f52ea6d</span><br><span class="line">Author: chineseJack &lt;57097857+chineseJack@users.noreply.github.com&gt;</span><br><span class="line">Date:   Mon Oct 28 20:51:58 2019 +0800</span><br><span class="line"></span><br><span class="line">    Initial commit</span><br><span class="line"></span><br><span class="line"><span class="comment"># commit：意为版本</span></span><br></pre></td></tr></table></figure>

<h4 id="reset-–hard-版本退回"><a href="#reset-–hard-版本退回" class="headerlink" title="reset –hard-版本退回"></a>reset –hard-版本退回</h4><p><strong>reset –hard</strong><br>标准意为：倒版本号<br>可以理解为：后面接版本编号，直接回到那个版本<br>命令：git reset –hard [版本号]<br>举例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 chinesejack]<span class="comment"># git reset --hard 38911e7</span></span><br><span class="line">HEAD 现在位于 38911e7 创建了4个txt文件</span><br><span class="line">[root@client111 chinesejack]<span class="comment"># ls</span></span><br><span class="line">123.txt  456.txt  abc.txt  def.txt  README.md</span><br></pre></td></tr></table></figure>

<h4 id="reflog-历史提交版本"><a href="#reflog-历史提交版本" class="headerlink" title="reflog-历史提交版本"></a>reflog-历史提交版本</h4><p><strong>reflog</strong><br>标准意为：查看命令历史<br>可以理解为：查看提交历史<br>命令：git reflog<br>举例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 chinesejack]<span class="comment"># git reflog</span></span><br><span class="line">38911e7 HEAD@&#123;0&#125;: reset: moving to 38911e7</span><br><span class="line">fd6c7f5 HEAD@&#123;1&#125;: commit: 不小心将全部文件删除</span><br><span class="line">38911e7 HEAD@&#123;2&#125;: commit: 创建了4个txt文件</span><br><span class="line">50fe4cf HEAD@&#123;3&#125;: <span class="built_in">clone</span>: from https://github.com/chineseJack/chinesejack</span><br></pre></td></tr></table></figure>

<blockquote>
<p>然后再使用<strong>reset –hard</strong>可回到’未来’版本</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 chinesejack]<span class="comment"># git reset --hard fd6c7f5</span></span><br><span class="line">HEAD 现在位于 fd6c7f5 不小心将全部文件删除</span><br><span class="line">[root@client111 chinesejack]<span class="comment"># ls</span></span><br><span class="line">[root@client111 chinesejack]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="6-Git部分参数"><a href="#6-Git部分参数" class="headerlink" title="6- Git部分参数"></a>6- Git部分参数</h3><p><strong>git fetch</strong><br>从服务器下载数据库，并放到新分支，不跟自己的数据库合并</p>
<p><strong>git whatchanged</strong><br>查看两个分支的变化</p>
<p><strong>git branch</strong><br>创建分支，查看分支，删除分支</p>
<p><strong>git checkout</strong><br>切换分支</p>
<p><strong>git merge</strong><br>合并分支，把目标分支合并到当前分支</p>
<p><strong>git config</strong><br>配置相关信息，例如email 和name</p>
<p><strong>git tag</strong><br>标定版本号</p>
<p><strong>git mv</strong><br>重命名文件或者文件夹</p>
<p><strong>git rm</strong><br>删除文件或者文件夹</p>
<p><strong>git help</strong><br>查看帮助，还有几个无关紧要的命令，请自行查看帮助</p>
<h3 id="7-git版本控制重点知识梳理"><a href="#7-git版本控制重点知识梳理" class="headerlink" title="7-git版本控制重点知识梳理"></a>7-git版本控制重点知识梳理</h3><h4 id="本地（local）"><a href="#本地（local）" class="headerlink" title="本地（local）"></a>本地（local）</h4><h5 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">全局变量：</span><br><span class="line">	git config -global user name <span class="string">"chinesejack"</span></span><br><span class="line">	git config -global email <span class="string">"18371207979@139.com"</span></span><br><span class="line">	</span><br><span class="line">初始化新版本库：git init </span><br><span class="line"></span><br><span class="line">添加新文件到版本库：</span><br><span class="line">	添加单个文件：git add somefile.txt</span><br><span class="line">	添加所有txt文件：git add *.txt</span><br><span class="line">	添加所有文件：git add</span><br></pre></td></tr></table></figure>

<h5 id="日常操作"><a href="#日常操作" class="headerlink" title="日常操作"></a>日常操作</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">提交：</span><br><span class="line">	提交所有修改文件：git commit -m <span class="string">"some msg"</span> -a</span><br><span class="line">	提交单个文件：git commit -m <span class="string">"add msg to readme.txt"</span> readme.txt</span><br><span class="line">  提交增补：git commit -C head -a -amend  (此提交增补不会产生新的提交历史记录)</span><br><span class="line"></span><br><span class="line">撤销修改：</span><br><span class="line">  撤销尚未提交的修改：</span><br><span class="line">    撤销1、2个文件：git checkout head readme.txt todo.txt</span><br><span class="line">    撤销所有txt文件：git checkout head *.txt</span><br><span class="line">    撤销所有文件：git checkout head</span><br><span class="line">  撤销提交：</span><br><span class="line">    复位：</span><br><span class="line">      取消暂存：git reset head或者git reset head &lt;filename&gt;</span><br><span class="line">      复位到head之前那个版本：git reset --hard head^</span><br><span class="line">	</span><br><span class="line">分支：</span><br><span class="line">  列出本地分支：git branch</span><br><span class="line">  列出所有分支：git branch -a</span><br><span class="line">  基于当前分支的末梢创建新的分支：git branch &lt;branchname&gt;</span><br><span class="line">  检出分支：git checkout &lt;branchname&gt;</span><br><span class="line">  基于当前分支的末梢创建新分支并检出分支：git checkout &lt;branchname&gt;</span><br><span class="line">  基于某次提交、分支或标签创建新分支：git branch emputy2 emputy</span><br><span class="line">                                    git branch emputy bfe57de0 用来查看某个历史断面很方便</span><br><span class="line">合并分支：</span><br><span class="line">  普通合并：</span><br><span class="line">    合并提交：git merge &lt;branchname&gt;</span><br><span class="line">    合并但不提交：git merge --no-commit</span><br><span class="line">  压合合并：</span><br><span class="line">    压合合并后直接提交：git merge --squash &lt;branchname&gt;</span><br><span class="line">    压合合并但不提交：git merge --squash --no-commit &lt;branchname&gt;</span><br><span class="line">  拣选合并：挑选某次提交合并但不提交：git cherry-pick --no-commit 5b62b6</span><br><span class="line"></span><br><span class="line">重命名分支：</span><br><span class="line">  git branch -m &lt;branchname&gt; &lt;newname&gt; 不会覆盖已存在的同名分支</span><br><span class="line">  git branch -M &lt;branchname&gt; &lt;newname&gt; 会覆盖已存在的同名分支</span><br><span class="line">  </span><br><span class="line">删除分支：</span><br><span class="line">  git branch -d new2 如果分支没有被合并会删除失败</span><br><span class="line">  git branch -D new2 即使分支没有被合并也照删不误</span><br><span class="line"></span><br><span class="line">标签：</span><br><span class="line">  创建标签：</span><br><span class="line">    git tag 1.0 为当前分支最近一次提交创建标签</span><br><span class="line">    git tag contacts_1.1 contacts 为contacts分支最近一次提交创建标签</span><br><span class="line">    git tag 1.1 4e6861d5 为某次历史提交创建标签</span><br><span class="line">  显示标签列表：git tag</span><br><span class="line">  检出标签：git checkout 1.0</span><br><span class="line">  由标签创建分支：git branch b1.1 1.1/git chech=kout -b b1.0 1.0</span><br><span class="line">  删除标签：git tag -d 1.0</span><br><span class="line"></span><br><span class="line">查看状态：</span><br><span class="line">  当前状态：git status</span><br><span class="line">  历史记录：git <span class="built_in">log</span></span><br><span class="line">    当前分支历史记录：gitk</span><br><span class="line">    查看某分支历史记录：gitk &lt;branchname&gt;</span><br><span class="line">    查看所有分支：gitk branch -v</span><br><span class="line">  每个分支最后的提交：git branch -v</span><br><span class="line"></span><br><span class="line">导出版本库：</span><br><span class="line">  git archive --format=zip head&gt;nb.zip</span><br><span class="line">  git archive --format-zip --prefix=nb1.0/ head&gt;nb.zip</span><br></pre></td></tr></table></figure>

<h4 id="远程（remote）"><a href="#远程（remote）" class="headerlink" title="远程（remote）"></a>远程（remote）</h4><h5 id="初始化-1"><a href="#初始化-1" class="headerlink" title="初始化"></a>初始化</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">克隆版本：git <span class="built_in">clone</span> &lt;url&gt;</span><br><span class="line"></span><br><span class="line">别名：</span><br><span class="line">  添加远程版本库的别名：git remote add &lt;别名&gt; &lt;远程版本库的url&gt;  </span><br><span class="line">  删除远程库的别名和相关分支：git remote rm &lt;别名&gt;</span><br><span class="line"></span><br><span class="line">创建一个无本地分支的库：git init -bare</span><br></pre></td></tr></table></figure>

<h5 id="日常操作-1"><a href="#日常操作-1" class="headerlink" title="日常操作"></a>日常操作</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">分支：</span><br><span class="line">  列出远程分支：git branch -r</span><br><span class="line">  删除远程库中已经不存在的分支：git remote prune origin</span><br><span class="line">  </span><br><span class="line">从远程库获取：</span><br><span class="line">  获取但不提交：git fetch &lt;远程版本库&gt;</span><br><span class="line">  获取并提交到当前本地分支：git pull</span><br><span class="line">  </span><br><span class="line">推入远程：git push origin master</span><br></pre></td></tr></table></figure>

<h4 id="生成SSH-Key"><a href="#生成SSH-Key" class="headerlink" title="生成SSH Key"></a>生成SSH Key</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">第一步：启动git Bash控制台</span><br><span class="line">第二步：生成SSH Key：ssh-keygen -t rsa -C <span class="string">"18371207979@139.com"</span></span><br><span class="line">第三步：将SSH Key添加到Github账户里</span><br></pre></td></tr></table></figure>

<h3 id="8-使用Github-Hexo搭建个人博客"><a href="#8-使用Github-Hexo搭建个人博客" class="headerlink" title="8-使用Github+Hexo搭建个人博客"></a>8-使用Github+Hexo搭建个人博客</h3><p><a href="https://chineselijie.github.io/" target="_blank" rel="noopener">效果可点击此处</a></p>
<blockquote>
<p>当您看到这里，我就默认你掌握了git的全部常用知识。如果还不是不懂，请返回到手册的开头，再看一遍。</p>
</blockquote>
<h4 id="创建个人仓库"><a href="#创建个人仓库" class="headerlink" title="创建个人仓库"></a>创建个人仓库</h4><ul>
<li><p>第一步 ssh进自己的GitHub账户<br>在前面第四章节的时候已经将本地ssh进github账户了，所以此处不再讲解。</p>
</li>
<li><p>第二步 主界面点击<strong>Start a project</strong><br>仓库命名请以<code>.github.io</code>结尾<br>Description 为可选择填写<br>勾选<strong>Public</strong><br>不勾选<strong>Initialize this repository with a README</strong><br>点击<strong>Create repository</strong></p>
</li>
</ul>
<blockquote>
<p>例如本文的仓库名:<strong>chineseJack.github.io</strong><br><strong>Descriptiont</strong>这里填写<strong>blog</strong></p>
</blockquote>
<p>之后就会跳转到创建好仓库，细心的查看，你的仓库会形成一个地址，同时它也可以切换ssh形式或者https形式，这里我们复制ssh形式的链接<br>例如本手册的创建出来的链接：<a href="mailto:git@github.com">git@github.com</a>:chineseJack/chineseJack.github.io.git</p>
<blockquote>
<p>在做下面一些步骤时，如果你是服务器，那么还好，如果你是在虚拟机上操作，那么建议将处理器的核数调到2核以上，最好4核，不然下面会渴望到放弃。</p>
</blockquote>
<h4 id="下载安装Node-js"><a href="#下载安装Node-js" class="headerlink" title="下载安装Node.js"></a>下载安装Node.js</h4><p><a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">点击此处下载</a><br>下载Linux Binaries (x64)包，将包导入到root的家目录</p>
<p>或者用<strong>wget</strong>下载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># wget https://npm.taobao.org/mirrors/node/v10.16.0/node-v10.16.0-linux-x64.tar.xz</span></span><br><span class="line">[root@client111 ~]<span class="comment"># mv node-v10.16.0-linux-x64.tar.xz /usr/local/</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>安装node.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># cd /usr/local/</span></span><br><span class="line">[root@client111 <span class="built_in">local</span>]<span class="comment"># tar xf node-v10.16.0-linux-x64.tar.xz</span></span><br><span class="line">[root@client111 <span class="built_in">local</span>]<span class="comment"># ln -s node-v10.16.0-linux-x64 nodejs</span></span><br><span class="line">[root@client111 <span class="built_in">local</span>]<span class="comment"># cd nodejs/</span></span><br><span class="line">[root@client111 nodejs]<span class="comment"># ls</span></span><br><span class="line">bin  CHANGELOG.md  include  lib  LICENSE  README.md  share</span><br><span class="line">[root@client111 nodejs]<span class="comment"># cd bin/</span></span><br><span class="line">[root@client111 bin]<span class="comment"># ./node -v</span></span><br><span class="line">v10.16.0</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建软链接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 bin]<span class="comment"># ls</span></span><br><span class="line">node  npm  npx</span><br><span class="line">[root@client111 bin]<span class="comment"># pwd</span></span><br><span class="line">/usr/<span class="built_in">local</span>/nodejs/bin</span><br><span class="line">[root@client111 bin]<span class="comment"># ln -s /usr/local/nodejs/bin/node /usr/local/bin/node</span></span><br><span class="line">[root@client111 bin]<span class="comment"># ln -s /usr/local/nodejs/bin/npm /usr/local/bin/npm</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="安装部署Hexo"><a href="#安装部署Hexo" class="headerlink" title="安装部署Hexo"></a>安装部署Hexo</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># npm install hexo-cli -g</span></span><br><span class="line">/usr/<span class="built_in">local</span>/node-v10.16.0-linux-x64/bin/hexo -&gt; /usr/<span class="built_in">local</span>/node-v10.16.0-linux-x6 4/lib/node_modules/hexo-cli/bin/hexo</span><br><span class="line">npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.1.1 (node_modules/hex o-cli/node_modules/fsevents):</span><br><span class="line">npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform <span class="keyword">for</span> fsevents@ 2.1.1: wanted &#123;<span class="string">"os"</span>:<span class="string">"darwin"</span>,<span class="string">"arch"</span>:<span class="string">"any"</span>&#125; (current: &#123;<span class="string">"os"</span>:<span class="string">"linux"</span>,<span class="string">"arch"</span>:<span class="string">"x64"</span>&#125; )</span><br><span class="line"></span><br><span class="line">+ hexo-cli@3.1.0</span><br><span class="line">added 66 packages from 313 contributors <span class="keyword">in</span> 85.809s</span><br></pre></td></tr></table></figure>

<blockquote>
<p>出现报错，不要慌张，依次往下<br>其实<a href="mailto:fsevents@2.1.1" target="_blank" rel="noopener">fsevents@2.1.1</a> 为mac系统中的，linux系统可以忽略</p>
</blockquote>
<ul>
<li><p>创建软链接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># cd /usr/local/nodejs/lib/node_modules/hexo-cli/bin/</span></span><br><span class="line">[root@client111 bin]<span class="comment"># pwd</span></span><br><span class="line">/usr/<span class="built_in">local</span>/nodejs/lib/node_modules/hexo-cli/bin</span><br><span class="line">[root@client111 bin]<span class="comment"># ln -s /usr/local/nodejs/lib/node_modules/hexo-cli/bin/hexo /usr/local/bin/hexo</span></span><br><span class="line">[root@client111 bin]<span class="comment"># cd</span></span><br><span class="line">[root@client111 ~]<span class="comment"># vim .bash_profile</span></span><br><span class="line"><span class="comment"># 将第十行改动如下</span></span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/bin:/usr/<span class="built_in">local</span>/bin</span><br><span class="line"><span class="comment"># 保存并退出</span></span><br><span class="line">[root@client111 ~]<span class="comment"># source /etc/profile</span></span><br><span class="line">[root@client111 ~]<span class="comment"># hexo</span></span><br><span class="line">Usage: hexo &lt;<span class="built_in">command</span>&gt;</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">·······</span><br><span class="line"><span class="comment"># 如果没有报错则表示hexo安装成功</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>部署Hexo</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># cd</span></span><br><span class="line">[root@client111 ~]<span class="comment"># mkdir hexo</span></span><br><span class="line">[root@client111 ~]<span class="comment"># cd hexo/</span></span><br><span class="line">[root@client111 blog]<span class="comment"># hexo init</span></span><br><span class="line">INFO  Cloning hexo-starter https://github.com/hexojs/hexo-starter.git</span><br><span class="line">正克隆到 <span class="string">'/root/hexo'</span>...</span><br><span class="line">remote: Enumerating objects: 22, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (22/22), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (17/17), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 153 (delta 8), reused 8 (delta 3), pack-reused 131</span><br><span class="line">接收对象中: 100% (153/153), 29.67 KiB | 5.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">处理 delta 中: 100% (70/70), <span class="keyword">done</span>.</span><br><span class="line">子模组 <span class="string">'themes/landscape'</span> (https://github.com/hexojs/hexo-theme-landscape.git) 已为路径 <span class="string">'themes/landscape'</span> 注册</span><br><span class="line">正克隆到 <span class="string">'themes/landscape'</span>...</span><br><span class="line">remote: Enumerating objects: 32, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (32/32), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (25/25), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 1054 (delta 20), reused 10 (delta 7), pack-reused 1022</span><br><span class="line">接收对象中: 100% (1054/1054), 3.21 MiB | 3.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">处理 delta 中: 100% (578/578), <span class="keyword">done</span>.</span><br><span class="line">子模组路径 <span class="string">'themes/landscape'</span>：检出 <span class="string">'73a23c51f8487cfcd7c6deec96ccc7543960d350'</span></span><br><span class="line">INFO  Install dependencies</span><br><span class="line">npm notice created a lockfile as package-lock.json. You should commit this file.</span><br><span class="line">npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.2.9 (node_modules/nunjucks/node_modules/fsevents):</span><br><span class="line">npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform <span class="keyword">for</span> fsevents@1.2.9: wanted &#123;<span class="string">"os"</span>:<span class="string">"darwin"</span>,<span class="string">"arch"</span>:<span class="string">"any"</span>&#125; (current: &#123;<span class="string">"os"</span>:<span class="string">"linux"</span>,<span class="string">"arch"</span>:<span class="string">"x64"</span>&#125;)</span><br><span class="line">npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.1.1 (node_modules/fsevents):</span><br><span class="line">npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform <span class="keyword">for</span> fsevents@2.1.1: wanted &#123;<span class="string">"os"</span>:<span class="string">"darwin"</span>,<span class="string">"arch"</span>:<span class="string">"any"</span>&#125; (current: &#123;<span class="string">"os"</span>:<span class="string">"linux"</span>,<span class="string">"arch"</span>:<span class="string">"x64"</span>&#125;)</span><br><span class="line"></span><br><span class="line">added 362 packages from 470 contributors and audited 2622 packages <span class="keyword">in</span> 211.34s</span><br><span class="line">found 0 vulnerabilities</span><br><span class="line"></span><br><span class="line">INFO  Start blogging with Hexo!</span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<p>这里的警告依然如此不用理会，最后一句<strong>Start blogging with Hexo!</strong>我们就可以开始用Hexo博客！</p>
</blockquote>
<h4 id="生成测试页面"><a href="#生成测试页面" class="headerlink" title="生成测试页面"></a>生成测试页面</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 hexo]<span class="comment"># hexo g</span></span><br><span class="line">[root@client111 hexo]<span class="comment"># hexo s</span></span><br><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexo is running at http://localhost:4000 . Press Ctrl+C to stop.</span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时先不用Ctrl+C，先访问<a href="http://localhost:4000看看" target="_blank" rel="noopener">http://localhost:4000看看</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 ~]<span class="comment"># netstat -lntup | grep 'hexo'</span></span><br><span class="line">tcp6       0      0 :::4000                 :::*                    LISTEN      53413/hexo</span><br><span class="line">[root@client111 ~]<span class="comment"># yum install elinks.x86_64 -y</span></span><br><span class="line">[root@client111 ~]<span class="comment"># elinks http://localhost:4000</span></span><br><span class="line">   Link: [1]Hexo (alternate)</span><br><span class="line"></span><br><span class="line">                                    [2]Hexo</span><br><span class="line"></span><br><span class="line">   Home [3]Archives</span><br><span class="line">   [4]_____________________ [5]</span><br><span class="line">   [6]2019-11-04</span><br><span class="line"></span><br><span class="line">                                  Hello World</span><br><span class="line"></span><br><span class="line">   Welcome to [7]Hexo! This is your very first post. Check [8]documentation</span><br><span class="line">   <span class="keyword">for</span> more info. If you get any problems when using Hexo, you can find the</span><br><span class="line">   answer <span class="keyword">in</span> [9]troubleshooting or you can ask me on [10]GitHub.</span><br><span class="line"></span><br><span class="line">Quick Start</span><br><span class="line"></span><br><span class="line">  Create a new post</span><br><span class="line"></span><br><span class="line">   1 $ hexo new <span class="string">"My New Post"</span></span><br><span class="line"></span><br><span class="line">   More info: [11]Writing</span><br><span class="line"></span><br><span class="line">  Run server</span><br><span class="line"></span><br><span class="line">   1 $ hexo server</span><br><span class="line"></span><br><span class="line">   More info: [12]Server</span><br><span class="line"></span><br><span class="line">  Generate static files</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果能看到这些信息就表示成功，此时就可以Press Ctrl+C to stop。</p>
</blockquote>
<h4 id="生成博客页面"><a href="#生成博客页面" class="headerlink" title="生成博客页面"></a>生成博客页面</h4><ul>
<li>修改配置文件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 hexo]<span class="comment"># ls</span></span><br><span class="line">_config.yml  node_modules  package-lock.json  scaffolds  themes</span><br><span class="line">db.json      package.json  public             <span class="built_in">source</span></span><br><span class="line">[root@client111 hexo]<span class="comment"># vim _config.yml</span></span><br><span class="line"><span class="comment"># 在最后一行添加：</span></span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: git@github.com:chineseJack/chineseJack.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<p>repo这里请使用上面创建仓库时所复制的链接</p>
</blockquote>
<ul>
<li>生成页面并部署<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 hexo]<span class="comment"># hexo c &amp;&amp; hexo g &amp;&amp; hexo d</span></span><br><span class="line">········</span><br><span class="line">INFO  28 files generated <span class="keyword">in</span> 410 ms</span><br><span class="line">ERROR Deployer not found: git</span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<p>出现报错，不要惊慌<br>解决办法：</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 hexo]<span class="comment"># npm install --save hexo-deployer-git</span></span><br><span class="line">npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.1.1 (node_modules/fsevents):</span><br><span class="line">npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform <span class="keyword">for</span> fsevents@2.1.1: wanted &#123;<span class="string">"os"</span>:<span class="string">"darwin"</span>,<span class="string">"arch"</span>:<span class="string">"any"</span>&#125; (current: &#123;<span class="string">"os"</span>:<span class="string">"linux"</span>,<span class="string">"arch"</span>:<span class="string">"x64"</span>&#125;)</span><br><span class="line">npm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@1.2.9 (node_modules/nunjucks/node_modules/fsevents):</span><br><span class="line">npm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform <span class="keyword">for</span> fsevents@1.2.9: wanted &#123;<span class="string">"os"</span>:<span class="string">"darwin"</span>,<span class="string">"arch"</span>:<span class="string">"any"</span>&#125; (current: &#123;<span class="string">"os"</span>:<span class="string">"linux"</span>,<span class="string">"arch"</span>:<span class="string">"x64"</span>&#125;)</span><br><span class="line"></span><br><span class="line">+ hexo-deployer-git@2.0.0</span><br><span class="line">added 1 package from 1 contributor and audited 2697 packages <span class="keyword">in</span> 5.796s</span><br><span class="line">found 0 vulnerabilities</span><br></pre></td></tr></table></figure>

<blockquote>
<p>忽视前4行的报错</p>
</blockquote>
<p><strong>再进行一次部署</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 hexo]<span class="comment"># hexo c &amp;&amp; hexo g &amp;&amp; hexo d</span></span><br><span class="line">············</span><br><span class="line">Username <span class="keyword">for</span> <span class="string">'https://github.com'</span>: chineseJack <span class="comment"># 这里树妖验证你的github账户</span></span><br><span class="line">Password <span class="keyword">for</span> <span class="string">'https://chineseJack@github.com'</span>:   <span class="comment"># 这里需要验证你的GitHub账户密码</span></span><br><span class="line">·········</span><br><span class="line">To git@github.com:chineseJack/chineseJack.github.io.git</span><br><span class="line"> * [new branch]      HEAD -&gt; master</span><br><span class="line">分支 master 设置为跟踪来自 git@github.com:chineseJack/chineseJack.github.io.git 的远程分支 master。</span><br><span class="line">INFO  Deploy <span class="keyword">done</span>: git</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ul>
<li>至此，搭建个人博客已结束，浏览器访问仓库名称就是属于自己的个人博客<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@client111 hexo]<span class="comment"># elinks chineseJack.github.io</span></span><br><span class="line">   Link: [1]Hexo (alternate)</span><br><span class="line"></span><br><span class="line">                                    [2]Hexo</span><br><span class="line"></span><br><span class="line">   Home [3]Archives</span><br><span class="line">   [4]_____________________ [5]</span><br><span class="line">   [6]2019-11-04</span><br><span class="line"></span><br><span class="line">                                  Hello World</span><br><span class="line"></span><br><span class="line">   Welcome to [7]Hexo! This is your very first post. Check [8]documentation</span><br><span class="line">   <span class="keyword">for</span> more info. If you get any problems when using Hexo, you can find the</span><br><span class="line">   answer <span class="keyword">in</span> [9]troubleshooting or you can ask me on [10]GitHub.</span><br><span class="line"></span><br><span class="line">Quick Start</span><br><span class="line"></span><br><span class="line">  Create a new post</span><br><span class="line"></span><br><span class="line">   1 $ hexo new <span class="string">"My New Post"</span></span><br><span class="line"></span><br><span class="line">   More info: [11]Writing</span><br><span class="line"></span><br><span class="line">  Run server</span><br></pre></td></tr></table></figure>

</li>
</ul>

      
      <!-- 打赏 -->
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chineselijie/2019/10/29/git版本控制详解手册/" data-id="ck7ooyam3003q4su67a8tr8z6"
        class="article-share-link">分享</a>
        
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Git/">Git</a></li></ul>

    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-16.linux--RHCSA模拟" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/08/29/16.linux--RHCSA模拟/"
    >RHCSA复习</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2019/08/29/16.linux--RHCSA模拟/" class="article-date">
  <time datetime="2019-08-29T15:44:18.601Z" itemprop="datePublished">2019-08-29</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux基础/">linux基础</a>
  </div>

      
      
      
    </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <h3 id="1-破解root密码"><a href="#1-破解root密码" class="headerlink" title="1.破解root密码"></a>1.破解root密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">启动界面 按e</span><br><span class="line">下翻至最后2行，删除到ro 若有语言代码不用删除，按下ctrl+x键</span><br><span class="line">mount -o remount,rw /sysroot</span><br><span class="line">chroot /sysroot</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"tangkai"</span> | passwd --stdin root</span><br><span class="line">touch /.autorelabel</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<h3 id="2-配置IP地址"><a href="#2-配置IP地址" class="headerlink" title="2.配置IP地址"></a>2.配置IP地址</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">IPADDR=172.25.254.10</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=172.25.254.254</span><br><span class="line">DNS1=172.25.254.250</span><br><span class="line">保存并退出</span><br><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure>

<p>【此时在本地主机上开一个终端远程连接】<br>ssh <a href="mailto:root@172.25.254.10" target="_blank" rel="noopener">root@172.25.254.10</a></p>
<h3 id="3-更改主机名"><a href="#3-更改主机名" class="headerlink" title="3.更改主机名"></a>3.更改主机名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># vim /etc/hostname</span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat /etc/hostname </span></span><br><span class="line">station.domain12.example.com</span><br><span class="line">[root@localhost ~]<span class="comment"># bash</span></span><br><span class="line">[root@station ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="4-配置yum源"><a href="#4-配置yum源" class="headerlink" title="4.配置yum源"></a>4.配置yum源</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cd /etc/yum.repos.d/</span></span><br><span class="line">[root@localhost yum.repos.d]<span class="comment"># ls</span></span><br><span class="line">rhel_dvd.repo</span><br><span class="line">[root@localhost yum.repos.d]<span class="comment"># rm -rf rhel_dvd.repo </span></span><br><span class="line">[root@localhost yum.repos.d]<span class="comment"># vim zhou.repo</span></span><br><span class="line">[root@localhost yum.repos.d]<span class="comment"># cat zhou.repo</span></span><br><span class="line">[zhou]</span><br><span class="line">name=zhou</span><br><span class="line">baseurl=http://classroom.example.com/content/rhel7.0/x86_64/dvd/</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">[root@localhost yum.repos.d]<span class="comment"># yum clean all</span></span><br><span class="line">[root@localhost yum.repos.d]<span class="comment"># yum install vsftpd -y</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>此时安装报错，可能是classroom.example.com访问不了，请看最下面介绍的注意</p>
</blockquote>
<h3 id="5-配置selinux"><a href="#5-配置selinux" class="headerlink" title="5.配置selinux"></a>5.配置selinux</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@station ~]<span class="comment"># vim /etc/selinux/config</span></span><br><span class="line">SELINUX=enforcing（将disabled修改为enforcing）</span><br></pre></td></tr></table></figure>

<h3 id="6-配置系统磁盘及打包操作"><a href="#6-配置系统磁盘及打包操作" class="headerlink" title="6.配置系统磁盘及打包操作"></a>6.配置系统磁盘及打包操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">lsblk</span><br><span class="line">fdisk /dev/vdb</span><br><span class="line">p-n-p-回车-回车-+500M-p-w</span><br><span class="line">partprobe /dev/vdb</span><br><span class="line">lsblk</span><br><span class="line">mkfs.xfs /dev/vdb1</span><br><span class="line">mkdir /common</span><br><span class="line">blkid</span><br><span class="line">复制/dev/vdb1的UUID</span><br><span class="line">vim /etc/fstab</span><br><span class="line">UUID=<span class="string">"2204b223-5803-4136-b09b-59903527dc77"</span> /common xfs defaults 0 0 </span><br><span class="line">保存并退出</span><br><span class="line">mount -a</span><br><span class="line">df -Th</span><br><span class="line"></span><br><span class="line">mkdir /common/adm</span><br><span class="line"><span class="built_in">cd</span> /common</span><br><span class="line">useradd admin</span><br><span class="line">chown .admin adm</span><br><span class="line">ls -l</span><br><span class="line">setfacl -m g:admin:rwx adm</span><br><span class="line">setfacl -m o::--- adm</span><br><span class="line">ls -l</span><br><span class="line"></span><br><span class="line">tar cjf backup_local.tar.bz2 /usr/<span class="built_in">local</span></span><br><span class="line">ls</span><br></pre></td></tr></table></figure>

<h3 id="7-内核设置"><a href="#7-内核设置" class="headerlink" title="7.内核设置"></a>7.内核设置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">wget http://classroom.example.com/content/rhel7.3/x86_64/dvd/Packages/kernel-3.10.0-514.el7.x86_64.rpm</span><br><span class="line">rpm -ivh kernel-3.10.0-514.el7.x86_64.rpm</span><br><span class="line">wget http://classroom.example.com/content/rhel7.3/x86_64/dvd/Packages/dracut-033-463.el7.x86_64.rpm</span><br><span class="line">wget http://classroom.example.com/content/rhel7.3/x86_64/dvd/Packages/linux-firmware-20160830-49.git7534e19.el7.noarch.rpm</span><br><span class="line">wget http://classroom.example.com/content/rhel7.3/x86_64/dvd/Packages/xfsprogs-4.5.0-8.el7.x86_64.rpm</span><br><span class="line">wget http://classroom.example.com/content/rhel7.3/x86_64/dvd/Packages/kmod-20-9.el7.x86_64.rpm</span><br><span class="line">rpm -Uvh kmod-20-9.el7.x86_64.rpm</span><br><span class="line">rpm -Uvh linux-firmware-20160830-49.git7534e19.el7.noarch.rpm </span><br><span class="line">rpm -Uvh xfsprogs-4.5.0-8.el7.x86_64.rpm </span><br><span class="line">rpm -Uvh dracut-033-463.el7.x86_64.rpm --nodeps</span><br><span class="line">rpm -ivh kernel-3.10.0-514.el7.x86_64.rpm</span><br><span class="line">【此时中途会卡一会，不必惊慌，等待出来提示符】</span><br><span class="line">reboot</span><br><span class="line">等待2分钟再次ssh root@172.25.254.10</span><br><span class="line">uname -r</span><br><span class="line">3.10.0-514.el7.x86_64</span><br><span class="line">【此时表示内核升级成功】</span><br></pre></td></tr></table></figure>

<h3 id="8-开启IP转发功能"><a href="#8-开启IP转发功能" class="headerlink" title="8.开启IP转发功能"></a>8.开启IP转发功能</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysctl.conf</span><br><span class="line">复制 /usr/lib/sysctl.d/00-system.conf</span><br><span class="line">退出</span><br><span class="line">vim /usr/lib/sysctl.d/00-system.conf</span><br><span class="line">加入 net.ipv4.ip_forward = 1</span><br><span class="line">保存并退出</span><br><span class="line">sysctl -p /usr/lib/sysctl.d/00-system.conf</span><br><span class="line">【当有出现net.ipv4.ip_forward = 1表示IP转发成功】</span><br></pre></td></tr></table></figure>

<h3 id="9-计划任务"><a href="#9-计划任务" class="headerlink" title="9.计划任务"></a>9.计划任务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">useradd natasha</span><br><span class="line">crontab -u natasha -e</span><br><span class="line">23 14 * * * /usr/bin/<span class="built_in">echo</span> <span class="string">"I AM RHCE"</span></span><br><span class="line">保存并退出</span><br><span class="line">vim /etc/cron.allow</span><br><span class="line">root</span><br><span class="line">natasha</span><br><span class="line">保存并退出</span><br></pre></td></tr></table></figure>

<h3 id="10-创建用户"><a href="#10-创建用户" class="headerlink" title="10.创建用户"></a>10.创建用户</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">useradd tangkai -c <span class="string">"BOSS"</span> -u 9999 -G root -d /tangkai</span><br><span class="line">tail -n 1 /etc/passwd</span><br></pre></td></tr></table></figure>

<h3 id="11-创建用户和组"><a href="#11-创建用户和组" class="headerlink" title="11.创建用户和组"></a>11.创建用户和组</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">usermod -a -G admin natasha</span><br><span class="line">id natasha</span><br><span class="line">useradd -G admin harry</span><br><span class="line">id harry</span><br><span class="line">useradd -s /sbin/nologin sarah</span><br><span class="line">id sarah</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"tangkai"</span> | passwd --stdin natasha</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"tangkai"</span> | passwd --stdin harry</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"tangkai"</span> | passwd --stdin sarah</span><br><span class="line">chage -M 30 -W 5 natasha</span><br><span class="line">chage -l natasha</span><br></pre></td></tr></table></figure>

<h3 id="12-权限设置"><a href="#12-权限设置" class="headerlink" title="12.权限设置"></a>12.权限设置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cp /etc/fstab /var/tmp</span><br><span class="line"><span class="built_in">cd</span> /var/tmp</span><br><span class="line">ls -l</span><br><span class="line">setfacl -m u:natasha:rw- fstab</span><br><span class="line">setfacl -m u:harry:--- fstab</span><br><span class="line">setfacl -m o::r-- fstab</span><br><span class="line">ls -l</span><br></pre></td></tr></table></figure>

<h3 id="13-远程登陆"><a href="#13-远程登陆" class="headerlink" title="13.远程登陆"></a>13.远程登陆</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">1）用LDAP验证：</span><br><span class="line"><span class="built_in">cd</span> /etc/openldap/</span><br><span class="line">mkdir cacerts</span><br><span class="line"><span class="built_in">cd</span> cacerts/</span><br><span class="line">wget http://classroom.example.com/pub/example-ca.crt</span><br><span class="line">yum install authconfig* sssd* krb5* -y</span><br><span class="line">authconfig-tui</span><br><span class="line">【此处勾选以下四个：】</span><br><span class="line">【Use LDAP】</span><br><span class="line">【Use Shadow Passwords】</span><br><span class="line">【Use LDAP Authentication】</span><br><span class="line">【Local authorization is sufficient】</span><br><span class="line">然后下一步</span><br><span class="line"> [*] Use TLS</span><br><span class="line">Server: classroom.example.com</span><br><span class="line">Base DN: dc=example,dc=com</span><br><span class="line">然后ok</span><br><span class="line">su - ldapuser12</span><br><span class="line">出现bash-4.2$为正确</span><br><span class="line"></span><br><span class="line">2）用kerbros验证</span><br><span class="line">authconfig-tui</span><br><span class="line">【此处勾选以下四个：】</span><br><span class="line">【Use LDAP】</span><br><span class="line">【Use Shadow Passwords】</span><br><span class="line">【Use Kerberos】</span><br><span class="line">【Local authorization is sufficient】</span><br><span class="line">然后下一步</span><br><span class="line"> [*] Use TLS</span><br><span class="line">Server: classroom.example.com</span><br><span class="line">Base DN: dc=example,dc=com</span><br><span class="line">然后下一步</span><br><span class="line">Realm: EXAMPLE.COM</span><br><span class="line">KDC: classroom.example.com </span><br><span class="line">Admin Server: classroom.example.com </span><br><span class="line">[ ] Use DNS to resolve hosts to realms</span><br><span class="line">[ ] Use DNS to locate KDCs <span class="keyword">for</span> realms  </span><br><span class="line">然后OK</span><br><span class="line">su - ldapuser12</span><br><span class="line">出现bash-4.2$为正确</span><br></pre></td></tr></table></figure>

<h3 id="14-NTP客户端连接"><a href="#14-NTP客户端连接" class="headerlink" title="14.NTP客户端连接"></a>14.NTP客户端连接</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/chrony.conf</span><br><span class="line"></span><br><span class="line"><span class="comment">#server 0.rhel.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 1.rhel.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 2.rhel.pool.ntp.org iburst</span></span><br><span class="line"><span class="comment">#server 3.rhel.pool.ntp.org iburst</span></span><br><span class="line">server classroom.example.com iburst</span><br><span class="line"></span><br><span class="line">保存并退出</span><br><span class="line"></span><br><span class="line">systemctl restart chronyd</span><br><span class="line">systemctl <span class="built_in">enable</span> chronyd</span><br></pre></td></tr></table></figure>

<h3 id="15-LDAP客户端自动挂载"><a href="#15-LDAP客户端自动挂载" class="headerlink" title="15.LDAP客户端自动挂载"></a>15.LDAP客户端自动挂载</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">yum install autofs.x86_64 -y</span><br><span class="line"><span class="built_in">cd</span> /etc</span><br><span class="line">ll auto.【此处tab两下】</span><br><span class="line">vim auto.master</span><br><span class="line">在/misc   /etc/auto.misc下添加</span><br><span class="line">/home/guests /etc/auto.ldap</span><br><span class="line">保存并退出</span><br><span class="line">cp auto.misc auto.ldap</span><br><span class="line">vim auto.ldap</span><br><span class="line">ldapuser12  -rw  classroom.example.com:/home/guests/ldapuser12</span><br><span class="line">保存并退出</span><br><span class="line">systemctl restart autofs</span><br><span class="line">systemctl <span class="built_in">enable</span> autofs</span><br><span class="line">su - ldapuser12</span><br><span class="line">【出现完整的登陆提示符表示登陆完成】</span><br><span class="line">[ldapuser12@station ~]$</span><br></pre></td></tr></table></figure>

<h3 id="16-查找文件"><a href="#16-查找文件" class="headerlink" title="16.查找文件"></a>16.查找文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find / -user tangkai -<span class="built_in">exec</span> cp -rf &#123;&#125; /root/findfile/ \;</span><br><span class="line"></span><br><span class="line">cat /usr/share/dict/words | grep <span class="string">"atens"</span> &gt; /root/lines.txt</span><br></pre></td></tr></table></figure>

<h3 id="17-文件系统管理"><a href="#17-文件系统管理" class="headerlink" title="17.文件系统管理"></a>17.文件系统管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">lsblk</span><br><span class="line">fdisk /dev/vdb</span><br><span class="line">n<span class="_">-e</span>-回车-回车-回车-n<span class="_">-l</span>-回车-+500M-p-w</span><br><span class="line">fdisk /dev/vdb</span><br><span class="line">p-回车-82-w</span><br><span class="line">partprobe /dev/vdb</span><br><span class="line">mkswap /dev/vdb5</span><br><span class="line">blkid</span><br><span class="line">复制/dev/vdb5的UUID</span><br><span class="line">vim /etc/fstab</span><br><span class="line">UUID=<span class="string">"1fdd485e-faf5-4635-a61c-d9e0aef78702"</span> swap swap defaults 0 0</span><br><span class="line">保存并退出</span><br><span class="line">swapon /dev/vdb5</span><br><span class="line">free -m</span><br><span class="line">【swap中total出现499表示成功】</span><br></pre></td></tr></table></figure>

<h3 id="18-LVM拉大-减小"><a href="#18-LVM拉大-减小" class="headerlink" title="18.LVM拉大/减小"></a>18.LVM拉大/减小</h3><blockquote>
<p>此题先存放至最后倒数第二题时候再做</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">df -Th  这里会有一个vo</span><br><span class="line">环境中没有所以我们先创建一个vo</span><br><span class="line">lsblk</span><br><span class="line">fdisk /dev/vdb</span><br><span class="line">p-n<span class="_">-l</span>-回车-+400M-p-t-回车-8e-w</span><br><span class="line">partprobe /dev/vdb</span><br><span class="line">lsblk</span><br><span class="line">vgcreate vg0 /dev/vdb6</span><br><span class="line">lvcreate -L 200M -n vo vg0</span><br><span class="line">lvdisplay</span><br><span class="line">lsblk</span><br><span class="line">mkfs.ext4 /dev/vg0/vo</span><br><span class="line">blkid</span><br><span class="line">复制/dev/loop0的UUID</span><br><span class="line">vim /etc/fstab</span><br><span class="line">UUID=<span class="string">"c5e1fe56-4745-4e34-ae69-715e008b3bfe"</span> /vo ext4 defaults 0 0</span><br><span class="line">mkdir /vo</span><br><span class="line">mount -a</span><br><span class="line">lsblk</span><br><span class="line">df -Th</span><br><span class="line">【此时就有一个vo了】</span><br><span class="line">【以上考试时候是已经有了，只需做以下步骤】</span><br><span class="line">lvextend -L 312M /dev/vg0/vo</span><br><span class="line">resize2fs /dev/vg0/vo</span><br><span class="line">df -Th</span><br><span class="line">【此时可以看到299M，表示成功】</span><br></pre></td></tr></table></figure>

<h3 id="19-ACL控制及权限委派"><a href="#19-ACL控制及权限委派" class="headerlink" title="19.ACL控制及权限委派"></a>19.ACL控制及权限委派</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">useradd admin1</span><br><span class="line">useradd admin2</span><br><span class="line">useradd admin3</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"tangkai"</span> | passwd --stdin admin1</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"tangkai"</span> | passwd --stdin admin2</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"tangkai"</span> | passwd --stdin admin3</span><br><span class="line">useradd user2 -s /sbin/nologin</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"tangkai"</span> | passwd --stdin user2</span><br><span class="line">mkdir /data</span><br><span class="line">setfacl -m u:admin1:rwx /data</span><br><span class="line">setfacl -m u:admin2:r-x /data</span><br><span class="line">setfacl -m u:admin3:--- /data</span><br><span class="line">chown .admin1 /data</span><br><span class="line">chmod g+s /data</span><br><span class="line">mkdir /storage</span><br><span class="line">chmod 777 /storage/</span><br><span class="line">chmod o+t /storage/</span><br><span class="line">visudo</span><br><span class="line">找到root    ALL=(ALL)       ALL 在下面一行写上：</span><br><span class="line">admin1   ALL=(ALL)       /usr/sbin/useradd,/usr/sbin/userdel,/usr/sbin/usermod</span><br><span class="line">保存并退出</span><br></pre></td></tr></table></figure>

<h3 id="20-日志管理"><a href="#20-日志管理" class="headerlink" title="20.日志管理"></a>20.日志管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/rsyslog.conf</span><br><span class="line">找到mail.*</span><br><span class="line">将后面的-/var/<span class="built_in">log</span>/maillog替换成classroom.example.com</span><br><span class="line">systemctl restart rsyslog.service </span><br><span class="line">systemctl <span class="built_in">enable</span> rsyslog.service </span><br><span class="line">systemctl stop rsyslog.service</span><br></pre></td></tr></table></figure>

<h3 id="21-LVM配置"><a href="#21-LVM配置" class="headerlink" title="21.LVM配置"></a>21.LVM配置</h3><blockquote>
<p>此题先存放至最后一题时候再做</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">1)</span><br><span class="line">lsblk </span><br><span class="line">fdisk /dev/vdb</span><br><span class="line">p-n<span class="_">-l</span>-回车-+816M-t-回车-8e-w</span><br><span class="line">partprobe</span><br><span class="line">lsblk</span><br><span class="line">pvcreate /dev/vdb7</span><br><span class="line">vgcreate -s 16M -p 50 datastore /dev/vdb7</span><br><span class="line">vgdisplay</span><br><span class="line"></span><br><span class="line">lvcreate -L 800M -n database datastore</span><br><span class="line">lvs</span><br><span class="line">mkdir /mnt/wshare</span><br><span class="line">mkfs.vfat /dev/datastore/database</span><br><span class="line">blkid</span><br><span class="line">复制/dev/mapper/datastore-database的UUID</span><br><span class="line">vim/etc/fstab</span><br><span class="line">UUID=<span class="string">"2E55-7C3E"</span> /mnt/wshare vfat defaults 0 0</span><br><span class="line">保存并退出</span><br><span class="line">mount -a</span><br><span class="line">df -Th</span><br><span class="line"></span><br><span class="line">2)</span><br><span class="line">lsblk</span><br><span class="line">fdisk /dev/vdb</span><br><span class="line">p-n<span class="_">-l</span>-回车-+168M-p-t-回车-8e-w</span><br><span class="line">partprobe</span><br><span class="line">pvcreate /dev/vdb8</span><br><span class="line">vgcreate -s 8M -p 20 vg1 /dev/vdb8</span><br><span class="line">vgdisplay</span><br><span class="line"></span><br><span class="line">lvcreate -L 160 -n game vg1</span><br><span class="line">lvdisplay</span><br><span class="line">mkfs.ext4 /dev/vg1/game</span><br><span class="line">ll /storage</span><br><span class="line">复制/dev/mapper/vg1-game的UUID</span><br><span class="line">vim/etc/fstab</span><br><span class="line">UUID=<span class="string">"b1f45d75-53b2-4691-8198-841f14719e31"</span> /storage ext4 defaults 0 0</span><br><span class="line">保存并退出</span><br><span class="line">mount -a</span><br><span class="line">df -Th</span><br><span class="line"></span><br><span class="line">3）</span><br><span class="line">lsblk</span><br><span class="line">fdisk /dev/vdb</span><br><span class="line">p-n<span class="_">-l</span>-回车-+746M-p-t-回车-8e-w</span><br><span class="line">partprobe</span><br><span class="line">pvcreate /dev/vdb9</span><br><span class="line">vgextend vg1 /dev/vdb9</span><br><span class="line">vgdisplay</span><br><span class="line">lvextend -L 746M /dev/vg1/game </span><br><span class="line">resize2fs /dev/vg1/game</span><br><span class="line">lvdisplay </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">4)</span><br><span class="line">umount /dev/vg1/game</span><br><span class="line">e2fsck -f /dev/vg1/game</span><br><span class="line">resize2fs /dev/vg1/game 160M</span><br><span class="line">lvreduce -L 160M /dev/vg1/game</span><br><span class="line">y</span><br><span class="line">df -Th</span><br><span class="line">e2fsck /dev/vg1/game</span><br><span class="line">mount -a</span><br><span class="line">df -Th</span><br></pre></td></tr></table></figure>

<h3 id="22-过滤操作"><a href="#22-过滤操作" class="headerlink" title="22.过滤操作"></a>22.过滤操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install vsftpd.x86_64 -y</span><br><span class="line">cp /etc/vsftpd/vsftpd.conf /root</span><br><span class="line">cat vsftpd.conf | grep -v ^<span class="comment"># | grep -v ^$ | grep "YES"$ &gt; /root/ftp.txt</span></span><br></pre></td></tr></table></figure>

<h3 id="23-挂载操作"><a href="#23-挂载操作" class="headerlink" title="23.挂载操作"></a>23.挂载操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">wget http://classroom.example.com/content/boot/rhci-foundation-7.3-5.r46146.iso</span><br><span class="line">mv  rhci-foundation-7.3-5.r46146.iso boot.iso</span><br><span class="line">vim /etc/fstab</span><br><span class="line">将：</span><br><span class="line">/root/boot.iso    /media/cdrom     iso9660 defaults,loop 0 0</span><br><span class="line">添加至最后一行</span><br><span class="line">保存并退出</span><br><span class="line">mount -a</span><br></pre></td></tr></table></figure>

<h3 id="24-计划任务"><a href="#24-计划任务" class="headerlink" title="24.计划任务"></a>24.计划任务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br><span class="line">*/10 14-17 1-5 * * /usr/bin/<span class="built_in">echo</span> <span class="string">"I Love RHCE"</span></span><br><span class="line">保存并退出</span><br><span class="line">cat /etc/cron.allow</span><br><span class="line">systemctl restart crond</span><br><span class="line">systemctl <span class="built_in">enable</span> crond</span><br></pre></td></tr></table></figure>

<h3 id="25-防火墙"><a href="#25-防火墙" class="headerlink" title="25.防火墙"></a>25.防火墙</h3><p>systemctl stop firewalld.service<br>systemctl disable firewalld.service<br>systemctl mask firewalld.service<br>iptables -nvL<br>iptables -F<br>service iptables save</p>
<h3 id="注："><a href="#注：" class="headerlink" title="注："></a>注：</h3><p>如classroom.example.com不能访问<br>首先在本地主机远程172.25.254.254（172.25.0.254）<br>命令如下：<br>ssh <a href="mailto:root@172.25.254.254" target="_blank" rel="noopener">root@172.25.254.254</a><br>echo ‘NSSENforceValidCerts off’ &gt;&gt; /etc/httpd/conf.d/nss.conf<br>systemctl restart httpd</p>

      
      <!-- 打赏 -->
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chineselijie/2019/08/29/16.linux--RHCSA模拟/" data-id="ck7ooyafe00154su6tjcrt6ly"
        class="article-share-link">分享</a>
        
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux基础/">linux基础</a></li></ul>

    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-15.linux--linux基础练习" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/08/29/15.linux--linux基础练习/"
    >linux基础练习</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2019/08/29/15.linux--linux基础练习/" class="article-date">
  <time datetime="2019-08-29T15:44:18.597Z" itemprop="datePublished">2019-08-29</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux基础/">linux基础</a>
  </div>

      
      
      
    </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <blockquote>
<p><strong>关于作者</strong></p>
<p><strong>周李杰</strong>，最后一批90后，现居<strong>湖北武汉</strong></p>
<p>孤独患者，懒癌中期，无脑幻想者。但却人畜无害，无需远离。</p>
<p>兴趣众多，然无一精通。正努力成为一个有趣的人。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; print(&quot;👆以上是不完整的我&quot;) //请我吃大餐将会了解更多</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="关闭selinux，手工配置本地yum源"><a href="#关闭selinux，手工配置本地yum源" class="headerlink" title="关闭selinux，手工配置本地yum源"></a>关闭selinux，手工配置本地yum源</h3><h4 id="关闭SElinux："><a href="#关闭SElinux：" class="headerlink" title="关闭SElinux："></a>关闭SElinux：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># getenforce</span></span><br><span class="line">Enforcing</span><br><span class="line">[root@zhoulijie ~]<span class="comment"># setenforce 0</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># getenforce</span></span><br><span class="line">Permissive</span><br><span class="line"><span class="comment"># 配置文件在：</span></span><br><span class="line">/etc/selinux/config</span><br></pre></td></tr></table></figure>

<h4 id="手工配置本地yum源"><a href="#手工配置本地yum源" class="headerlink" title="手工配置本地yum源:"></a>手工配置本地yum源:</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># cd /etc/yum.repos.d/</span></span><br><span class="line">[root@MR yum.repos.d]<span class="comment"># ls</span></span><br><span class="line">[root@MR dev]<span class="comment"># mkdir /mnt/cdrom</span></span><br><span class="line">[root@MR dev]<span class="comment"># mount /dev/sr0 /mnt/cdrom/</span></span><br><span class="line">mount: /dev/sr0 写保护，将以只读方式挂载</span><br><span class="line">[root@MR dev]<span class="comment"># vi /etc/fstab</span></span><br><span class="line">将/dev/sr0        /mnt/cdrom      iso9660   defaults    0    0</span><br><span class="line">写入到最后一行后保存并退出</span><br><span class="line">[root@MR dev]<span class="comment"># df -Th</span></span><br><span class="line">文件系统              类型      容量  已用  可用 已用% 挂载点</span><br><span class="line">/dev/mapper/rhel-root xfs        18G  816M   17G    5% /</span><br><span class="line">devtmpfs              devtmpfs  908M     0  908M    0% /dev</span><br><span class="line">tmpfs                 tmpfs     914M     0  914M    0% /dev/shm</span><br><span class="line">tmpfs                 tmpfs     914M  8.6M  905M    1% /run</span><br><span class="line">tmpfs                 tmpfs     914M     0  914M    0% /sys/fs/cgroup</span><br><span class="line">/dev/sda1             xfs       497M   96M  401M   20% /boot</span><br><span class="line">/dev/sr0              iso9660   3.5G  3.5G     0  100% /mnt/cdrom</span><br><span class="line"><span class="comment"># 此时/dev/sr0已经挂载到/mnt/cdrom</span></span><br><span class="line">[root@MR dev]<span class="comment"># cd /etc/yum.repos.d/</span></span><br><span class="line">[root@MR yum.repos.d]<span class="comment"># ls</span></span><br><span class="line">[root@MR yum.repos.d]<span class="comment"># vi bendiyum.repo</span></span><br><span class="line">将：</span><br><span class="line">[bendiyum]</span><br><span class="line">name=bendiyum</span><br><span class="line">baseurl=file:///mnt/cdrom</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">加入进去，保存并退出</span><br><span class="line">[root@MR yum.repos.d]<span class="comment"># yum clean all</span></span><br><span class="line">[root@MR yum.repos.d]<span class="comment"># yum list | wc -l</span></span><br><span class="line">4405</span><br><span class="line"><span class="comment"># 此时本地yum源成功搭建</span></span><br></pre></td></tr></table></figure>

<h3 id="安装vsftpd，并启动vsftpd服务"><a href="#安装vsftpd，并启动vsftpd服务" class="headerlink" title="安装vsftpd，并启动vsftpd服务"></a>安装vsftpd，并启动vsftpd服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># yum -y install vsftopd</span></span><br><span class="line">[root@MR ~]<span class="comment"># systemctl start vsftpd</span></span><br></pre></td></tr></table></figure>

<h3 id="安装krb5-config命令"><a href="#安装krb5-config命令" class="headerlink" title="安装krb5-config命令"></a>安装krb5-config命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># yum provides krb5-config</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># yum -y install krb5-devel-1.11.3-49.el7.x86_64</span></span><br><span class="line">[root@zhoulijie /]<span class="comment"># krb5-config</span></span><br></pre></td></tr></table></figure>

<h3 id="使用rpm命令安装httpd软件，不解决依赖关系进行安装"><a href="#使用rpm命令安装httpd软件，不解决依赖关系进行安装" class="headerlink" title="使用rpm命令安装httpd软件，不解决依赖关系进行安装"></a>使用rpm命令安装httpd软件，不解决依赖关系进行安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">待解答</span><br></pre></td></tr></table></figure>

<h3 id="使用sed命令将网卡配置文件的ONBOOT-no-改为ONBOOT-yes"><a href="#使用sed命令将网卡配置文件的ONBOOT-no-改为ONBOOT-yes" class="headerlink" title="使用sed命令将网卡配置文件的ONBOOT=no 改为ONBOOT=yes"></a>使用sed命令将网卡配置文件的ONBOOT=no 改为ONBOOT=yes</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@MR network-scripts]<span class="comment"># cat -n /etc/sysconfig/network-scripts/ifcfg-eno16777736</span></span><br><span class="line">     1  HWADDR=<span class="string">"00:0C:29:B6:10:19"</span></span><br><span class="line">    ........(中间省略)</span><br><span class="line">    16  ONBOOT=<span class="string">"no"</span></span><br><span class="line">[root@MR network-scripts]<span class="comment"># sed '16c ONBOOT=“yes”' ifcfg-eno16777736</span></span><br><span class="line">HWADDR=<span class="string">"00:0C:29:B6:10:19"</span></span><br><span class="line">........(中间省略)</span><br><span class="line">ONBOOT=“yes<span class="string">"</span></span><br></pre></td></tr></table></figure>

<h3 id="备份-etc-shadow到-tmp-，保留其权限，使用sed命将此文件中的root替换为aaaabbbb，并对比-etc-shadow和-tmp-shadow两个文件的差别"><a href="#备份-etc-shadow到-tmp-，保留其权限，使用sed命将此文件中的root替换为aaaabbbb，并对比-etc-shadow和-tmp-shadow两个文件的差别" class="headerlink" title="备份/etc/shadow到/tmp ，保留其权限，使用sed命将此文件中的root替换为aaaabbbb，并对比/etc/shadow和/tmp/shadow两个文件的差别"></a>备份/etc/shadow到/tmp ，保留其权限，使用sed命将此文件中的root替换为aaaabbbb，并对比/etc/shadow和/tmp/shadow两个文件的差别</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@MR /]<span class="comment"># cp /etc/shadow /tmp</span></span><br><span class="line">[root@MR tmp]<span class="comment"># sed s/root/aaaabbbb/ /tmp/shadow</span></span><br></pre></td></tr></table></figure>

<h3 id="添加用户：user1，并为文件-tmp-shadow文件添加user1的ACL，权限为读和执行-并把user1加入root组"><a href="#添加用户：user1，并为文件-tmp-shadow文件添加user1的ACL，权限为读和执行-并把user1加入root组" class="headerlink" title="添加用户：user1，并为文件/tmp/shadow文件添加user1的ACL，权限为读和执行,并把user1加入root组"></a>添加用户：user1，并为文件/tmp/shadow文件添加user1的ACL，权限为读和执行,并把user1加入root组</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@MR home]<span class="comment"># useradd -G root user1</span></span><br><span class="line">[root@MR home]<span class="comment"># id user1</span></span><br><span class="line">uid=1000(user1) gid=1000(user1) 组=1000(user1),0(root)</span><br></pre></td></tr></table></figure>

<h3 id="使用find命令找出系统中所有属于user1的文件"><a href="#使用find命令找出系统中所有属于user1的文件" class="headerlink" title="使用find命令找出系统中所有属于user1的文件"></a>使用find命令找出系统中所有属于user1的文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@MR home]<span class="comment"># find -name user1</span></span><br><span class="line">./user1</span><br></pre></td></tr></table></figure>

<h3 id="使用find命令找出-boot目录下所有目录文件，然后统计目录的个数"><a href="#使用find命令找出-boot目录下所有目录文件，然后统计目录的个数" class="headerlink" title="使用find命令找出/boot目录下所有目录文件，然后统计目录的个数"></a>使用find命令找出/boot目录下所有目录文件，然后统计目录的个数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@MR home]<span class="comment"># find /boot -type d | wc -l</span></span><br><span class="line">7</span><br></pre></td></tr></table></figure>

<h3 id="查找系统中小于10M的文件并打印显示"><a href="#查找系统中小于10M的文件并打印显示" class="headerlink" title="查找系统中小于10M的文件并打印显示"></a>查找系统中小于10M的文件并打印显示</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@MR home]<span class="comment"># find -size -10M -print</span></span><br><span class="line">.</span><br><span class="line">./user1</span><br><span class="line">./user1/.bash_logout</span><br><span class="line">./user1/.bash_profile</span><br><span class="line">./user1/.bashrc</span><br></pre></td></tr></table></figure>

<h3 id="使用rpm命令列出vsftpd的所有doc-man文档"><a href="#使用rpm命令列出vsftpd的所有doc-man文档" class="headerlink" title="使用rpm命令列出vsftpd的所有doc/man文档"></a>使用rpm命令列出vsftpd的所有doc/man文档</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie /]<span class="comment"># rpm -qd vsftpd</span></span><br></pre></td></tr></table></figure>

<h3 id="手工创建用户user2-要求有家目录，完整的登陆提示符"><a href="#手工创建用户user2-要求有家目录，完整的登陆提示符" class="headerlink" title="手工创建用户user2 ,要求有家目录，完整的登陆提示符"></a>手工创建用户user2 ,要求有家目录，完整的登陆提示符</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@MR home]<span class="comment"># useradd user2 -d /home/user2</span></span><br></pre></td></tr></table></figure>

<h3 id="手工创建用户user9-要求没有家目录，不允许登录"><a href="#手工创建用户user9-要求没有家目录，不允许登录" class="headerlink" title="手工创建用户user9 ,要求没有家目录，不允许登录"></a>手工创建用户user9 ,要求没有家目录，不允许登录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@MR home]<span class="comment"># useradd user9 -M -s /sbin/nologin</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>验证以上两题</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@MR home]<span class="comment"># ls /home</span></span><br><span class="line">user1  user2</span><br><span class="line">[root@MR home]<span class="comment"># cat /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">.....(中间省略)</span><br><span class="line">user1:x:1000:1000::/home/user1:/bin/bash</span><br><span class="line">user2:x:1001:1001::/home/user2:/bin/bash</span><br><span class="line">user9:x:1002:1002::/home/user9:/sbin/nologin</span><br></pre></td></tr></table></figure>

<h3 id="修改user2的登陆shell为nologin-，并测试是否能登录"><a href="#修改user2的登陆shell为nologin-，并测试是否能登录" class="headerlink" title="修改user2的登陆shell为nologin ，并测试是否能登录"></a>修改user2的登陆shell为nologin ，并测试是否能登录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不可以登陆</span></span><br><span class="line">[root@MR home]<span class="comment"># vim /etc/passwd</span></span><br><span class="line">按<span class="string">'i'</span>切换到user2 修改/bin/bash为/sbin/nologin</span><br><span class="line">保存并退出</span><br><span class="line">[root@MR home]<span class="comment"># su user2</span></span><br><span class="line">This account is currently not available.</span><br></pre></td></tr></table></figure>

<h3 id="查看根分区大小，并取出根分区使用率赋值给root-disk变量。例如：root-disk-55-（55-是根分区使用率）"><a href="#查看根分区大小，并取出根分区使用率赋值给root-disk变量。例如：root-disk-55-（55-是根分区使用率）" class="headerlink" title="查看根分区大小，并取出根分区使用率赋值给root_disk变量。例如：root_disk=55%（55%是根分区使用率）"></a>查看根分区大小，并取出根分区使用率赋值给root_disk变量。例如：root_disk=55%（55%是根分区使用率）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># df | grep /$ | awk '&#123;print $5&#125;'</span></span><br></pre></td></tr></table></figure>

<h3 id="查看-etc-passwd-的6-9行内容"><a href="#查看-etc-passwd-的6-9行内容" class="headerlink" title="查看/etc/passwd 的6-9行内容"></a>查看/etc/passwd 的6-9行内容</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># sed -n '6,9p' /etc/passwd</span></span><br></pre></td></tr></table></figure>

<h3 id="以树状的形式显示-etc-security-目录，提交命令和结果"><a href="#以树状的形式显示-etc-security-目录，提交命令和结果" class="headerlink" title="以树状的形式显示/etc/security/目录，提交命令和结果"></a>以树状的形式显示/etc/security/目录，提交命令和结果</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@MR home]<span class="comment"># yum -y install tree</span></span><br><span class="line">[root@MR home]<span class="comment"># tree /etc/security/</span></span><br><span class="line">/etc/security/</span><br><span class="line">├── access.conf</span><br><span class="line">├── chroot.conf</span><br><span class="line">├── console.apps</span><br><span class="line">│   ├── config-util</span><br><span class="line">│   ├── rhn_register</span><br><span class="line">│   └── subscription-manager</span><br><span class="line">├── console.handlers</span><br><span class="line">├── console.perms</span><br><span class="line">├── console.perms.d</span><br><span class="line">├── group.conf</span><br><span class="line">├── limits.conf</span><br><span class="line">├── limits.d</span><br><span class="line">│   └── 20-nproc.conf</span><br><span class="line">├── namespace.conf</span><br><span class="line">├── namespace.d</span><br><span class="line">├── namespace.init</span><br><span class="line">├── opasswd</span><br><span class="line">├── pam_env.conf</span><br><span class="line">├── pwquality.conf</span><br><span class="line">├── sepermit.conf</span><br><span class="line">└── time.conf</span><br><span class="line"></span><br><span class="line">4 directories, 17 files</span><br></pre></td></tr></table></figure>

<h3 id="给网卡添加一个临时ip-172-16-12-22-24"><a href="#给网卡添加一个临时ip-172-16-12-22-24" class="headerlink" title="给网卡添加一个临时ip 172.16.12.22/24"></a>给网卡添加一个临时ip 172.16.12.22/24</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">图形界面右上角--网卡设置--添加网卡</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">ifconfig ens33:5 172.16.12.22 netmask 255.255.255.0</span><br></pre></td></tr></table></figure>

<h3 id="切换到tty2虚拟终端，并查看当前终端是哪个终端"><a href="#切换到tty2虚拟终端，并查看当前终端是哪个终端" class="headerlink" title="切换到tty2虚拟终端，并查看当前终端是哪个终端"></a>切换到tty2虚拟终端，并查看当前终端是哪个终端</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># who</span></span><br><span class="line">root      pts/0        2019-03-08 14:54 (192.168.233.1)</span><br><span class="line">root     pts/1        2019-03-08 16:40 (192.168.233.1)</span><br></pre></td></tr></table></figure>

<h3 id="怎样找出fdisk命令的绝对路径"><a href="#怎样找出fdisk命令的绝对路径" class="headerlink" title="怎样找出fdisk命令的绝对路径"></a>怎样找出fdisk命令的绝对路径</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># which fdisk</span></span><br><span class="line">/usr/sbin/fdisk</span><br></pre></td></tr></table></figure>

<h3 id="通过命令行重启系统有哪些方法"><a href="#通过命令行重启系统有哪些方法" class="headerlink" title="通过命令行重启系统有哪些方法"></a>通过命令行重启系统有哪些方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure>

<h3 id="如何在命令行中快速删除光标前的内容？"><a href="#如何在命令行中快速删除光标前的内容？" class="headerlink" title="如何在命令行中快速删除光标前的内容？"></a>如何在命令行中快速删除光标前的内容？</h3><p>ctrl+U</p>
<h3 id="如何在命令行中快速删除光标后的内容？"><a href="#如何在命令行中快速删除光标后的内容？" class="headerlink" title="如何在命令行中快速删除光标后的内容？"></a>如何在命令行中快速删除光标后的内容？</h3><p>ctrl+K</p>
<h3 id="拷贝-etc-passwd文件到本地，并且设置其权限为属主有读写执行权限，属组有读写权限，其他帐户没有权限"><a href="#拷贝-etc-passwd文件到本地，并且设置其权限为属主有读写执行权限，属组有读写权限，其他帐户没有权限" class="headerlink" title="拷贝/etc/passwd文件到本地，并且设置其权限为属主有读写执行权限，属组有读写权限，其他帐户没有权限"></a>拷贝/etc/passwd文件到本地，并且设置其权限为属主有读写执行权限，属组有读写权限，其他帐户没有权限</h3><blockquote>
<p>cp /etc/passwd .</p>
<p>chmod 760 passwd</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># cp /etc/passwd .</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># chmod 760 passwd</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># ls -l</span></span><br><span class="line">total 11</span><br><span class="line">-rwxrw---- 1 root root 956 Apr  6 23:30 passwd</span><br></pre></td></tr></table></figure>

<h3 id="删除-tmp下所有s开头的文件"><a href="#删除-tmp下所有s开头的文件" class="headerlink" title="删除/tmp下所有s开头的文件"></a>删除/tmp下所有s开头的文件</h3><blockquote>
<p>rm -rf  /tmp/s*</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># ls /tmp</span></span><br><span class="line">Aegis-&lt;Guid(5A2C30A2-A87D-490A-9281-6765EDAD7CBA)&gt;  s123</span><br><span class="line">CmsGoAgent.pid                                      ssfasf</span><br><span class="line">[root@zhoulijie ~]<span class="comment"># rm -rf /tmp/s*</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># ls /tmp</span></span><br><span class="line">Aegis-&lt;Guid(5A2C30A2-A87D-490A-9281-6765EDAD7CBA)&gt;  CmsGoAgent.pid</span><br></pre></td></tr></table></figure>

<h3 id="把-etc目录复制到-tmp下并保持原属性不变"><a href="#把-etc目录复制到-tmp下并保持原属性不变" class="headerlink" title="把/etc目录复制到/tmp下并保持原属性不变"></a>把/etc目录复制到/tmp下并保持原属性不变</h3><blockquote>
<p>cp -r -p /etc /tmp/</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[tom@zhoulijie /]$ cp -r -p /etc /tmp/</span><br><span class="line">[tom@zhoulijie /]$ ls /tmp</span><br><span class="line">Aegis-&lt;Guid(5A2C30A2-A87D-490A-9281-6765EDAD7CBA)&gt;  CmsGoAgent.pid  etc</span><br></pre></td></tr></table></figure>

<h3 id="把-tmp-etc-man-db-conf移动到-tmp下并改名为test-conf且设置所有人都有读写执行权限"><a href="#把-tmp-etc-man-db-conf移动到-tmp下并改名为test-conf且设置所有人都有读写执行权限" class="headerlink" title="把/tmp/etc/man_db.conf移动到/tmp下并改名为test.conf且设置所有人都有读写执行权限"></a>把/tmp/etc/man_db.conf移动到/tmp下并改名为test.conf且设置所有人都有读写执行权限</h3><blockquote>
<p>mv /tmp/etc/man_db.conf /tmp/ test.conf</p>
<p>chmod 777 test.conf</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@MR /]<span class="comment"># mv /tmp/etc/man_db.conf /tmp/test.conf</span></span><br><span class="line">[root@MR tmp]<span class="comment"># chmod 777 test.conf</span></span><br><span class="line">[root@MR tmp]<span class="comment"># ls -l test.conf</span></span><br><span class="line">-rwxrwxrwx. 1 root root 5171 3月  18 2014 test.conf</span><br></pre></td></tr></table></figure>

<h3 id="创建用户tom、创建组jerry，修改-tmp-test-conf的属主为tom-属组为jerry"><a href="#创建用户tom、创建组jerry，修改-tmp-test-conf的属主为tom-属组为jerry" class="headerlink" title="创建用户tom、创建组jerry，修改/tmp/test.conf的属主为tom,属组为jerry"></a>创建用户tom、创建组jerry，修改/tmp/test.conf的属主为tom,属组为jerry</h3><blockquote>
<p>useradd tom</p>
<p>groupadd jerry</p>
<p>chown -R tom:jerry /tmp/test.conf</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># useradd tom</span></span><br><span class="line">[root@MR ~]<span class="comment"># groupadd jerry</span></span><br><span class="line">[root@MR ~]<span class="comment"># chown -R tom:jerry /tmp/test.conf</span></span><br><span class="line">[root@MR ~]<span class="comment"># ls -l /tmp/test.conf</span></span><br><span class="line">-rwxrwxrwx. 1 tom jerry 5171 3月  18 2014 /tmp/test.conf</span><br></pre></td></tr></table></figure>

<h3 id="删除用户tom和组jerry"><a href="#删除用户tom和组jerry" class="headerlink" title="删除用户tom和组jerry"></a>删除用户tom和组jerry</h3><blockquote>
<p>userdel -r tom</p>
<p>groupdel jerry</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># userdel -r tom</span></span><br><span class="line">[root@MR ~]<span class="comment"># groupdel jerry</span></span><br></pre></td></tr></table></figure>

<h3 id="使用find命令找出当前系统中没有属主或属组的所有文件并打印显示"><a href="#使用find命令找出当前系统中没有属主或属组的所有文件并打印显示" class="headerlink" title="使用find命令找出当前系统中没有属主或属组的所有文件并打印显示"></a>使用find命令找出当前系统中没有属主或属组的所有文件并打印显示</h3><blockquote>
<p>find  -nouser -nogroup</p>
<p> -nouser 查找没有属主的文件</p>
<p>-nogroup 查找没有属组的文件</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie /]<span class="comment"># find  -nouser -nogroup</span></span><br><span class="line">find: ‘./proc/2673/task/2673/fd/6’: 没有那个文件或目录</span><br><span class="line">find: ‘./proc/2673/task/2673/fdinfo/6’: 没有那个文件或目录</span><br><span class="line">find: ‘./proc/2673/fd/6’: 没有那个文件或目录</span><br><span class="line">find: ‘./proc/2673/fdinfo/6’: 没有那个文件或目录</span><br><span class="line">./tmp/test.conf</span><br><span class="line">./home/wangqing</span><br><span class="line">./home/wangqing/.bash_logout</span><br><span class="line">./home/wangqing/.bash_profile</span><br><span class="line">./home/wangqing/.bashrc</span><br></pre></td></tr></table></figure>

<h3 id="统计当前系统中一共有多少帐户"><a href="#统计当前系统中一共有多少帐户" class="headerlink" title="统计当前系统中一共有多少帐户"></a>统计当前系统中一共有多少帐户</h3><blockquote>
<p>wc -l /etc/passwd</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie /]<span class="comment"># wc -l /etc/passwd</span></span><br><span class="line">24 /etc/passwd</span><br></pre></td></tr></table></figure>

<h3 id="查看-etc-passwd的前3行和尾3行内容"><a href="#查看-etc-passwd的前3行和尾3行内容" class="headerlink" title="查看/etc/passwd的前3行和尾3行内容"></a>查看/etc/passwd的前3行和尾3行内容</h3><blockquote>
<p>head -n 3 /etc/passwd</p>
<p>tail -n 3 /etc/passwd</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie /]<span class="comment"># head -n 3 /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">[root@zhoulijie /]<span class="comment"># tail -n 3 /etc/passwd</span></span><br><span class="line">wangqing:x:1004:7780:wu liang tian zun:/home/wangqing:/bin/csh</span><br><span class="line">openstack:x:1005:1005::/home/openstack:/bin/bash</span><br><span class="line">runtime:x:1006:1006::/home/runtime:/bin/bash</span><br></pre></td></tr></table></figure>

<h3 id="查看-etc-passwd的第10行内容"><a href="#查看-etc-passwd的第10行内容" class="headerlink" title="查看/etc/passwd的第10行内容"></a>查看/etc/passwd的第10行内容</h3><blockquote>
<p>awk “NR==10” /etc/passwd</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie /]<span class="comment"># awk "NR==10" /etc/passwd</span></span><br><span class="line">operator:x:11:0:operator:/root:/sbin/nologin</span><br></pre></td></tr></table></figure>

<h3 id="一条命令创建test-1-2-3-4-5目录"><a href="#一条命令创建test-1-2-3-4-5目录" class="headerlink" title="一条命令创建test/1/2/3/4/5目录"></a>一条命令创建test/1/2/3/4/5目录</h3><blockquote>
<p>mkdir -p test/1/2/3/4/5</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># mkdir -p test/1/2/3/4/5</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># tree test/</span></span><br><span class="line"><span class="built_in">test</span>/</span><br><span class="line">└── 1</span><br><span class="line">    └── 2</span><br><span class="line">        └── 3</span><br><span class="line">            └── 4</span><br><span class="line">                └── 5</span><br><span class="line"></span><br><span class="line">5 directories, 0 files</span><br></pre></td></tr></table></figure>

<h3 id="如何快速回到当前登录用户的家目录"><a href="#如何快速回到当前登录用户的家目录" class="headerlink" title="如何快速回到当前登录用户的家目录"></a>如何快速回到当前登录用户的家目录</h3><blockquote>
<p>cd</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie tmp]<span class="comment"># cd</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># pwd</span></span><br><span class="line">/root</span><br></pre></td></tr></table></figure>

<h3 id="如何只查看-etc单个目录的信息并以长格式显示"><a href="#如何只查看-etc单个目录的信息并以长格式显示" class="headerlink" title="如何只查看/etc单个目录的信息并以长格式显示"></a>如何只查看/etc单个目录的信息并以长格式显示</h3><blockquote>
<p>ll -d /etc</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie /]<span class="comment"># ll -d /etc</span></span><br><span class="line">drwxr-xr-x. 76 root root 8192 4月   7 23:35 /etc</span><br></pre></td></tr></table></figure>

<h3 id="查看-etc-所占的磁盘空间"><a href="#查看-etc-所占的磁盘空间" class="headerlink" title="查看/etc/所占的磁盘空间"></a>查看/etc/所占的磁盘空间</h3><blockquote>
<p>du -sh /etc</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie /]<span class="comment"># du -sh /etc</span></span><br><span class="line">20M     /etc</span><br></pre></td></tr></table></figure>

<h3 id="结合ls与grep命令打印出-tmp-etc目录下的所有目录文件"><a href="#结合ls与grep命令打印出-tmp-etc目录下的所有目录文件" class="headerlink" title="结合ls与grep命令打印出/tmp/etc目录下的所有目录文件"></a>结合ls与grep命令打印出/tmp/etc目录下的所有目录文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># ls -l /tmp/etc |grep  ^d</span></span><br></pre></td></tr></table></figure>

<h3 id="删除-tmp下所有的文件"><a href="#删除-tmp下所有的文件" class="headerlink" title="删除/tmp下所有的文件"></a>删除/tmp下所有的文件</h3><blockquote>
<p>rm -rf /tmp/*</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie /]<span class="comment"># rm -rf /tmp/*</span></span><br><span class="line">[root@zhoulijie /]<span class="comment"># ls /tmp</span></span><br><span class="line">[root@zhoulijie /]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="临时设置系统主机名并重启验证"><a href="#临时设置系统主机名并重启验证" class="headerlink" title="临时设置系统主机名并重启验证"></a>临时设置系统主机名并重启验证</h3><blockquote>
<p>hostname 123</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># hostname 123</span></span><br><span class="line">[root@MR ~]<span class="comment"># bash</span></span><br><span class="line">[root@123 ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="永久设置系统主机名并重启验证"><a href="#永久设置系统主机名并重启验证" class="headerlink" title="永久设置系统主机名并重启验证"></a>永久设置系统主机名并重启验证</h3><blockquote>
<p>vim /etc/hostname</p>
<p>输入zhoulijie</p>
<p>保存并退出</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># vim /etc/hostname</span></span><br><span class="line">[root@MR ~]<span class="comment"># bash</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h3 id="将系统时间设置为2008-05-10-00-12-13并验证"><a href="#将系统时间设置为2008-05-10-00-12-13并验证" class="headerlink" title="将系统时间设置为2008-05-10 00:12:13并验证"></a>将系统时间设置为2008-05-10 00:12:13并验证</h3><blockquote>
<p>date -s “2008-05-10 00:12:13”</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># date -s "2008-05-10 00:12:13"</span></span><br><span class="line">2008年 05月 10日 星期六 00:12:13 CST</span><br><span class="line">[root@MR ~]<span class="comment"># date</span></span><br><span class="line">2008年 05月 10日 星期六 00:12:44 CST</span><br></pre></td></tr></table></figure>

<h3 id="使用ntpdate同步互联网时间"><a href="#使用ntpdate同步互联网时间" class="headerlink" title="使用ntpdate同步互联网时间"></a>使用ntpdate同步互联网时间</h3><blockquote>
<p>ntpdate time1.aliyun.com</p>
<p>如果没有就使用yum安装</p>
<p>yum install ntpdate -y</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment">#ntpdate time1.aliyun.com</span></span><br><span class="line">11 Apr 17:37:29 ntpdate[7400]: step time server 119.28.183.184 offset 199144.735638 sec</span><br><span class="line">[root@zhoulijie ~]<span class="comment"># date</span></span><br><span class="line">2019年 04月 11日 星期四 17:37:34 CST</span><br></pre></td></tr></table></figure>

<h3 id="统计出-etc-passwd文件有多少单词和字符"><a href="#统计出-etc-passwd文件有多少单词和字符" class="headerlink" title="统计出/etc/passwd文件有多少单词和字符"></a>统计出/etc/passwd文件有多少单词和字符</h3><blockquote>
<p>wc -w -c /etc/passwd</p>
<p>-w 只显示单词数</p>
<p>-c 只显示字节数</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@MR ~]<span class="comment"># wc -w -c /etc/passwd</span></span><br><span class="line">  37 1116 /etc/passwd</span><br></pre></td></tr></table></figure>

<h3 id="添加一个计划任务，在每周6凌晨1点35分备份-etc目录到-tmp目录下，要求备份的文件必须是打包好的，名字为etc-tar-xz"><a href="#添加一个计划任务，在每周6凌晨1点35分备份-etc目录到-tmp目录下，要求备份的文件必须是打包好的，名字为etc-tar-xz" class="headerlink" title="添加一个计划任务，在每周6凌晨1点35分备份/etc目录到/tmp目录下，要求备份的文件必须是打包好的，名字为etc.tar.xz"></a>添加一个计划任务，在每周6凌晨1点35分备份/etc目录到/tmp目录下，要求备份的文件必须是打包好的，名字为etc.tar.xz</h3><blockquote>
<p>crontab -e  编辑计划任务</p>
<p>crontab -l    查看计划任务</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lzy tmp]<span class="comment"># crontab -e</span></span><br><span class="line">no crontab <span class="keyword">for</span> root - using an empty one</span><br><span class="line">crontab: installing new crontab</span><br><span class="line">[root@lzy tmp]<span class="comment"># crontab -l</span></span><br><span class="line">35 1 * * 6  /usr/bin/tar -jcf etc.tar.xz /etc/* &amp;&amp; cp -r -p etc.tar.xz /tmp/</span><br></pre></td></tr></table></figure>

<h3 id="Linux如何挂载windows下的共享目录？"><a href="#Linux如何挂载windows下的共享目录？" class="headerlink" title="Linux如何挂载windows下的共享目录？"></a>Linux如何挂载windows下的共享目录？</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mount.cifs //IP地址/server /mnt/server -o user=administrator,password=123456</span><br><span class="line">linux 下的server需要自己手动建一个 后面的user与pass 是windows主机的账号和密码 注意空格 和逗号</span><br></pre></td></tr></table></figure>

<h3 id="统计linux中TCP各连接状态的数量？"><a href="#统计linux中TCP各连接状态的数量？" class="headerlink" title="统计linux中TCP各连接状态的数量？"></a>统计linux中TCP各连接状态的数量？</h3><h3 id="请简述符号链接与硬链接的区别？"><a href="#请简述符号链接与硬链接的区别？" class="headerlink" title="请简述符号链接与硬链接的区别？"></a>请简述符号链接与硬链接的区别？</h3><h3 id="如何在文本里面进行复制、粘贴，删除行，删除全部，按行查找和按字母查找？"><a href="#如何在文本里面进行复制、粘贴，删除行，删除全部，按行查找和按字母查找？" class="headerlink" title="如何在文本里面进行复制、粘贴，删除行，删除全部，按行查找和按字母查找？"></a>如何在文本里面进行复制、粘贴，删除行，删除全部，按行查找和按字母查找？</h3><h3 id="请简述ftp的主动模式与被动模式工作过程"><a href="#请简述ftp的主动模式与被动模式工作过程" class="headerlink" title="请简述ftp的主动模式与被动模式工作过程"></a>请简述ftp的主动模式与被动模式工作过程</h3><h3 id="如何过滤出-runtime中的所有一级目录-不包含子目录，即只能是一级目录"><a href="#如何过滤出-runtime中的所有一级目录-不包含子目录，即只能是一级目录" class="headerlink" title="如何过滤出/runtime中的所有一级目录(不包含子目录，即只能是一级目录)"></a>如何过滤出/runtime中的所有一级目录(不包含子目录，即只能是一级目录)</h3><h3 id="如何查看-etc-目录下最近更新的5个文件？"><a href="#如何查看-etc-目录下最近更新的5个文件？" class="headerlink" title="如何查看/etc/目录下最近更新的5个文件？"></a>如何查看/etc/目录下最近更新的5个文件？</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@MR etc]<span class="comment"># ls -lt | head -n 6</span></span><br><span class="line">总用量 1108</span><br><span class="line">----------.  1 root root    361 3月   8 19:55 gshadow</span><br><span class="line">-rw-r--r--.  1 root root    455 3月   8 19:55 group</span><br><span class="line">----------.  1 root root    608 3月   8 19:55 shadow</span><br><span class="line">-rw-r--r--.  1 root root    922 3月   8 19:55 passwd</span><br><span class="line">-rw-r--r--.  1 root root    469 3月   8 19:55 group-</span><br></pre></td></tr></table></figure>

<h3 id="已知apache服务的访问日志按天记录在服务器本地目录-app-logs下，由于磁盘空间紧张，现在要求只能保留最近7天访问日志！请问如何解决？"><a href="#已知apache服务的访问日志按天记录在服务器本地目录-app-logs下，由于磁盘空间紧张，现在要求只能保留最近7天访问日志！请问如何解决？" class="headerlink" title="已知apache服务的访问日志按天记录在服务器本地目录/app/logs下，由于磁盘空间紧张，现在要求只能保留最近7天访问日志！请问如何解决？"></a>已知apache服务的访问日志按天记录在服务器本地目录/app/logs下，由于磁盘空间紧张，现在要求只能保留最近7天访问日志！请问如何解决？</h3><h3 id="如何打印配置文件nginx-conf的行号及内容？"><a href="#如何打印配置文件nginx-conf的行号及内容？" class="headerlink" title="如何打印配置文件nginx.conf的行号及内容？"></a>如何打印配置文件nginx.conf的行号及内容？</h3><h3 id="调试系统服务时，希望能实时查看系统日志-var-log-messages的更新，如何做？"><a href="#调试系统服务时，希望能实时查看系统日志-var-log-messages的更新，如何做？" class="headerlink" title="调试系统服务时，希望能实时查看系统日志/var/log/messages的更新，如何做？"></a>调试系统服务时，希望能实时查看系统日志/var/log/messages的更新，如何做？</h3><h3 id="如何查看-etc-services文件有多少行？"><a href="#如何查看-etc-services文件有多少行？" class="headerlink" title="如何查看/etc/services文件有多少行？"></a>如何查看/etc/services文件有多少行？</h3><h3 id="分别使用ifconfig和ip命令取出当前主机的ip地址"><a href="#分别使用ifconfig和ip命令取出当前主机的ip地址" class="headerlink" title="分别使用ifconfig和ip命令取出当前主机的ip地址"></a>分别使用ifconfig和ip命令取出当前主机的ip地址</h3><h3 id="如何将-etc-fstab中的权限取出来，以数字644这样的形式打印"><a href="#如何将-etc-fstab中的权限取出来，以数字644这样的形式打印" class="headerlink" title="如何将/etc/fstab中的权限取出来，以数字644这样的形式打印"></a>如何将/etc/fstab中的权限取出来，以数字644这样的形式打印</h3><h3 id="打印出-etc-fstab文件中除掉空行和注释的内容"><a href="#打印出-etc-fstab文件中除掉空行和注释的内容" class="headerlink" title="打印出/etc/fstab文件中除掉空行和注释的内容"></a>打印出/etc/fstab文件中除掉空行和注释的内容</h3><h3 id="用date命令打印3天前的日期，如：2018-10-10"><a href="#用date命令打印3天前的日期，如：2018-10-10" class="headerlink" title="用date命令打印3天前的日期，如：2018-10-10"></a>用date命令打印3天前的日期，如：2018-10-10</h3><h3 id="将目录-etc-a下除了b文件外的所有文件压缩打包放到-tmp-a下，名字为a-gz"><a href="#将目录-etc-a下除了b文件外的所有文件压缩打包放到-tmp-a下，名字为a-gz" class="headerlink" title="将目录/etc/a下除了b文件外的所有文件压缩打包放到/tmp/a下，名字为a.gz"></a>将目录/etc/a下除了b文件外的所有文件压缩打包放到/tmp/a下，名字为a.gz</h3><h3 id="什么是umask？umask-022代表什么意思？"><a href="#什么是umask？umask-022代表什么意思？" class="headerlink" title="什么是umask？umask=022代表什么意思？"></a>什么是umask？umask=022代表什么意思？</h3><h3 id="ftp、http、https、smtp、pop3、ssh、dns的端口号"><a href="#ftp、http、https、smtp、pop3、ssh、dns的端口号" class="headerlink" title="ftp、http、https、smtp、pop3、ssh、dns的端口号"></a>ftp、http、https、smtp、pop3、ssh、dns的端口号</h3><h3 id="如何在不停止进程的情况下清空日志-var-log-a-log？"><a href="#如何在不停止进程的情况下清空日志-var-log-a-log？" class="headerlink" title="如何在不停止进程的情况下清空日志/var/log/a.log？"></a>如何在不停止进程的情况下清空日志/var/log/a.log？</h3><h3 id="如何在-usr目录下找出大小超过10MB的文件？"><a href="#如何在-usr目录下找出大小超过10MB的文件？" class="headerlink" title="如何在/usr目录下找出大小超过10MB的文件？"></a>如何在/usr目录下找出大小超过10MB的文件？</h3><h3 id="如何在-var目录下找出90天之内未被访问过的文件？"><a href="#如何在-var目录下找出90天之内未被访问过的文件？" class="headerlink" title="如何在/var目录下找出90天之内未被访问过的文件？"></a>如何在/var目录下找出90天之内未被访问过的文件？</h3><h3 id="ll-awk-‘-print-3-”owns”-9-’-这条命令是在做什么？"><a href="#ll-awk-‘-print-3-”owns”-9-’-这条命令是在做什么？" class="headerlink" title="ll | awk ‘{print (3,”owns”,)9}’ 这条命令是在做什么？"></a>ll | awk ‘{print (3,”owns”,)9}’ 这条命令是在做什么？</h3><h3 id="给你50台Linux系统如何安装呢？如何实现，步骤是什么？"><a href="#给你50台Linux系统如何安装呢？如何实现，步骤是什么？" class="headerlink" title="给你50台Linux系统如何安装呢？如何实现，步骤是什么？"></a>给你50台Linux系统如何安装呢？如何实现，步骤是什么？</h3><h3 id="用虚拟机安装了一台Linux系统，突然想克隆一台服务器，克隆后发现无法上网，如何解决？"><a href="#用虚拟机安装了一台Linux系统，突然想克隆一台服务器，克隆后发现无法上网，如何解决？" class="headerlink" title="用虚拟机安装了一台Linux系统，突然想克隆一台服务器，克隆后发现无法上网，如何解决？"></a>用虚拟机安装了一台Linux系统，突然想克隆一台服务器，克隆后发现无法上网，如何解决？</h3><h3 id="Linux网卡配置文件路径是什么？要使服务器上外网，必须满足的条件有哪些？需要配置什么？"><a href="#Linux网卡配置文件路径是什么？要使服务器上外网，必须满足的条件有哪些？需要配置什么？" class="headerlink" title="Linux网卡配置文件路径是什么？要使服务器上外网，必须满足的条件有哪些？需要配置什么？"></a>Linux网卡配置文件路径是什么？要使服务器上外网，必须满足的条件有哪些？需要配置什么？</h3><h3 id="查找当前目录下30天以前-log结尾的大于1G的文件，并把它移动到-tmp下"><a href="#查找当前目录下30天以前-log结尾的大于1G的文件，并把它移动到-tmp下" class="headerlink" title="查找当前目录下30天以前.log结尾的大于1G的文件，并把它移动到/tmp下"></a>查找当前目录下30天以前.log结尾的大于1G的文件，并把它移动到/tmp下</h3><h3 id="查看某个端口是否已经启动，以及查看端口做占用的PID进程号"><a href="#查看某个端口是否已经启动，以及查看端口做占用的PID进程号" class="headerlink" title="查看某个端口是否已经启动，以及查看端口做占用的PID进程号"></a>查看某个端口是否已经启动，以及查看端口做占用的PID进程号</h3>
      
      <!-- 打赏 -->
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chineselijie/2019/08/29/15.linux--linux基础练习/" data-id="ck7ooyaf500134su6q8f3x5st"
        class="article-share-link">分享</a>
        
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux基础/">linux基础</a></li></ul>

    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-14.linux--LVM磁盘管理" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2019/08/29/14.linux--LVM磁盘管理/"
    >LVM磁盘管理</a
  >
</h2>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2019/08/29/14.linux--LVM磁盘管理/" class="article-date">
  <time datetime="2019-08-29T15:44:18.595Z" itemprop="datePublished">2019-08-29</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux基础/">linux基础</a>
  </div>

      
      
      
    </div>
    

    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <blockquote>
<p><strong>关于作者</strong></p>
<p><strong>周李杰</strong>，最后一批90后，现居<strong>湖北武汉</strong></p>
<p>孤独患者，懒癌中期，无脑幻想者。但却人畜无害，无需远离。</p>
<p>兴趣众多，然无一精通。正努力成为一个有趣的人。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; print(&quot;👆以上是不完整的我&quot;) //请我吃大餐将会了解更多</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>[TOC]</p>
<h2 id="lvm的应用场景及其弊端"><a href="#lvm的应用场景及其弊端" class="headerlink" title="lvm的应用场景及其弊端"></a>lvm的应用场景及其弊端</h2><p>应用场景：<br>随着公司的发展，数据增长较快，最初规划的磁盘容量不够用了</p>
<p>弊端：<br>数据不是直接存放在硬盘上，而是在硬盘的上面又虚拟出来一层逻辑卷存放数据，故而增加了磁盘数据恢复的难度</p>
<h2 id="物理卷、卷组、逻辑卷"><a href="#物理卷、卷组、逻辑卷" class="headerlink" title="物理卷、卷组、逻辑卷"></a>物理卷、卷组、逻辑卷</h2><p><img src="https://s2.ax1x.com/2019/04/30/EGTBAs.jpg" alt></p>
<p>物理卷(pv)：把常规的块设备（硬盘，分区等可以读写数据的设备）通过pvcreate命令对其进行初始化，就成了物理卷</p>
<p>卷组(VG)：把多个物理卷的容量组成一个逻辑整体，可以从里面灵活分配容量</p>
<p>逻辑卷(LV)：从卷组中划分部分空间成为一个可以读写数据的逻辑单元。需要对其格式化然后挂载使用</p>
<h2 id="lvm管理"><a href="#lvm管理" class="headerlink" title="lvm管理"></a>lvm管理</h2><h4 id="部署lvm"><a href="#部署lvm" class="headerlink" title="部署lvm"></a>部署lvm</h4><blockquote>
<p> LVM部署有装系统前部署以及装系统后部署，此处仅介绍装系统后部署。</p>
</blockquote>
<p>创建lvm步骤：</p>
<ul>
<li><p>首先添加物理磁盘</p>
</li>
<li><p>然后创建卷组，将物理卷加入到卷组</p>
</li>
<li><p>然后在卷组中划分逻辑分区</p>
</li>
<li><p>其次执行格式化逻辑卷</p>
</li>
<li><p>最后挂载使用</p>
</li>
</ul>
<h6 id="准备物理磁盘"><a href="#准备物理磁盘" class="headerlink" title="准备物理磁盘"></a>准备物理磁盘</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># lsblk | grep sd[bcd]</span></span><br><span class="line">sdb             8:16   0   20G  0 disk</span><br><span class="line">sdc             8:32   0   20G  0 disk</span><br><span class="line">sdd             8:48   0   20G  0 disk</span><br></pre></td></tr></table></figure>

<h6 id="将磁盘加入pv"><a href="#将磁盘加入pv" class="headerlink" title="将磁盘加入pv"></a>将磁盘加入pv</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># pvcreate /dev/sdb</span></span><br><span class="line">  Physical volume <span class="string">"/dev/sdb"</span> successfully created.</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查pv创建情况</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># pvs</span></span><br><span class="line">  PV         VG   Fmt  Attr PSize   PFree</span><br><span class="line">  /dev/sda2  rhel lvm2 a--  &lt;19.00g     0</span><br><span class="line">  /dev/sdb        lvm2 ---   20.00g 20.00g</span><br></pre></td></tr></table></figure>

<h6 id="创建名为zhou的卷组"><a href="#创建名为zhou的卷组" class="headerlink" title="创建名为zhou的卷组"></a>创建名为zhou的卷组</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># vgcreate zhou /dev/sdb</span></span><br><span class="line">  Volume group <span class="string">"zhou"</span> successfully created</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查卷组</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># vgs</span></span><br><span class="line">  VG   <span class="comment">#PV #LV #SN Attr   VSize   VFree</span></span><br><span class="line">  rhel   1   2   0 wz--n- &lt;19.00g      0</span><br><span class="line">  zhou   1   0   0 wz--n- &lt;20.00g &lt;20.00g</span><br></pre></td></tr></table></figure>

<h6 id="创建逻辑卷-分配名称-以及大小-指定卷组"><a href="#创建逻辑卷-分配名称-以及大小-指定卷组" class="headerlink" title="创建逻辑卷,分配名称, 以及大小, 指定卷组"></a>创建逻辑卷,分配名称, 以及大小, 指定卷组</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># lvcreate -L 100M -n lv1 zhou </span></span><br><span class="line">  Logical volume <span class="string">"lv1"</span> created.</span><br><span class="line">  </span><br><span class="line"><span class="comment">#检查逻辑卷</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># lvscan</span></span><br><span class="line">  ACTIVE            <span class="string">'/dev/rhel/swap'</span> [2.00 GiB] inherit</span><br><span class="line">  ACTIVE            <span class="string">'/dev/rhel/root'</span> [&lt;17.00 GiB] inherit</span><br><span class="line">  ACTIVE            <span class="string">'/dev/zhou/lv1'</span> [100.00 MiB] inherit</span><br></pre></td></tr></table></figure>

<h6 id="格式化文件系统"><a href="#格式化文件系统" class="headerlink" title="格式化文件系统"></a>格式化文件系统</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># mkfs.xfs /dev/zhou/lv1</span></span><br></pre></td></tr></table></figure>

<h6 id="挂载使用"><a href="#挂载使用" class="headerlink" title="挂载使用"></a>挂载使用</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># mkdir /opt/lv1</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># mount /dev/zhou/lv1 /opt/lv1/</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># df -Th</span></span><br><span class="line">文件系统              类型      容量  已用  可用 已用% 挂载点</span><br><span class="line">/dev/mapper/rhel-root xfs        17G  3.2G   14G   19% /</span><br><span class="line">devtmpfs              devtmpfs  977M     0  977M    0% /dev</span><br><span class="line">tmpfs                 tmpfs     993M     0  993M    0% /dev/shm</span><br><span class="line">tmpfs                 tmpfs     993M  9.1M  984M    1% /run</span><br><span class="line">tmpfs                 tmpfs     993M     0  993M    0% /sys/fs/cgroup</span><br><span class="line">/dev/sr0              iso9660   3.8G  3.8G     0  100% /mnt/cdrom</span><br><span class="line">/dev/sda1             xfs      1014M  161M  854M   16% /boot</span><br><span class="line">tmpfs                 tmpfs     199M   12K  199M    1% /run/user/42</span><br><span class="line">tmpfs                 tmpfs     199M     0  199M    0% /run/user/0</span><br><span class="line">/dev/mapper/zhou-lv1  xfs        97M  5.2M   92M    6% /opt/lv1</span><br></pre></td></tr></table></figure>

<p>在这里我们总结一下lvm部署步骤：</p>
<p>1.添加硬盘</p>
<p>2.初始化硬盘成物理卷</p>
<p>pvcreate /dev/sd{b,c,d}</p>
<p>3.创建卷组</p>
<p>vgcreate VG_NAME /dev/sd{b,c,d}</p>
<p>4.创建逻辑卷</p>
<p>lvcreate -L SIZE -n LV_NAME VG_NAME</p>
<p>5.格式化逻辑卷</p>
<p>mkfs.ext4 /dev/VG_NAME/LV_NAME</p>
<p>6.挂载</p>
<p>blkid</p>
<p>vim /etc/fstab</p>
<p>UUID=” “ /挂载点 文件系统类型 挂载参数 0 0</p>
<ul>
<li><p>永久挂载注意事项：</p>
<ul>
<li><p>修改配置文件/etc/fstab的挂载参数后不会立即生效，必须卸载并重新挂载或者重启系统才能生效</p>
</li>
<li><p>若想使之立即生效并不重启系统，可使用以下方式进行重新挂载</p>
<p>mount -o remount，rw 挂载点</p>
</li>
</ul>
</li>
</ul>
<p>7.重读配置文件</p>
<p>mount -a </p>
<h4 id="卷组管理"><a href="#卷组管理" class="headerlink" title="卷组管理"></a>卷组管理</h4><ul>
<li>扩展卷组，将新磁盘加如到卷组中</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新硬盘加入pv</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># pvcreate /dev/sdc</span></span><br><span class="line">  Physical volume <span class="string">"/dev/sdc"</span> successfully created.</span><br><span class="line"></span><br><span class="line">使用vgextend扩展</span><br><span class="line">[root@zhoulijie ~]<span class="comment"># vgextend zhou /dev/sdc</span></span><br><span class="line">  Volume group <span class="string">"zhou"</span> successfully extended</span><br></pre></td></tr></table></figure>

<ul>
<li>缩减卷组，将指定磁盘从卷组中删除</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># vgreduce zhou /dev/sdc</span></span><br><span class="line">  Removed <span class="string">"/dev/sdc"</span> from volume group <span class="string">"zhou"</span></span><br></pre></td></tr></table></figure>

<ul>
<li>数据迁移卷组，同一卷组的磁盘才可以进行在线迁移</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查当前逻辑卷VG中pv使用情况</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># pvs</span></span><br><span class="line">  PV         VG   Fmt  Attr PSize   PFree</span><br><span class="line">  /dev/sda2  rhel lvm2 a--  &lt;19.00g      0</span><br><span class="line">  /dev/sdb   zhou lvm2 a--  &lt;20.00g &lt;19.90g</span><br><span class="line">  /dev/sdc        lvm2 ---   20.00g  20.00g</span><br><span class="line"></span><br><span class="line"><span class="comment"># pvmove在线数据迁移至其他pv</span></span><br><span class="line">[root@localhost ~]<span class="comment"># pvmove /dev/sdb</span></span><br><span class="line">  /dev/sdb: Moved: 41.33%</span><br><span class="line">  /dev/sdb: Moved: 100.00%</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查是否将sdb数据迁移至sdc</span></span><br><span class="line">[root@localhost ~]<span class="comment"># pvs</span></span><br><span class="line">PV      VG   Fmt  Attr PSize PFree </span><br><span class="line">/dev/sdb vg1 lvm2 a -- 2.00g 2.00g </span><br><span class="line">/dev/sdc vg1 lvm2 a -- 2.00g 1.76g</span><br></pre></td></tr></table></figure>

<h4 id="逻辑卷管理"><a href="#逻辑卷管理" class="headerlink" title="逻辑卷管理"></a>逻辑卷管理</h4><ul>
<li>逻辑卷扩展，逻辑卷的扩展取决于卷组中的容量，逻辑卷扩展的容量不能超过卷组的容量</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># vgs</span></span><br><span class="line">  VG   <span class="comment">#PV #LV #SN Attr   VSize   VFree</span></span><br><span class="line">  rhel   1   2   0 wz--n- &lt;19.00g      0</span><br><span class="line">  zhou   1   1   0 wz--n- &lt;20.00g &lt;19.90g</span><br><span class="line"></span><br><span class="line">1.扩展lv逻辑卷</span><br><span class="line"><span class="comment"># 增加800M分配给逻辑卷 &#123;注意: 800M +800M 不一样&#125;</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># lvextend -L +800M /dev/zhou/lv1</span></span><br><span class="line">  Size of logical volume zhou/lv1 changed from 100.00 MiB (25 extents) to 900.00 MiB (225 extents).</span><br><span class="line">  Logical volume zhou/lv1 successfully resized.</span><br><span class="line"><span class="comment"># 分配磁盘池中多少百分比给逻辑卷</span></span><br><span class="line">[root@zhoulijie ~]<span class="comment"># lvextend -l +50%FREE /dev/zhou/lv1</span></span><br><span class="line">  Size of logical volume zhou/lv1 changed from 900.00 MiB (225 extents) to &lt;10.4   4 GiB (2672 extents).</span><br><span class="line">  Logical volume zhou/lv1 successfully resized.</span><br><span class="line">  </span><br><span class="line">2.扩展fs文件系统</span><br><span class="line"><span class="comment"># 在这里要看你是什么格式</span></span><br><span class="line">//xfs扩容</span><br><span class="line">[root@zhoulijie ~]<span class="comment"># xfs_growfs /dev/zhou/lv1</span></span><br><span class="line">meta-data=/dev/mapper/zhou-lv1   isize=512    agcount=4, agsize=6400 blks</span><br><span class="line">         =                       sectsz=512   attr=2, projid32bit=1</span><br><span class="line">         =                       crc=1        finobt=0 spinodes=0</span><br><span class="line">data     =                       bsize=4096   blocks=25600, imaxpct=25</span><br><span class="line">         =                       sunit=0      swidth=0 blks</span><br><span class="line">naming   =version 2              bsize=4096   ascii-ci=0 ftype=1</span><br><span class="line"><span class="built_in">log</span>      =internal               bsize=4096   blocks=855, version=2</span><br><span class="line">         =                       sectsz=512   sunit=0 blks, lazy-count=1</span><br><span class="line">realtime =none                   extsz=4096   blocks=0, rtextents=0</span><br><span class="line">data blocks changed from 25600 to 2736128</span><br><span class="line"></span><br><span class="line">//ext扩容</span><br><span class="line">[root@zhoulijie ~]<span class="comment"># resize2fs /dev/zhou/lv1</span></span><br></pre></td></tr></table></figure>

<ul>
<li>对<code>ext4</code>文件系统的逻辑卷裁剪容量</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首先自己创建一个1G的逻辑卷作为裁剪的对象</span></span><br><span class="line"> lvcreate  -n uplooking -L 1G finance</span><br><span class="line"> mkfs.ext4 /dev/finance/uplooking </span><br><span class="line"></span><br><span class="line"> mkdir -p /finance/uplooking</span><br><span class="line"> mount /dev/finance/uplooking  /finance/uplooking/</span><br><span class="line"> cp /etc/host* /finance/uplooking/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果已经挂载，就必须先卸载</span></span><br><span class="line">umount /dev/finance/uplooking</span><br><span class="line"></span><br><span class="line"><span class="comment"># 裁剪容量，必须是先检测文件系统</span></span><br><span class="line">e2fsck -f /dev/finance/uplooking</span><br><span class="line">resize2fs /dev/finance/uplooking 512M</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调整完毕后采取裁剪逻辑卷容量 </span></span><br><span class="line">lvreduce  -L 512M /dev/finance/uplooking </span><br><span class="line">WARNING: Reducing active logical volume to 512.00 MiB</span><br><span class="line">THIS MAY DESTROY YOUR DATA (filesystem etc.)</span><br><span class="line">Do you really want to reduce uplooking? [y/n]: y</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">建议：建议裁剪后，再次进行检测文件系统</span><br><span class="line"><span class="comment"># e2fsck -f /dev/finance/uplooking</span></span><br><span class="line"></span><br><span class="line">挂载测试：如果能够挂载，一般说明裁剪成功，文件系统没有被损坏</span><br><span class="line"><span class="comment"># mount /dev/finance/uplooking /mnt</span></span><br><span class="line">...</span><br><span class="line">/dev/mapper/finance-uplooking  472M  1.6M  435M    1% /mnt 而且文件系统容量被刷新了</span><br></pre></td></tr></table></figure>

<h5 id="缩减逻辑卷注意事项"><a href="#缩减逻辑卷注意事项" class="headerlink" title="缩减逻辑卷注意事项"></a>缩减逻辑卷注意事项</h5><p>1.不能在线缩减，得先卸载</p>
<p>2.确保缩减后的空间大小依然能存储原有数据</p>
<p>3.在缩减之前应该先检查文件，其确保文件系统处于一致性状态，使用命令：e2fsck -f /PATH/TO/LV</p>
<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><p>1.如何查看/etc/目录大小</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># du -sh /etc</span></span><br><span class="line">43M     /etc</span><br></pre></td></tr></table></figure>

<p>2.如何查看磁盘使用分区情况</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># lsblk</span></span><br><span class="line">NAME          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sda             8:0    0   20G  0 disk</span><br><span class="line">├─sda1          8:1    0    1G  0 part /boot</span><br><span class="line">└─sda2          8:2    0   19G  0 part</span><br><span class="line">  ├─rhel-root 253:0    0   17G  0 lvm  /</span><br><span class="line">  └─rhel-swap 253:1    0    2G  0 lvm  [SWAP]</span><br><span class="line">sdb             8:16   0   20G  0 disk</span><br><span class="line">└─zhou-lv1    253:2    0 10.4G  0 lvm  /opt/lv1</span><br><span class="line">sdc             8:32   0   20G  0 disk</span><br><span class="line">sdd             8:48   0   20G  0 disk</span><br><span class="line">sr0            11:0    1  3.8G  0 rom  /mnt/cdrom</span><br></pre></td></tr></table></figure>

<p>3.如何查看innode使用情况</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># df -ih</span></span><br><span class="line">文件系统              Inode 已用(I) 可用(I) 已用(I)% 挂载点</span><br><span class="line">/dev/mapper/rhel-root  8.5M    119K    8.4M       2% /</span><br><span class="line">devtmpfs               245K     393    244K       1% /dev</span><br><span class="line">tmpfs                  249K       1    249K       1% /dev/shm</span><br><span class="line">tmpfs                  249K     573    248K       1% /run</span><br><span class="line">tmpfs                  249K      16    249K       1% /sys/fs/cgroup</span><br><span class="line">/dev/sr0                  0       0       0        - /mnt/cdrom</span><br><span class="line">/dev/sda1              512K     325    512K       1% /boot</span><br><span class="line">tmpfs                  249K      16    249K       1% /run/user/0</span><br></pre></td></tr></table></figure>

<p>4.如何查看磁盘block使用情况</p>
<p>5.如何查看分区使用格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># blkid |grep /dev/sda1</span></span><br><span class="line">/dev/sda1: UUID=<span class="string">"9183ecd8-76e0-4f42-b256-21032b13dcd6"</span> TYPE=<span class="string">"xfs"</span></span><br></pre></td></tr></table></figure>

<p>6.如何查看一个设备的UUID</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@zhoulijie ~]<span class="comment"># blkid |grep /dev/sda1</span></span><br><span class="line">/dev/sda1: UUID=<span class="string">"9183ecd8-76e0-4f42-b256-21032b13dcd6"</span> TYPE=<span class="string">"xfs"</span></span><br></pre></td></tr></table></figure>

<p>7.请解释/etc/fstab中每段含义</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/dev/cdrom       /mnt/cdrom       iso9660               defaults        0  0 </span><br><span class="line">uuid(要挂载的)      所挂载的地方     设备类型                挂载选项        备份 磁盘检查</span><br></pre></td></tr></table></figure>

<p>8.一个ext4的文件分区，当使用touch test.file命令创建一个新文件是报错，报错的信息提示磁盘已满，但是采用df –h 命令查看磁盘大小时，只是用了60%的磁盘空间，为什么会出现这个情况，说说你的理由.</p>
<p>磁盘分区方案</p>
<blockquote>
<p>在虚拟机中添加一块20GB的SCISI磁盘<br>在新硬盘中建立一个5GB的分区，一个10G的分区<br>一个格式化为ext4的文件系统, 一个格式化为xfs的文件系统<br>新建两个目录站点进行挂载, 要求开机自动挂载该分区</p>
</blockquote>
<p>LVM磁盘管理方案</p>
<blockquote>
<p>在虚拟机环境中，新添加两块SCISI硬盘设备，完成硬盘检测及分区<br>建立逻辑卷mbvg, 格式化为ext4文件系统, 分配1G逻辑分区供/box目录使用<br>第二块逻辑分区, 格式化为xfs文件系统, 分配1G逻辑分区供/xfs目录使用<br>最后使用扩容方案将/box站点扩展到2.8G磁盘使用空间, 将/xfs目录扩展到2G</p>
</blockquote>

      
      <!-- 打赏 -->
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/chineselijie/2019/08/29/14.linux--LVM磁盘管理/" data-id="ck7ooyaea00104su65dv80ffj"
        class="article-share-link">分享</a>
        
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux基础/">linux基础</a></li></ul>

    </footer>

  </div>

  

  
  
  

  

</article>
    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2019-2020
        Li Jie
      </li>
      <li>
        
          Powered by
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
        
        <ul class="list-inline">
  <li>PV:<span id="busuanzi_value_page_pv"></span></li>
  <li>UV:<span id="busuanzi_value_site_uv"></span></li>
</ul>
        
      </li>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
    <div class="to_top">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>
      </div>
    </main>
      <aside class="sidebar">
        <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer.png" alt="Li Jie&#39;s blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
      </aside>
      <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>喜欢就打赏吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
      <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/lazyload.min.js"></script>
<script src="/js/busuanzi-2.3.pure.min.js"></script>

<script src="/fancybox/jquery.fancybox.min.js"></script>



<script>
  try {
    var typed = new Typed("#subtitle", {
    strings: ['面朝大海，春暖花开','愿你一生努力，一生被爱','想要的都拥有，得不到的都释怀'],
    startDelay: 0,
    typeSpeed: 200,
    loop: true,
    backSpeed: 100,
    showCursor: true
    });
  } catch (err) {
  }
  
</script>




<script>
  var ayerConfig = {
    mathjax: false
  }
</script>

<script src="/js/ayer.js"></script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>




<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>
  </div>
</body>

</html>